You are a senior staff engineer and software architect.

You are working inside an existing **Next.js + TypeScript + Supabase** app called **Industrial Competence Platform** on Replit.

The app ALREADY has:
- Competence Matrix
- Tomorrow’s Gaps with a Gap Engine
- WhatToFixSummary wired to real data
- Supabase with employees, skills, employee_skills, person_events, equipment, documents, news, etc.
- Manager risk dashboard
- Basic HR core features from previous iterations

You MUST NOT remove or break existing features.  
Now you will EXTEND the system with:

1) A full **1:1 / performance conversation engine** (one-to-one meetings)  
2) A **Notification Engine** that sends emails for due/overdue events (training, certificates, medical checks, etc.)  
3) A stronger **Employee Person Page** with left-side navigation (HR core hub)  
4) An **Org Overview / Org Chart**  
5) An **HR Analytics KPI dashboard** for HR only  
6) Basic **Role-based access control (RBAC)**

Return COMPLETE, PRODUCTION-READY CODE ONLY.  
No explanations, no TODOs, no pseudocode.  
Assume you commit directly to main.

====================================================
1. ONE-TO-ONE MEETINGS (1:1 / MEDARBETARSAMTAL)
====================================================

### 1.1 DB schema

Create tables in Supabase:

`one_to_one_meetings`:
- id (uuid, PK)
- employee_id (uuid, FK employees)
- manager_id (uuid, FK employees)
- scheduled_at (timestamptz)
- duration_minutes (int2, nullable)
- location (text, nullable)
- status (text)  -- "planned" | "in_progress" | "completed" | "cancelled"
- template_name (text, nullable)  -- e.g. "Medarbetarsamtal", "Lönesamtal"
- shared_agenda (text, nullable)  -- text seen by both
- employee_notes_private (text, nullable)
- manager_notes_private (text, nullable)
- created_at, updated_at (timestamptz)

`one_to_one_actions`:
- id (uuid, PK)
- meeting_id (uuid, FK one_to_one_meetings)
- description (text)
- owner_type (text)   -- "employee" | "manager"
- is_completed (boolean, default false)
- due_date (date, nullable)
- created_at, completed_at (timestamptz, nullable)

### 1.2 Services

Create `services/oneToOne.ts`:

- `getMeetingsForEmployee(employeeId: string)`  
- `getMeetingsForManager(managerId: string)`  
- `createMeeting(payload)`  
- `updateMeeting(id, updates)`  
- `addAction(meetingId, payload)`  
- `completeAction(actionId)`  

Make them use the Supabase client.

### 1.3 UI

Create:

- `app/employees/[id]/one-to-ones/page.tsx`:
  - List all meetings for that employee (date, manager, status).
  - Button: “Schedule new 1:1”.
- `app/one-to-ones/[id]/page.tsx`:
  - 3-part layout inspired by Huma:
    - **Before the meeting**: shared agenda + employee private notes.
    - **During**: list of discussion points and action items (from one_to_one_actions).
    - **After**: summary, mark actions as completed.
  - Show both shared fields and private notes (respecting which side is “viewing” – for now assume manager view; later extend to role-based view).
- Link from `/employees/[id]` person hub to the 1:1 list.

Do NOT use mock data. Everything must be wired to Supabase.

====================================================
2. NOTIFICATION ENGINE (EMAIL REMINDERS)
====================================================

Goal: automatic reminders for:
- training / certificates / medical checks / equipment / contract etc. from `person_events`
- upcoming 1:1 meetings and follow-up actions

Assume outgoing email can be sent via a simple SMTP or external provider. For now, provide functions that prepare and log outgoing messages (e.g. to a `email_outbox` table) instead of doing real SMTP.

### 2.1 Tables

Create table `email_outbox`:

- id (uuid, PK)
- to_email (text)
- subject (text)
- body (text)
- created_at (timestamptz)
- sent_at (timestamptz, nullable)
- status (text) -- "pending" | "sent" | "failed"
- error_message (text, nullable)
- meta (jsonb, nullable)

### 2.2 Notification service

Create `services/notifications.ts` with:

```ts
export async function enqueueDueEventNotifications(referenceDate: Date): Promise<void>;
export async function enqueueUpcomingOneToOnes(referenceDate: Date): Promise<void>;
export async function enqueueOverdueActions(referenceDate: Date): Promise<void>;