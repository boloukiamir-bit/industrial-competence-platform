{"version":3,"sources":["../../../lib/env.ts","../../../lib/supabaseClient.ts"],"sourcesContent":["/**\n * Environment variable helper with fail-fast behavior\n * Ensures Supabase credentials are always available\n */\n\nexport interface PublicEnv {\n  supabaseUrl: string;\n  supabaseAnonKey: string;\n}\n\n// Hardcoded fallback values for production builds\nconst FALLBACK_SUPABASE_URL = \"https://bmvawfrnlpdvcmffqrzc.supabase.co\";\nconst FALLBACK_SUPABASE_ANON_KEY = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJtdmF3ZnJubHBkdmNtZmZxcnpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU1MTEwOTAsImV4cCI6MjA4MTA4NzA5MH0.DHLJ4aMn1dORfbNPt1XrJtcdIjYN81YQbJ19Q89A_pM\";\n\n/**\n * Get public environment variables with fail-fast behavior\n * Throws if credentials are not available\n */\nexport function getPublicEnv(): PublicEnv {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || FALLBACK_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || FALLBACK_SUPABASE_ANON_KEY;\n\n  const missing: string[] = [];\n  \n  if (!supabaseUrl || supabaseUrl.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_URL');\n  }\n  if (!supabaseAnonKey || supabaseAnonKey.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_ANON_KEY');\n  }\n\n  if (missing.length > 0) {\n    throw new Error(`Supabase env missing: ${missing.join(', ')}`);\n  }\n\n  return {\n    supabaseUrl,\n    supabaseAnonKey,\n  };\n}\n\n/**\n * Check if public environment is properly configured\n * Returns validation result without throwing\n */\nexport function validatePublicEnv(): { valid: boolean; missing: string[] } {\n  const missing: string[] = [];\n  \n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || FALLBACK_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || FALLBACK_SUPABASE_ANON_KEY;\n\n  if (!supabaseUrl || supabaseUrl.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_URL');\n  }\n  if (!supabaseAnonKey || supabaseAnonKey.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_ANON_KEY');\n  }\n\n  return {\n    valid: missing.length === 0,\n    missing,\n  };\n}\n\n/**\n * Get the service role key (server-side only)\n * Never expose this to client code\n */\nexport function getServiceRoleKey(): string {\n  if (typeof window !== 'undefined') {\n    throw new Error('Service role key must never be accessed on the client');\n  }\n  \n  const key = process.env.SUPABASE_SERVICE_ROLE_KEY;\n  if (!key) {\n    throw new Error('SUPABASE_SERVICE_ROLE_KEY is not configured');\n  }\n  \n  return key;\n}\n","import { createClient, SupabaseClient } from \"@supabase/supabase-js\";\nimport { getPublicEnv, validatePublicEnv } from \"./env\";\n\nlet supabaseInstance: SupabaseClient | null = null;\n\nfunction createSupabaseClient(): SupabaseClient {\n  const env = getPublicEnv();\n  return createClient(env.supabaseUrl, env.supabaseAnonKey, {\n    auth: {\n      persistSession: true,\n      autoRefreshToken: true,\n      detectSessionInUrl: true,\n    },\n  });\n}\n\nexport function getSupabaseClient(): SupabaseClient {\n  if (!supabaseInstance) {\n    supabaseInstance = createSupabaseClient();\n  }\n  return supabaseInstance;\n}\n\nexport const supabase: SupabaseClient = createSupabaseClient();\n\nexport function isSupabaseReady(): boolean {\n  const validation = validatePublicEnv();\n  return validation.valid;\n}\n"],"names":[],"mappings":"m/BAkBO,SAAS,IACd,IAAM,EAAc,YAAA,+BACd,EAAkB,EADoC,cACpC,mMAElB,EAAoB,EAF2C,AAEzC,CAS5B,IAPI,CAAC,GAAe,EAAY,QAAQ,CAAC,cAAA,GACvC,AADuD,EAC/C,IAAI,CAAC,6BAEX,CAAC,GAAmB,EAAgB,QAAQ,CAAC,cAAA,GAAgB,AAC/D,EAAQ,IAAI,CAAC,iCAGX,EAAQ,MAAM,CAAG,EACnB,CADsB,KAChB,AAAI,MAAM,CAAC,sBAAsB,EAAE,EAAQ,IAAI,CAAC,MAAA,CAAO,EAG/D,MAAO,CACL,cACA,iBACF,CACF,CAMO,SAAS,IACd,IAAM,EAAoB,EAAE,CAEtB,EAAc,YAAA,+BACd,EAAkB,EADoC,cACpC,mMASxB,IATqE,GAEjE,CAAC,GAAe,EAAY,QAAQ,CAAC,cAAA,GACvC,AADuD,EAC/C,IAAI,CAAC,6BAEX,CAAC,GAAmB,EAAgB,QAAQ,CAAC,cAAA,GAAgB,AAC/D,EAAQ,IAAI,CAAC,iCAGR,CACL,MAA0B,IAAnB,EAAQ,MAAM,SACrB,CACF,CACF,qFC9DA,IAAA,EAAA,EAAA,CAAA,CAAA,OAuBO,IAAM,GAjBL,EAAM,CAAA,EAAA,AALd,EAAA,CAAA,AAsBwC,CAtBxC,OAKc,YAAA,AAAY,IACjB,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,EAAI,WAAW,CAAE,EAAI,eAAe,CAAE,CACxD,KAAM,CACJ,gBAAgB,EAChB,kBAAkB,EAClB,oBAAoB,CACtB,CACF"}