module.exports=[69520,a=>{"use strict";let b=(0,a.i(70106).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],69520)},72275,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(72221),e=a.i(36395),f=a.i(7291),g=a.i(91638),h=a.i(99806),i=a.i(70106);let j=(0,i.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var k=a.i(33441);let l=(0,i.default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var m=a.i(46842),n=a.i(67900),o=a.i(73570),p=a.i(69520),q=a.i(96221),r=a.i(40695),s=a.i(48654);let t=[];function u(a){t.unshift(a),t.length>10&&t.pop()}function v(){let{currentOrg:a,currentRole:i,memberships:u,isLoading:v,error:w}=(0,d.useOrg)(),{user:x,isAuthenticated:y}=(0,e.useAuth)(),[z,A]=(0,c.useState)({employees:null,units:null,skills:null,positions:null}),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)([]);(0,c.useEffect)(()=>{G([...t])},[]);let H=async()=>{if(a){C(!0);try{let[b,c,d,e]=await Promise.allSettled([f.supabase.from("employees").select("id",{count:"exact",head:!0}).eq("org_id",a.id),f.supabase.from("org_units").select("id",{count:"exact",head:!0}).eq("org_id",a.id),f.supabase.from("competences").select("id",{count:"exact",head:!0}),f.supabase.from("positions").select("id",{count:"exact",head:!0})]);A({employees:"fulfilled"===b.status?b.value.count:null,units:"fulfilled"===c.status?c.value.count:null,skills:"fulfilled"===d.status?d.value.count:null,positions:"fulfilled"===e.status?e.value.count:null})}catch(a){console.error("Error fetching counts:",a)}finally{C(!1)}}};(0,c.useEffect)(()=>{a&&H()},[a]);let I=()=>a?null===a.id?"localStorage":1===u.length?"auto-selected (single org)":"selected":"none",J=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({timestamp:new Date().toISOString(),demoMode:(0,g.isDemoMode)(),user:{email:x?.email||"not authenticated",id:x?.id||null,authenticated:y},organization:{id:a?.id||null,name:a?.name||null,slug:a?.slug||null,source:I(),role:i},memberships:u.map(a=>({orgId:a.org_id,orgName:a.organization?.name,role:a.role,status:a.status})),counts:z,errors:F.slice(0,10),orgLoadingState:{isLoading:v,error:w}},null,2)),E(!0),setTimeout(()=>E(!1),2e3)}catch(a){console.error("Failed to copy:",a)}};return(0,b.jsxs)("div",{className:"p-6 max-w-4xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-semibold text-foreground flex items-center gap-2","data-testid":"text-page-title",children:[(0,b.jsx)(h.Bug,{className:"w-6 h-6"}),"Debug Cockpit"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"System state and diagnostics"})]}),(0,b.jsxs)(r.Button,{onClick:J,"data-testid":"button-copy-report",children:[D?(0,b.jsx)(k.Check,{className:"w-4 h-4 mr-2"}):(0,b.jsx)(j,{className:"w-4 h-4 mr-2"}),D?"Copied!":"Copy Debug Report"]})]}),(0,g.isDemoMode)()&&(0,b.jsx)("div",{className:"p-4 rounded-md bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800",children:(0,b.jsxs)("p",{className:"text-sm text-amber-800 dark:text-amber-200 flex items-center gap-2",children:[(0,b.jsx)(o.AlertTriangle,{className:"w-4 h-4"}),"Demo mode is active. Database queries return mock data."]})}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsxs)(s.Card,{children:[(0,b.jsx)(s.CardHeader,{className:"pb-3",children:(0,b.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(m.User,{className:"w-4 h-4"}),"Current User"]})}),(0,b.jsxs)(s.CardContent,{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Email:"}),(0,b.jsx)("span",{className:"font-mono text-foreground","data-testid":"text-user-email",children:x?.email||"Not authenticated"})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"User ID:"}),(0,b.jsx)("span",{className:"font-mono text-foreground text-xs truncate max-w-[200px]",children:x?.id||"-"})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Authenticated:"}),(0,b.jsx)("span",{className:y?"text-green-600":"text-red-600",children:y?"Yes":"No"})]})]})]}),(0,b.jsxs)(s.Card,{children:[(0,b.jsx)(s.CardHeader,{className:"pb-3",children:(0,b.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(n.Building2,{className:"w-4 h-4"}),"Current Organization"]})}),(0,b.jsxs)(s.CardContent,{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Name:"}),(0,b.jsx)("span",{className:"font-medium text-foreground","data-testid":"text-org-name",children:a?.name||"None selected"})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Org ID:"}),(0,b.jsx)("span",{className:"font-mono text-foreground text-xs truncate max-w-[200px]","data-testid":"text-org-id",children:a?.id||"-"})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Source:"}),(0,b.jsx)("span",{className:"text-foreground",children:I()})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Role:"}),(0,b.jsx)("span",{className:"capitalize text-foreground",children:i||"-"})]}),v&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,b.jsx)(q.Loader2,{className:"w-3 h-3 animate-spin"})," Loading org..."]}),w&&(0,b.jsx)("div",{className:"text-sm text-destructive",children:w})]})]})]}),(0,b.jsxs)(s.Card,{children:[(0,b.jsxs)(s.CardHeader,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[(0,b.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(l,{className:"w-4 h-4"}),"Data Counts"]}),(0,b.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:H,disabled:B,children:(0,b.jsx)(p.RefreshCw,{className:`w-4 h-4 ${B?"animate-spin":""}`})})]}),(0,b.jsx)(s.CardContent,{children:(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Employees",value:z.employees},{label:"Org Units",value:z.units},{label:"Competences",value:z.skills},{label:"Positions",value:z.positions}].map(a=>(0,b.jsxs)("div",{className:"text-center p-3 rounded-md bg-muted/50",children:[(0,b.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:null===a.value?"-":a.value}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.label})]},a.label))})})]}),(0,b.jsxs)(s.Card,{children:[(0,b.jsx)(s.CardHeader,{className:"pb-3",children:(0,b.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(o.AlertTriangle,{className:"w-4 h-4"}),"Recent Errors (Last 10)"]})}),(0,b.jsx)(s.CardContent,{children:0===F.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No errors logged in this session"}):(0,b.jsx)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:F.map((a,c)=>(0,b.jsxs)("div",{className:"p-3 rounded-md bg-destructive/5 border border-destructive/20 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs bg-destructive/10 text-destructive uppercase",children:a.type}),a.endpoint&&(0,b.jsx)("span",{className:"font-mono text-xs text-muted-foreground",children:a.endpoint}),a.status&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Status: ",a.status]})]}),(0,b.jsx)("p",{className:"text-foreground",children:a.message}),a.code&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Code: ",a.code]}),a.hint&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Hint: ",a.hint]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a.timestamp})]},c))})})]}),(0,b.jsxs)(s.Card,{children:[(0,b.jsx)(s.CardHeader,{className:"pb-3",children:(0,b.jsx)(s.CardTitle,{className:"text-base",children:"All Memberships"})}),(0,b.jsx)(s.CardContent,{children:0===u.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No organization memberships found"}):(0,b.jsx)("div",{className:"space-y-2",children:u.map((c,d)=>(0,b.jsxs)("div",{className:`p-3 rounded-md border ${c.org_id===a?.id?"border-primary bg-primary/5":"border-border bg-muted/30"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium text-foreground",children:c.organization?.name||c.org_id}),(0,b.jsx)("span",{className:"text-xs px-2 py-1 rounded bg-muted text-muted-foreground capitalize",children:c.role})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground mt-1 font-mono",children:c.org_id})]},d))})})]})]})}a.s(["default",()=>v,"logDebugError",()=>u],72275)},65321,43886,92319,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(72221);function f({children:a,requireAdmin:f=!1}){let{currentOrg:g,isLoading:h,memberships:i,isAdmin:j}=(0,e.useOrg)(),k=(0,d.useRouter)();return((0,c.useEffect)(()=>{if(!h){if(!g&&i.length>0||!g&&0===i.length)return void k.replace("/app/org/select");if(f&&!j)return void k.replace("/app")}},[g,h,i,j,f,k]),h)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"animate-pulse text-muted-foreground",children:"Loading..."})}):g&&(!f||j)?(0,b.jsx)(b.Fragment,{children:a}):null}a.s(["OrgGuard",()=>f],65321);var g=a.i(96221),h=a.i(92e3),i=a.i(69520),j=a.i(99806),k=a.i(70106);let l=(0,k.default)("FileQuestion",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]]);var m=a.i(40695),n=a.i(38246);function o({status:a,children:c,error:d,onRetry:e,emptyTitle:f="No data yet",emptyMessage:k="Get started by adding your first item.",emptyCta:o,emptyIcon:p,loadingMessage:q="Loading...",minHeight:r="400px"}){return"ready"===a&&c?(0,b.jsx)(b.Fragment,{children:c}):"loading"===a?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",style:{minHeight:r},"data-testid":"state-loading",children:[(0,b.jsx)(g.Loader2,{className:"w-6 h-6 animate-spin text-muted-foreground"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:q})]}):"error"===a?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",style:{minHeight:r},"data-testid":"state-error",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-destructive/10",children:(0,b.jsx)(h.AlertCircle,{className:"w-8 h-8 text-destructive"})}),(0,b.jsxs)("div",{className:"text-center max-w-md",children:[(0,b.jsx)("h3",{className:"font-medium text-foreground mb-1",children:"Something went wrong"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:d?.message||"Failed to load data"}),d?.code&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground font-mono bg-muted px-2 py-1 rounded inline-block",children:["Code: ",d.code]}),d?.hint&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Hint: ",d.hint]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[e&&(0,b.jsxs)(m.Button,{variant:"outline",onClick:e,"data-testid":"button-retry",children:[(0,b.jsx)(i.RefreshCw,{className:"w-4 h-4 mr-2"}),"Retry"]}),(0,b.jsx)(m.Button,{variant:"ghost",asChild:!0,"data-testid":"button-open-debug",children:(0,b.jsxs)(n.default,{href:"/app/debug",children:[(0,b.jsx)(j.Bug,{className:"w-4 h-4 mr-2"}),"Open Debug"]})})]})]}):"empty"===a?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",style:{minHeight:r},"data-testid":"state-empty",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-muted",children:p||(0,b.jsx)(l,{className:"w-8 h-8 text-muted-foreground"})}),(0,b.jsxs)("div",{className:"text-center max-w-md",children:[(0,b.jsx)("h3",{className:"font-medium text-foreground mb-1",children:f}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:k})]}),o&&(o.href?(0,b.jsx)(m.Button,{asChild:!0,"data-testid":"button-empty-cta",children:(0,b.jsx)(n.default,{href:o.href,children:o.label})}):(0,b.jsx)(m.Button,{onClick:o.onClick,"data-testid":"button-empty-cta",children:o.label}))]}):null}function p(a,b,c){return b?"loading":c?"error":!a||Array.isArray(a)&&0===a.length?"empty":"ready"}a.s(["DataState",()=>o,"useDataState",()=>p],43886);let q=(0,k.default)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);a.s(["UserX",()=>q],92319)}];

//# sourceMappingURL=_ad739db4._.js.map