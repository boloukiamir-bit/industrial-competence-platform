{"version":3,"sources":["../../../../services/competenceService.ts","../../../../app/app/competence-matrix/page.tsx"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\";\nimport type { Employee, Skill, EmployeeSkill, CompetenceLevel } from \"@/types/domain\";\n\nconst demoEmployees: Omit<Employee, \"id\">[] = [\n  { name: \"Anna Lindberg\", employeeNumber: \"E1001\", role: \"Operator\", line: \"Pressline 1\", team: \"Day\", employmentType: \"permanent\", isActive: true },\n  { name: \"Erik Johansson\", employeeNumber: \"E1002\", role: \"Operator\", line: \"Pressline 1\", team: \"Night\", employmentType: \"permanent\", isActive: true },\n  { name: \"Maria Svensson\", employeeNumber: \"E1003\", role: \"Team Leader\", line: \"Assembly\", team: \"Day\", employmentType: \"permanent\", isActive: true },\n  { name: \"Karl Andersson\", employeeNumber: \"E1004\", role: \"Operator\", line: \"Assembly\", team: \"Night\", employmentType: \"temporary\", isActive: true },\n];\n\nconst demoSkills: Omit<Skill, \"id\">[] = [\n  { code: \"PRESS_A\", name: \"Pressline A\", category: \"Production\" },\n  { code: \"PRESS_B\", name: \"Pressline B\", category: \"Production\" },\n  { code: \"5S\", name: \"5S Basics\", category: \"Lean\" },\n  { code: \"SAFETY_BASIC\", name: \"Safety Basic\", category: \"Safety\" },\n  { code: \"TRUCK_A1\", name: \"Truck A1 License\", category: \"Logistics\" },\n];\n\nconst demoSkillLevels: Record<string, Record<string, CompetenceLevel[\"value\"]>> = {\n  \"E1001\": { \"PRESS_A\": 3, \"PRESS_B\": 2, \"5S\": 4, \"SAFETY_BASIC\": 3, \"TRUCK_A1\": 1 },\n  \"E1002\": { \"PRESS_A\": 2, \"PRESS_B\": 1, \"5S\": 3, \"SAFETY_BASIC\": 2, \"TRUCK_A1\": 0 },\n  \"E1003\": { \"PRESS_A\": 4, \"PRESS_B\": 3, \"5S\": 4, \"SAFETY_BASIC\": 4, \"TRUCK_A1\": 2 },\n  \"E1004\": { \"PRESS_A\": 1, \"PRESS_B\": 0, \"5S\": 2, \"SAFETY_BASIC\": 1, \"TRUCK_A1\": 0 },\n};\n\nexport async function seedDemoDataIfEmpty(): Promise<void> {\n  const { data: existingEmployees, error: checkError } = await supabase\n    .from(\"employees\")\n    .select(\"id\")\n    .limit(1);\n\n  if (checkError) {\n    throw new Error(`Failed to check employees table: ${checkError.message}`);\n  }\n\n  if (existingEmployees && existingEmployees.length > 0) {\n    return;\n  }\n\n  const { data: insertedEmployees, error: employeesError } = await supabase\n    .from(\"employees\")\n    .insert(\n      demoEmployees.map((emp) => ({\n        name: emp.name,\n        employee_number: emp.employeeNumber,\n        role: emp.role,\n        line: emp.line,\n        team: emp.team,\n        is_active: emp.isActive,\n      }))\n    )\n    .select();\n\n  if (employeesError) {\n    throw new Error(`Failed to insert employees: ${employeesError.message}`);\n  }\n\n  const { data: insertedSkills, error: skillsError } = await supabase\n    .from(\"skills\")\n    .insert(\n      demoSkills.map((skill) => ({\n        code: skill.code,\n        name: skill.name,\n        category: skill.category,\n      }))\n    )\n    .select();\n\n  if (skillsError) {\n    throw new Error(`Failed to insert skills: ${skillsError.message}`);\n  }\n\n  if (!insertedEmployees || !insertedSkills) {\n    throw new Error(\"Failed to get inserted employee or skill IDs\");\n  }\n\n  const employeeByNumber = new Map<string, string>();\n  for (const emp of insertedEmployees) {\n    employeeByNumber.set(emp.employee_number, emp.id);\n  }\n\n  const skillByCode = new Map<string, string>();\n  for (const skill of insertedSkills) {\n    skillByCode.set(skill.code, skill.id);\n  }\n\n  const employeeSkillsToInsert: { employee_id: string; skill_id: string; level: number }[] = [];\n\n  for (const [empNumber, skills] of Object.entries(demoSkillLevels)) {\n    const employeeId = employeeByNumber.get(empNumber);\n    if (!employeeId) continue;\n\n    for (const [skillCode, level] of Object.entries(skills)) {\n      const skillId = skillByCode.get(skillCode);\n      if (!skillId) continue;\n\n      employeeSkillsToInsert.push({\n        employee_id: employeeId,\n        skill_id: skillId,\n        level,\n      });\n    }\n  }\n\n  const { error: employeeSkillsError } = await supabase\n    .from(\"employee_skills\")\n    .insert(employeeSkillsToInsert);\n\n  if (employeeSkillsError) {\n    throw new Error(`Failed to insert employee_skills: ${employeeSkillsError.message}`);\n  }\n}\n\nexport async function getFilterOptions(): Promise<{\n  lines: string[];\n  teams: string[];\n}> {\n  const { data, error } = await supabase\n    .from(\"employees\")\n    .select(\"line, team\");\n\n  if (error) {\n    throw new Error(`Failed to fetch filter options: ${error.message}`);\n  }\n\n  const lines = [...new Set((data || []).map((row) => row.line).filter(Boolean))].sort();\n  const teams = [...new Set((data || []).map((row) => row.team).filter(Boolean))].sort();\n\n  return { lines, teams };\n}\n\nexport async function getEmployeesWithSkills(filters?: {\n  line?: string;\n  team?: string;\n}): Promise<{\n  employees: Employee[];\n  skills: Skill[];\n  employeeSkills: EmployeeSkill[];\n}> {\n  let employeesQuery = supabase.from(\"employees\").select(\"*\");\n  \n  if (filters?.line) {\n    employeesQuery = employeesQuery.eq(\"line\", filters.line);\n  }\n  if (filters?.team) {\n    employeesQuery = employeesQuery.eq(\"team\", filters.team);\n  }\n\n  const [employeesResult, skillsResult, employeeSkillsResult] = await Promise.all([\n    employeesQuery,\n    supabase.from(\"skills\").select(\"*\"),\n    supabase.from(\"employee_skills\").select(\"*\"),\n  ]);\n\n  if (employeesResult.error) {\n    throw new Error(`Failed to fetch employees: ${employeesResult.error.message}`);\n  }\n\n  if (skillsResult.error) {\n    throw new Error(`Failed to fetch skills: ${skillsResult.error.message}`);\n  }\n\n  if (employeeSkillsResult.error) {\n    throw new Error(`Failed to fetch employee_skills: ${employeeSkillsResult.error.message}`);\n  }\n\n  const employees: Employee[] = (employeesResult.data || []).map((row) => ({\n    id: row.id,\n    name: row.name,\n    employeeNumber: row.employee_number,\n    role: row.role,\n    line: row.line,\n    team: row.team,\n    employmentType: row.employment_type || \"permanent\",\n    isActive: row.is_active,\n  }));\n\n  const skills: Skill[] = (skillsResult.data || []).map((row) => ({\n    id: row.id,\n    code: row.code,\n    name: row.name,\n    category: row.category,\n    description: row.description,\n  }));\n\n  const employeeSkills: EmployeeSkill[] = (employeeSkillsResult.data || []).map((row) => ({\n    employeeId: row.employee_id,\n    skillId: row.skill_id,\n    level: row.level as CompetenceLevel[\"value\"],\n  }));\n\n  return { employees, skills, employeeSkills };\n}\n\nexport interface CompetenceGap {\n  line: string;\n  team: string;\n  skillName: string;\n  skillCode: string;\n  requiredLevel: number;\n  requiredHeadcount: number;\n  actualHeadcount: number;\n  missingHeadcount: number;\n}\n\nexport async function getTomorrowsGaps(): Promise<CompetenceGap[]> {\n  const targetDate = new Date();\n  targetDate.setDate(targetDate.getDate() + 1);\n  const targetDateStr = targetDate.toISOString().slice(0, 10);\n\n  const { data: requirements, error: reqError } = await supabase\n    .from(\"competence_requirements\")\n    .select(\"id, line, team, skill_id, min_level, min_headcount, effective_date\")\n    .lte(\"effective_date\", targetDateStr);\n\n  if (reqError) {\n    throw new Error(`Failed to fetch competence_requirements: ${reqError.message}`);\n  }\n\n  if (!requirements || requirements.length === 0) {\n    return [];\n  }\n\n  const skillIds = [...new Set(requirements.map((r) => r.skill_id))];\n  const { data: skills, error: skillsError } = await supabase\n    .from(\"skills\")\n    .select(\"id, code, name\")\n    .in(\"id\", skillIds);\n\n  if (skillsError) {\n    throw new Error(`Failed to fetch skills: ${skillsError.message}`);\n  }\n\n  const skillMap = new Map<string, { code: string; name: string }>();\n  for (const skill of skills || []) {\n    skillMap.set(skill.id, { code: skill.code, name: skill.name });\n  }\n\n  const gaps: CompetenceGap[] = [];\n\n  for (const req of requirements) {\n    const { line, team, skill_id, min_level, min_headcount } = req;\n\n    const skillInfo = skillMap.get(skill_id);\n    if (!skillInfo) continue;\n\n    const { data: matchingEmployees, error: empError } = await supabase\n      .from(\"employees\")\n      .select(\"id\")\n      .eq(\"line\", line)\n      .eq(\"team\", team);\n\n    if (empError) {\n      throw new Error(`Failed to fetch employees for ${line}/${team}: ${empError.message}`);\n    }\n\n    const employeeIds = (matchingEmployees || []).map((e) => e.id);\n\n    let actualHeadcount = 0;\n\n    if (employeeIds.length > 0) {\n      const { data: qualifiedSkills, error: esError } = await supabase\n        .from(\"employee_skills\")\n        .select(\"employee_id\")\n        .eq(\"skill_id\", skill_id)\n        .gte(\"level\", min_level)\n        .in(\"employee_id\", employeeIds);\n\n      if (esError) {\n        throw new Error(`Failed to fetch employee_skills: ${esError.message}`);\n      }\n\n      actualHeadcount = qualifiedSkills?.length || 0;\n    }\n\n    const requiredHeadcount = min_headcount;\n    const missingHeadcount = Math.max(0, requiredHeadcount - actualHeadcount);\n\n    if (missingHeadcount > 0) {\n      gaps.push({\n        line,\n        team,\n        skillCode: skillInfo.code,\n        skillName: skillInfo.name,\n        requiredLevel: min_level,\n        requiredHeadcount,\n        actualHeadcount,\n        missingHeadcount,\n      });\n    }\n  }\n\n  return gaps;\n}\n\ninterface RawGap {\n  line_name: string;\n  role_name: string;\n  skill_name: string;\n  missing: number;\n}\n\nexport function getCriticalGaps(gaps: RawGap[]) {\n  return gaps\n    .filter(g => g.missing > 0)\n    .map(g => ({\n      line: g.line_name,\n      role: g.role_name,\n      skill: g.skill_name,\n      missingCount: g.missing,\n    }));\n}\n\ninterface SkillStats {\n  level_0: number;\n  level_1: number;\n}\n\nexport function getTrainingPriorities(skillsStats: Record<string, SkillStats>) {\n  return Object.entries(skillsStats)\n    .map(([skill, stats]) => ({\n      skill,\n      countLevel0or1: stats.level_0 + stats.level_1,\n    }))\n    .filter(i => i.countLevel0or1 > 0)\n    .sort((a, b) => b.countLevel0or1 - a.countLevel0or1);\n}\n\ninterface FullSkillStats {\n  level_0: number;\n  level_1: number;\n  level_3: number;\n  level_4: number;\n}\n\nexport function getOverstaffedSkills(skillsStats: Record<string, FullSkillStats>) {\n  return Object.entries(skillsStats)\n    .map(([skill, stats]) => ({\n      skill,\n      countLevel3or4: stats.level_3 + stats.level_4,\n    }))\n    .filter(i => i.countLevel3or4 >= 3)\n    .sort((a, b) => b.countLevel3or4 - a.countLevel3or4);\n}\n","import type { CompetenceLevel } from \"@/types/domain\";\nimport { seedDemoDataIfEmpty, getEmployeesWithSkills, getFilterOptions } from \"@/services/competenceService\";\n\nexport const dynamic = \"force-dynamic\";\n\nconst competenceLevels: CompetenceLevel[] = [\n  { value: 0, label: \"None\", description: \"No experience or training\" },\n  { value: 1, label: \"Basic\", description: \"Theoretical knowledge, needs supervision\" },\n  { value: 2, label: \"Intermediate\", description: \"Can perform with occasional guidance\" },\n  { value: 3, label: \"Advanced\", description: \"Fully independent, can train others\" },\n  { value: 4, label: \"Expert\", description: \"Subject matter expert, defines standards\" },\n];\n\nfunction getLevelColor(level: CompetenceLevel[\"value\"]): string {\n  switch (level) {\n    case 0:\n      return \"bg-gray-200 dark:bg-gray-600\";\n    case 1:\n      return \"bg-red-400 dark:bg-red-600\";\n    case 2:\n      return \"bg-yellow-400 dark:bg-yellow-500\";\n    case 3:\n      return \"bg-green-300 dark:bg-green-500\";\n    case 4:\n      return \"bg-green-600 dark:bg-green-700\";\n    default:\n      return \"bg-gray-200 dark:bg-gray-600\";\n  }\n}\n\ninterface PageProps {\n  searchParams: Promise<{ line?: string; team?: string }>;\n}\n\nexport default async function CompetenceMatrixPage({ searchParams }: PageProps) {\n  const params = await searchParams;\n  const selectedLine = params.line || \"\";\n  const selectedTeam = params.team || \"\";\n\n  await seedDemoDataIfEmpty();\n  \n  const [{ employees, skills, employeeSkills }, filterOptions] = await Promise.all([\n    getEmployeesWithSkills({\n      line: selectedLine || undefined,\n      team: selectedTeam || undefined,\n    }),\n    getFilterOptions(),\n  ]);\n\n  function getSkillLevel(employeeId: string, skillId: string): CompetenceLevel[\"value\"] {\n    const found = employeeSkills.find(\n      (es) => es.employeeId === employeeId && es.skillId === skillId\n    );\n    return found ? found.level : 0;\n  }\n\n  return (\n    <div>\n      <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-6\" data-testid=\"heading-competence-matrix\">\n        Competence Matrix\n      </h1>\n\n      <div className=\"mb-6 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-700 p-4\">\n        <h2 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\n          Filters\n        </h2>\n        <form method=\"GET\" className=\"flex flex-wrap items-end gap-4\">\n          <div>\n            <label\n              htmlFor=\"line-filter\"\n              className=\"block text-xs text-gray-500 dark:text-gray-400 mb-1\"\n            >\n              Line\n            </label>\n            <select\n              id=\"line-filter\"\n              name=\"line\"\n              defaultValue={selectedLine}\n              className=\"block w-40 px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              data-testid=\"select-line-filter\"\n            >\n              <option value=\"\">All Lines</option>\n              {filterOptions.lines.map((line) => (\n                <option key={line} value={line}>\n                  {line}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div>\n            <label\n              htmlFor=\"team-filter\"\n              className=\"block text-xs text-gray-500 dark:text-gray-400 mb-1\"\n            >\n              Team\n            </label>\n            <select\n              id=\"team-filter\"\n              name=\"team\"\n              defaultValue={selectedTeam}\n              className=\"block w-40 px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              data-testid=\"select-team-filter\"\n            >\n              <option value=\"\">All Teams</option>\n              {filterOptions.teams.map((team) => (\n                <option key={team} value={team}>\n                  {team}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <button\n            type=\"submit\"\n            className=\"px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors\"\n            data-testid=\"button-apply-filters\"\n          >\n            Apply Filters\n          </button>\n\n          {(selectedLine || selectedTeam) && (\n            <a\n              href=\"/app/competence-matrix\"\n              className=\"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors\"\n              data-testid=\"link-clear-filters\"\n            >\n              Clear Filters\n            </a>\n          )}\n        </form>\n      </div>\n\n      <div className=\"mb-6 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-700 p-4\">\n        <h2 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\n          Legend\n        </h2>\n        <div className=\"flex flex-wrap gap-4\">\n          {competenceLevels.map((level) => (\n            <div key={level.value} className=\"flex items-center gap-2\">\n              <div\n                className={`w-6 h-6 rounded ${getLevelColor(level.value)}`}\n                data-testid={`legend-level-${level.value}`}\n              />\n              <div className=\"text-sm\">\n                <span className=\"font-medium text-gray-900 dark:text-white\">\n                  {level.value} - {level.label}\n                </span>\n                <span className=\"text-gray-500 dark:text-gray-400 ml-1\">\n                  ({level.description})\n                </span>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      <div className=\"bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-700 overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full\" data-testid=\"competence-matrix-table\">\n            <thead>\n              <tr className=\"border-b border-gray-200 dark:border-gray-700\">\n                <th className=\"text-left p-3 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-700/50\">\n                  Employee\n                </th>\n                {skills.map((skill) => (\n                  <th\n                    key={skill.id}\n                    className=\"text-center p-3 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-700/50 min-w-[100px]\"\n                  >\n                    <div>{skill.code}</div>\n                    <div className=\"text-xs font-normal text-gray-500 dark:text-gray-400\">\n                      {skill.name}\n                    </div>\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {employees.length === 0 ? (\n                <tr>\n                  <td\n                    colSpan={skills.length + 1}\n                    className=\"p-6 text-center text-gray-500 dark:text-gray-400\"\n                    data-testid=\"no-results-message\"\n                  >\n                    No employees match the selected filters.\n                  </td>\n                </tr>\n              ) : (\n                employees.map((employee, index) => (\n                  <tr\n                    key={employee.id}\n                    className={\n                      index < employees.length - 1\n                        ? \"border-b border-gray-200 dark:border-gray-700\"\n                        : \"\"\n                    }\n                    data-testid={`row-employee-${employee.id}`}\n                  >\n                    <td className=\"p-3\">\n                      <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                        {employee.name}\n                      </div>\n                      <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                        {employee.role} - {employee.team}\n                      </div>\n                    </td>\n                    {skills.map((skill) => {\n                      const level = getSkillLevel(employee.id, skill.id);\n                      return (\n                        <td key={skill.id} className=\"p-3 text-center\">\n                          <div\n                            className={`inline-flex items-center justify-center w-8 h-8 rounded text-sm font-medium text-gray-900 dark:text-white ${getLevelColor(level)}`}\n                            data-testid={`cell-${employee.id}-${skill.id}`}\n                          >\n                            {level}\n                          </div>\n                        </td>\n                      );\n                    })}\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}