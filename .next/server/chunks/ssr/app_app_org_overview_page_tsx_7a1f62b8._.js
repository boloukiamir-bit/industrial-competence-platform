module.exports=[55776,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(48654),f=a.i(54161),g=a.i(40695),h=a.i(7554),i=a.i(70121),j=a.i(50104),k=a.i(25152),l=a.i(77994),m=a.i(3688),n=a.i(30553),o="Switch",[p,q]=(0,j.createContextScope)(o),[r,s]=p(o),t=c.forwardRef((a,d)=>{let{__scopeSwitch:e,name:f,checked:g,defaultChecked:j,required:l,disabled:m,value:o="on",onCheckedChange:p,form:q,...s}=a,[t,u]=c.useState(null),v=(0,i.useComposedRefs)(d,a=>u(a)),y=c.useRef(!1),z=!t||q||!!t.closest("form"),[A=!1,B]=(0,k.useControllableState)({prop:g,defaultProp:j,onChange:p});return(0,b.jsxs)(r,{scope:e,checked:A,disabled:m,children:[(0,b.jsx)(n.Primitive.button,{type:"button",role:"switch","aria-checked":A,"aria-required":l,"data-state":x(A),"data-disabled":m?"":void 0,disabled:m,value:o,...s,ref:v,onClick:(0,h.composeEventHandlers)(a.onClick,a=>{B(a=>!a),z&&(y.current=a.isPropagationStopped(),y.current||a.stopPropagation())})}),z&&(0,b.jsx)(w,{control:t,bubbles:!y.current,name:f,value:o,checked:A,required:l,disabled:m,form:q,style:{transform:"translateX(-100%)"}})]})});t.displayName=o;var u="SwitchThumb",v=c.forwardRef((a,c)=>{let{__scopeSwitch:d,...e}=a,f=s(u,d);return(0,b.jsx)(n.Primitive.span,{"data-state":x(f.checked),"data-disabled":f.disabled?"":void 0,...e,ref:c})});v.displayName=u;var w=a=>{let{control:d,checked:e,bubbles:f=!0,...g}=a,h=c.useRef(null),i=(0,l.usePrevious)(e),j=(0,m.useSize)(d);return c.useEffect(()=>{let a=h.current,b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(i!==e&&b){let c=new Event("click",{bubbles:f});b.call(a,e),a.dispatchEvent(c)}},[i,e,f]),(0,b.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:e,...g,tabIndex:-1,ref:h,style:{...a.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function x(a){return a?"checked":"unchecked"}var y=a.i(97895);let z=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(t,{className:(0,y.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...c,ref:d,children:(0,b.jsx)(v,{className:(0,y.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));z.displayName=t.displayName;var A=a.i(67900),B=a.i(60246),C=a.i(46842),D=a.i(5784),E=a.i(50522),F=a.i(15618),G=a.i(73320),H=a.i(7291);async function I(){let[a,b]=await Promise.all([H.supabase.from("org_units").select("*, manager:manager_employee_id(name)").order("name"),H.supabase.from("employees").select("id, name, role, org_unit_id").eq("is_active",!0)]);if(a.error)return console.error("Error fetching org units:",a.error),[];let c=(a.data||[]).map(a=>({id:a.id,name:a.name,code:a.code||void 0,parentId:a.parent_id||void 0,type:a.type,managerEmployeeId:a.manager_employee_id||void 0,managerName:a.manager?.name||void 0,createdAt:a.created_at,children:[],employees:[],employeeCount:0})),d=(b.data||[]).map(a=>({id:a.id,name:a.name||"",employeeNumber:"",role:a.role||"",line:"",team:"",employmentType:"permanent",orgUnitId:a.org_unit_id||void 0,isActive:!0})),e=new Map;c.forEach(a=>e.set(a.id,a)),d.forEach(a=>{if(a.orgUnitId){let b=e.get(a.orgUnitId);b&&(b.employees=b.employees||[],b.employees.push(a),b.employeeCount=(b.employeeCount||0)+1)}});let f=[];return c.forEach(a=>{if(a.parentId){let b=e.get(a.parentId);b?(b.children=b.children||[],b.children.push(a)):f.push(a)}else f.push(a)}),f.forEach(function a(b){let c=b.employeeCount||0;if(b.children)for(let d of b.children)c+=a(d);return b.employeeCount=c,c}),f}var J=a.i(60825),K=a.i(91638);function L({unit:a,showEmployees:d,level:h=0}){let[i,j]=(0,c.useState)(h<2),k=a.children&&a.children.length>0,l=a.employees&&a.employees.length>0;return(0,b.jsxs)("div",{className:h>0?"ml-6 border-l-2 border-muted pl-4":"",children:[(0,b.jsx)(e.Card,{className:"mb-3",children:(0,b.jsx)(e.CardContent,{className:"py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[k||d&&l?(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>j(!i),"data-testid":`button-toggle-${a.id}`,children:i?(0,b.jsx)(D.ChevronDown,{className:"h-4 w-4"}):(0,b.jsx)(E.ChevronRight,{className:"h-4 w-4"})}):(0,b.jsx)("div",{className:"w-6"}),(0,b.jsx)(A.Building2,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("span",{className:"font-medium","data-testid":`text-unit-name-${a.id}`,children:a.name}),a.code&&(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:a.code}),a.type&&(0,b.jsx)(f.Badge,{variant:"secondary",className:"text-xs",children:a.type})]}),a.managerName&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center gap-1 mt-1",children:[(0,b.jsx)(C.User,{className:"h-3 w-3"})," Manager: ",a.managerName]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)(B.Users,{className:"h-4 w-4"}),(0,b.jsxs)("span",{className:"text-sm","data-testid":`text-employee-count-${a.id}`,children:[a.employeeCount||0," employees"]})]})]})})}),i&&(0,b.jsxs)(b.Fragment,{children:[d&&l&&(0,b.jsx)("div",{className:"ml-10 mb-3 space-y-1",children:a.employees?.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground p-2 rounded hover-elevate",children:[(0,b.jsx)(C.User,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:a.name}),a.role&&(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:a.role})]},a.id))}),k&&a.children?.map(a=>(0,b.jsx)(L,{unit:a,showEmployees:d,level:h+1},a.id))]})]})}function M(){let a=(0,d.useRouter)(),[f,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{!async function(){if((0,K.isDemoMode)()){h(K.DEMO_ORG_UNITS.filter(a=>!a.parentId).map(a=>({id:a.id,name:a.name,code:a.code,type:a.type,employeeCount:a.employeeCount,createdAt:new Date().toISOString(),children:K.DEMO_ORG_UNITS.filter(b=>b.parentId===a.id).map(a=>({id:a.id,name:a.name,code:a.code,type:a.type,employeeCount:a.employeeCount,createdAt:new Date().toISOString()}))}))),j(!1);return}h(await I()),j(!1)}()},[]),i)return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-8 bg-muted rounded w-1/3"}),(0,b.jsx)("div",{className:"h-64 bg-muted rounded"})]})});let q=f.reduce((a,b)=>a+(b.employeeCount||0),0);return 0===f.length?(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold","data-testid":"text-page-title",children:"Organization Overview"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"0 units, 0 employees"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(g.Button,{onClick:()=>p(!0),"data-testid":"button-create-unit",children:[(0,b.jsx)(F.Plus,{className:"h-4 w-4 mr-2"}),J.COPY.actions.createUnit]}),(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>n(!0),"data-testid":"button-import-org",children:[(0,b.jsx)(G.Upload,{className:"h-4 w-4 mr-2"}),J.COPY.actions.importOrgStructure]})]})]}),(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(A.Building2,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,b.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:J.COPY.emptyStates.organization.title}),(0,b.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6 max-w-md mx-auto",children:J.COPY.emptyStates.organization.description}),(0,b.jsxs)(g.Button,{onClick:()=>p(!0),"data-testid":"button-create-unit-empty",children:[(0,b.jsx)(F.Plus,{className:"h-4 w-4 mr-2"}),J.COPY.actions.createUnit]})]})}),o&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,b.jsxs)(e.Card,{className:"max-w-md mx-4",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Coming Soon"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Organization unit management is coming soon. For now, you can explore the demo data or import employees to get started."}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Button,{onClick:()=>p(!1),children:"Close"}),(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>a.push("/app/setup"),children:"Go to Setup"})]})]})]})}),m&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,b.jsxs)(e.Card,{className:"max-w-md mx-4",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Coming Soon"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"CSV import for organization structure is coming soon."}),(0,b.jsx)(g.Button,{onClick:()=>n(!1),children:"Close"})]})]})})]}):(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold","data-testid":"text-page-title",children:"Organization Overview"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:[f.length," units, ",q," total employees"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Show employees"}),(0,b.jsx)(z,{checked:k,onCheckedChange:l,"data-testid":"switch-show-employees"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(g.Button,{onClick:()=>p(!0),"data-testid":"button-create-unit",children:[(0,b.jsx)(F.Plus,{className:"h-4 w-4 mr-2"}),J.COPY.actions.createUnit]}),(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>n(!0),"data-testid":"button-import-org",children:[(0,b.jsx)(G.Upload,{className:"h-4 w-4 mr-2"}),J.COPY.actions.importOrgStructure]})]})]})]}),(0,b.jsx)("div",{className:"space-y-4",children:f.map(a=>(0,b.jsx)(L,{unit:a,showEmployees:k},a.id))}),o&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,b.jsxs)(e.Card,{className:"max-w-md mx-4",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Coming Soon"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Organization unit management is coming soon. For now, you can explore the demo data or import employees to get started."}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Button,{onClick:()=>p(!1),children:"Close"}),(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>a.push("/app/setup"),children:"Go to Setup"})]})]})]})}),m&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,b.jsxs)(e.Card,{className:"max-w-md mx-4",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Coming Soon"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"CSV import for organization structure is coming soon."}),(0,b.jsx)(g.Button,{onClick:()=>n(!1),children:"Close"})]})]})})]})}a.s(["default",()=>M],55776)}];

//# sourceMappingURL=app_app_org_overview_page_tsx_7a1f62b8._.js.map