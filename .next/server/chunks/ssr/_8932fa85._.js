module.exports=[48654,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c})).displayName="CardDescription";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));h.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},73570,a=>{"use strict";let b=(0,a.i(70106).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);a.s(["AlertTriangle",()=>b],73570)},35227,a=>{"use strict";var b=a.i(72131),c=a.i(50944),d=a.i(70579);function e(){let[a,e]=(0,b.useState)(!0),f=(0,c.useRouter)();return(0,b.useEffect)(()=>{let a=!0;return async function(){try{!await (0,d.getAuthUser)()&&a?f.replace("/login"):a&&e(!1)}catch(b){console.error("Error checking auth",b),a&&f.replace("/login")}}(),()=>{a=!1}},[f]),{loading:a}}a.s(["useAuthGuard",()=>e])},60431,a=>{"use strict";var b=a.i(7291);let c=[{id:"sick_leave",name:"Sick Leave Follow-up",description:"Structured follow-up process for employees on sick leave according to Swedish labor law",category:"health",defaultSteps:[{title:"Day 1 Contact",description:"Manager contacts employee to check in",daysFromStart:1,responsibleRole:"manager"},{title:"Week 1 Review",description:"Assess if return-to-work plan needed",daysFromStart:7,responsibleRole:"hr"},{title:"Day 14 Coordination",description:"Evaluate need for rehab coordination with Försäkringskassan",daysFromStart:14,responsibleRole:"hr"},{title:"Day 30 Meeting",description:"Formal meeting to discuss return or continued leave",daysFromStart:30,responsibleRole:"manager"},{title:"Day 60 Rehab Plan",description:"If applicable, create detailed rehabilitation plan",daysFromStart:60,responsibleRole:"hr"}]},{id:"rehab",name:"Rehabilitation Process",description:"Comprehensive rehabilitation plan for returning employees to full capacity",category:"health",defaultSteps:[{title:"Initial Assessment",description:"Assess current capacity and restrictions",daysFromStart:0,responsibleRole:"hr"},{title:"Doctor Consultation",description:"Review medical recommendations",daysFromStart:3,responsibleRole:"hr"},{title:"Workplace Adjustment",description:"Implement necessary workplace adjustments",daysFromStart:7,responsibleRole:"manager"},{title:"Week 2 Check-in",description:"Review progress and adjust if needed",daysFromStart:14,responsibleRole:"manager"},{title:"Week 4 Evaluation",description:"Formal evaluation of rehab progress",daysFromStart:28,responsibleRole:"hr"},{title:"Completion Review",description:"Final assessment and closure",daysFromStart:56,responsibleRole:"hr"}]},{id:"parental_leave",name:"Parental Leave",description:"Manage parental leave transitions smoothly for both departure and return",category:"leave",defaultSteps:[{title:"Notification Received",description:"Record parental leave request and planned dates",daysFromStart:0,responsibleRole:"hr"},{title:"Handover Planning",description:"Plan work handover and coverage",daysFromStart:7,responsibleRole:"manager"},{title:"Backfill Decision",description:"Determine if temporary replacement needed",daysFromStart:14,responsibleRole:"hr"},{title:"Pre-departure Meeting",description:"Final handover meeting before leave",daysFromStart:-7,responsibleRole:"manager"},{title:"Return Contact",description:"Contact employee 30 days before planned return",daysFromStart:-30,responsibleRole:"hr"},{title:"Return Planning",description:"Plan reboarding activities",daysFromStart:-14,responsibleRole:"manager"}]},{id:"reboarding",name:"Reboarding",description:"Re-integrate employees returning from extended leave",category:"lifecycle",defaultSteps:[{title:"Welcome Back Meeting",description:"Discuss changes and expectations",daysFromStart:0,responsibleRole:"manager"},{title:"System Access Check",description:"Verify all system access is active",daysFromStart:0,responsibleRole:"hr"},{title:"Training Update",description:"Review and schedule any required training updates",daysFromStart:3,responsibleRole:"manager"},{title:"Week 1 Check-in",description:"Discuss how re-integration is going",daysFromStart:7,responsibleRole:"manager"},{title:"30-day Review",description:"Formal review of reboarding success",daysFromStart:30,responsibleRole:"hr"}]},{id:"onboarding",name:"New Employee Onboarding",description:"Standard onboarding process for new employees",category:"lifecycle",defaultSteps:[{title:"Pre-start Preparation",description:"Prepare equipment, accounts, and workspace",daysFromStart:-7,responsibleRole:"hr"},{title:"Day 1 Welcome",description:"Welcome meeting and office tour",daysFromStart:0,responsibleRole:"manager"},{title:"HR Introduction",description:"Policies, benefits, and compliance training",daysFromStart:1,responsibleRole:"hr"},{title:"Week 1 Check-in",description:"Review first week experience",daysFromStart:5,responsibleRole:"manager"},{title:"30-day Review",description:"Formal review of onboarding progress",daysFromStart:30,responsibleRole:"manager"},{title:"90-day Review",description:"End of probation review",daysFromStart:90,responsibleRole:"hr"}]},{id:"offboarding",name:"Employee Offboarding",description:"Standard offboarding process for departing employees",category:"lifecycle",defaultSteps:[{title:"Exit Notice Received",description:"Document resignation or termination details",daysFromStart:0,responsibleRole:"hr"},{title:"Handover Planning",description:"Plan knowledge transfer and handover",daysFromStart:1,responsibleRole:"manager"},{title:"Exit Interview Scheduled",description:"Schedule exit interview if applicable",daysFromStart:7,responsibleRole:"hr"},{title:"Equipment Return",description:"Collect company equipment and access cards",daysFromStart:-2,responsibleRole:"hr"},{title:"Final Day Procedures",description:"System access revocation, final paperwork",daysFromStart:0,responsibleRole:"hr"},{title:"Post-departure Cleanup",description:"Archive data, update org charts",daysFromStart:1,responsibleRole:"hr"}]}];function d(){return c}async function e(a){let c=b.supabase.from("hr_workflow_instances").select("*").order("started_at",{ascending:!1});a?.status&&(c=c.eq("status",a.status)),a?.employeeId&&(c=c.eq("employee_id",a.employeeId)),a?.templateId&&(c=c.eq("template_id",a.templateId));let{data:d,error:e}=await c;return e||!d?[]:d.map(i)}async function f(a){let{data:c,error:d}=await b.supabase.from("hr_workflow_instances").select("*").eq("id",a).single();return d||!c?null:i(c)}async function g(a,c,d,e){let g=await f(a);if(!g)return!1;let h=g.steps.map(a=>a.id===c?{...a,isCompleted:!0,completedAt:new Date().toISOString(),completedBy:d,notes:e}:a),i=h.every(a=>a.isCompleted),{error:j}=await b.supabase.from("hr_workflow_instances").update({steps:h,status:i?"completed":"active",completed_at:i?new Date().toISOString():null}).eq("id",a);return!j}async function h(a){let{error:c}=await b.supabase.from("hr_workflow_instances").update({status:"cancelled"}).eq("id",a);return!c}function i(a){return{id:a.id,templateId:a.template_id,templateName:a.template_name,employeeId:a.employee_id,employeeName:a.employee_name,startedAt:a.started_at,dueDate:a.due_date,status:a.status,steps:a.steps||[],createdBy:a.created_by,completedAt:a.completed_at,notes:a.notes}}a.s(["WORKFLOW_TEMPLATES",0,c,"cancelWorkflow",()=>h,"completeWorkflowStep",()=>g,"getWorkflowById",()=>f,"getWorkflowInstances",()=>e,"getWorkflowTemplates",()=>d])},39963,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(48654),f=a.i(73570),g=a.i(47033),h=a.i(60431);async function i(){let a=await (0,h.getWorkflowInstances)({status:"active"}),b=new Date().toISOString().slice(0,10),c=new Date(`${b}T00:00:00`),d=new Date(c);d.setDate(d.getDate()+7);let e=[],f=[],g=[];for(let b of a){let a=h.WORKFLOW_TEMPLATES.find(a=>a.id===b.templateId);for(let h of b.steps){if(h.isCompleted)continue;let i=b.startedAt?function(a,b){let c=new Date(a);return c.setDate(c.getDate()+b),c.toISOString().slice(0,10)}(b.startedAt,h.daysFromStart):null,j={id:h.id,stepTitle:h.title,status:h.isCompleted?"done":"not_started",dueDate:i,workflowInstanceId:b.id,workflowName:b.templateName||a?.name||"Workflow",workflowCategory:a?.category||null,employeeId:b.employeeId,employeeName:b.employeeName||null};if(!i)continue;let k=new Date(`${i}T00:00:00`);k<c?e.push(j):k.getTime()===c.getTime()?f.push(j):k>c&&k<=d&&g.push(j)}}return e.sort((a,b)=>(a.dueDate||"").localeCompare(b.dueDate||"")),f.sort((a,b)=>a.stepTitle.localeCompare(b.stepTitle)),g.sort((a,b)=>(a.dueDate||"").localeCompare(b.dueDate||"")),{overdue:e,today:f,upcoming:g}}var j=a.i(35227);function k(){let{loading:a}=(0,j.useAuthGuard)();return a?(0,b.jsx)("main",{className:"hr-page",children:(0,b.jsx)("p",{children:"Checking access..."})}):(0,b.jsx)(l,{})}function l(){let[a,d]=(0,c.useState)(null),[h,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(null),[n,o]=(0,c.useState)(!0);(0,c.useEffect)(()=>{!async function(){let a=await (0,g.getCurrentUser)();if(!a||"HR_ADMIN"!==a.role){o(!1),j(!1);return}try{let a=await i();d(a)}catch(a){console.error(a),l("Could not load HR tasks.")}finally{j(!1)}}()},[]);let p=(a?.overdue.length??0)+(a?.today.length??0)+(a?.upcoming.length??0);return h?(0,b.jsx)("main",{className:"hr-page",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),(0,b.jsx)("div",{className:"hr-kpi-grid",children:[1,2,3,4].map(a=>(0,b.jsx)("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl"},a))}),(0,b.jsx)("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded"})]})}):n?(0,b.jsxs)("main",{className:"hr-page","data-testid":"hr-tasks-page",children:[(0,b.jsx)("header",{className:"hr-page__header",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"hr-page__title",children:"HR Tasks"}),(0,b.jsx)("p",{className:"hr-page__subtitle",children:"All open workflow steps, sorted by urgency - overdue, today and the coming week."})]})}),k&&(0,b.jsx)("p",{className:"hr-error",children:k}),!k&&a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("section",{className:"hr-kpi-grid","data-testid":"kpi-grid",children:[(0,b.jsxs)("div",{className:"hr-kpi",children:[(0,b.jsx)("div",{className:"hr-kpi__label",children:"Active tasks"}),(0,b.jsx)("div",{className:"hr-kpi__value","data-testid":"kpi-active",children:p})]}),(0,b.jsxs)("div",{className:"hr-kpi",children:[(0,b.jsx)("div",{className:"hr-kpi__label",children:"Overdue"}),(0,b.jsx)("div",{className:"hr-kpi__value hr-kpi__value--danger","data-testid":"kpi-overdue",children:a.overdue.length})]}),(0,b.jsxs)("div",{className:"hr-kpi",children:[(0,b.jsx)("div",{className:"hr-kpi__label",children:"Due today"}),(0,b.jsx)("div",{className:"hr-kpi__value hr-kpi__value--warn","data-testid":"kpi-today",children:a.today.length})]}),(0,b.jsxs)("div",{className:"hr-kpi",children:[(0,b.jsx)("div",{className:"hr-kpi__label",children:"Next 7 days"}),(0,b.jsx)("div",{className:"hr-kpi__value hr-kpi__value--ok","data-testid":"kpi-upcoming",children:a.upcoming.length})]})]}),(0,b.jsx)(m,{title:"Overdue",description:"Tasks that should already have been completed.",tasks:a.overdue,badgeClass:"hr-pill--danger",testId:"section-overdue"}),(0,b.jsx)(m,{title:"Due today",description:"Tasks that must be handled today.",tasks:a.today,badgeClass:"hr-pill--warn",testId:"section-today"}),(0,b.jsx)(m,{title:"Coming 7 days",description:"Tasks with deadlines within the next week.",tasks:a.upcoming,badgeClass:"hr-pill--ok",testId:"section-upcoming"})]})]}):(0,b.jsx)("main",{className:"hr-page",children:(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(f.AlertTriangle,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Access Denied"}),(0,b.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"This page is only accessible to HR Administrators."})]})})})}function m({title:a,description:c,tasks:d,badgeClass:e,testId:f}){return(0,b.jsxs)("section",{className:"hr-task-section","data-testid":f,children:[(0,b.jsxs)("header",{className:"hr-task-section__header",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"hr-section__title",children:a}),(0,b.jsx)("p",{className:"hr-task-section__description",children:c})]}),(0,b.jsx)("span",{className:`hr-pill ${e}`,children:d.length})]}),0===d.length?(0,b.jsx)("p",{className:"hr-task-empty",children:"No tasks in this bucket."}):(0,b.jsx)("div",{className:"hr-task-list",children:d.map(a=>(0,b.jsx)(n,{task:a},a.id))})]})}function n({task:a}){let c=a.dueDate?new Date(a.dueDate).toLocaleDateString("sv-SE"):"No due date",e="not_started"===a.status?"Not started":"in_progress"===a.status?"In progress":"done"===a.status?"Done":a.status;return(0,b.jsxs)(d.default,{href:"/app/hr/workflows",className:"hr-task-row","data-testid":`task-row-${a.id}`,children:[(0,b.jsxs)("div",{className:"hr-task-row__main",children:[(0,b.jsx)("h3",{className:"hr-task-row__title",children:a.stepTitle}),(0,b.jsxs)("p",{className:"hr-task-row__subtitle",children:[a.employeeName??"Unknown employee"," - ",a.workflowName]})]}),(0,b.jsxs)("div",{className:"hr-task-row__meta",children:[(0,b.jsx)("span",{className:"hr-task-row__date",children:c}),(0,b.jsx)("span",{className:"hr-task-row__status",children:e})]})]})}a.s(["default",()=>k],39963)}];

//# sourceMappingURL=_8932fa85._.js.map