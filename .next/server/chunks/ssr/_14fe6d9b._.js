module.exports=[35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},96221,a=>{"use strict";let b=(0,a.i(70106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},49455,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(7291),e=a.i(48654),f=a.i(40695),g=a.i(5522),h=a.i(54161),i=a.i(87682),j=a.i(15618),k=a.i(83497),l=a.i(16201),m=a.i(96221);function n(){let[a,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)({name:"",serialNumber:"",category:""}),w=async()=>{r(!0);let{data:a}=await d.supabase.from("equipment").select("*"),{data:b}=await d.supabase.from("employee_equipment").select("*, employees:employee_id(name)").eq("status","assigned"),{data:c}=await d.supabase.from("employees").select("id, name, employee_number, role, line, team, is_active").eq("is_active",!0);n((a||[]).map(a=>{let c=(b||[]).find(b=>b.equipment_id===a.id);return{id:a.id,name:a.name,serialNumber:a.serial_number,category:a.category,requiredForRole:a.required_for_role,assignedTo:c?.employees?.name,assignmentId:c?.id,assignmentStatus:c?.status}})),p((c||[]).map(a=>({id:a.id,name:a.name,employeeNumber:a.employee_number,role:a.role,line:a.line,team:a.team,employmentType:"permanent",isActive:a.is_active}))),r(!1)};(0,c.useEffect)(()=>{w()},[]);let x=async()=>{u.name&&u.serialNumber&&(await d.supabase.from("equipment").insert({name:u.name,serial_number:u.serialNumber,category:u.category||null}),v({name:"",serialNumber:"",category:""}),t(!1),w())},y=async(a,b)=>{let c=new Date;c.setFullYear(c.getFullYear()+1),await d.supabase.from("employee_equipment").insert({equipment_id:a,employee_id:b,assigned_date:new Date().toISOString().slice(0,10),return_date:c.toISOString().slice(0,10),status:"assigned"}),w()},z=async a=>{await d.supabase.from("employee_equipment").update({status:"returned",return_date:new Date().toISOString().slice(0,10)}).eq("id",a),w()};return q?(0,b.jsx)("div",{className:"p-6 flex items-center justify-center",children:(0,b.jsx)(m.Loader2,{className:"h-6 w-6 animate-spin"})}):(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Equipment Management"}),(0,b.jsxs)(f.Button,{onClick:()=>t(!s),"data-testid":"button-add-equipment",children:[(0,b.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Add Equipment"]})]}),s&&(0,b.jsxs)(e.Card,{className:"mb-6",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{className:"text-lg",children:"Add New Equipment"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsx)(g.Input,{placeholder:"Name",value:u.name,onChange:a=>v({...u,name:a.target.value}),"data-testid":"input-equipment-name"}),(0,b.jsx)(g.Input,{placeholder:"Serial Number",value:u.serialNumber,onChange:a=>v({...u,serialNumber:a.target.value}),"data-testid":"input-equipment-serial"}),(0,b.jsx)(g.Input,{placeholder:"Category",value:u.category,onChange:a=>v({...u,category:a.target.value}),"data-testid":"input-equipment-category"})]}),(0,b.jsx)(f.Button,{className:"mt-4",onClick:x,"data-testid":"button-save-equipment",children:"Save Equipment"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.map(a=>(0,b.jsxs)(e.Card,{"data-testid":`card-equipment-${a.id}`,children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)(e.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(k.Package,{className:"h-4 w-4"}),a.name]}),a.assignedTo?(0,b.jsx)(h.Badge,{variant:"secondary",children:"Assigned"}):(0,b.jsx)(h.Badge,{variant:"outline",children:"Available"})]})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-2",children:["S/N: ",a.serialNumber]}),a.category&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-2",children:["Category: ",a.category]}),a.assignedTo?(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsxs)("p",{className:"text-sm mb-2",children:["Assigned to: ",(0,b.jsx)("span",{className:"font-medium",children:a.assignedTo})]}),(0,b.jsxs)(f.Button,{size:"sm",variant:"outline",onClick:()=>a.assignmentId&&z(a.assignmentId),"data-testid":`button-return-${a.id}`,children:[(0,b.jsx)(l.CheckCircle,{className:"h-3 w-3 mr-1"}),"Mark Returned"]})]}):(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsxs)(i.Select,{onValueChange:b=>y(a.id,b),children:[(0,b.jsx)(i.SelectTrigger,{"data-testid":`select-assign-${a.id}`,children:(0,b.jsx)(i.SelectValue,{placeholder:"Assign to employee..."})}),(0,b.jsx)(i.SelectContent,{children:o.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id,children:a.name},a.id))})]})})]})]},a.id)),0===a.length&&(0,b.jsx)("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:'No equipment registered. Click "Add Equipment" to get started.'})]})]})}a.s(["default",()=>n])}];

//# sourceMappingURL=_14fe6d9b._.js.map