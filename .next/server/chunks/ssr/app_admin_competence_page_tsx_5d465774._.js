module.exports=[18127,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(35227),e=a.i(38246),f=a.i(92169),g=a.i(15618),h=a.i(99464),i=a.i(3314),j=a.i(33441),k=a.i(33508);function l(){let{loading:a}=(0,d.useAuthGuard)(),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)("all"),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)({name:"",description:""}),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)({name:"",code:"",group_id:"",description:"",is_safety_critical:!1}),[F,G]=(0,c.useState)(!1);async function H(){try{q(!0);let[a,b]=await Promise.all([(0,f.listCompetenceGroups)(),(0,f.listCompetences)()]);m(a),o(b)}catch(a){s("Failed to load data"),console.error(a)}finally{q(!1)}}function I(){w(null),y({name:"",description:""})}async function J(){try{v?(await (0,f.updateCompetenceGroup)(v,{name:x.name,description:x.description||null}),w(null)):(await (0,f.createCompetenceGroup)({name:x.name,description:x.description||void 0}),A(!1)),y({name:"",description:""}),H()}catch(a){console.error(a),alert("Failed to save group")}}function K(){C(null),E({name:"",code:"",group_id:"",description:"",is_safety_critical:!1})}async function L(){try{B?(await (0,f.updateCompetence)(B,{name:D.name,code:D.code||null,group_id:D.group_id||null,description:D.description||null,is_safety_critical:D.is_safety_critical}),C(null)):(await (0,f.createCompetence)({name:D.name,code:D.code||void 0,group_id:D.group_id||null,description:D.description||void 0,is_safety_critical:D.is_safety_critical}),G(!1)),E({name:"",code:"",group_id:"",description:"",is_safety_critical:!1}),H()}catch(a){console.error(a),alert("Failed to save competence")}}async function M(a){try{await (0,f.updateCompetence)(a.id,{active:!a.active}),H()}catch(a){console.error(a),alert("Failed to update competence")}}if((0,c.useEffect)(()=>{a||H()},[a]),a)return(0,b.jsx)("main",{className:"hr-page",children:(0,b.jsx)("p",{children:"Checking accessâ€¦"})});if(p)return(0,b.jsx)("main",{className:"hr-page",children:(0,b.jsx)("p",{className:"hr-page__subtitle",children:"Loading..."})});if(r)return(0,b.jsx)("main",{className:"hr-page",children:(0,b.jsx)("p",{className:"hr-error",children:r})});let N="all"===t?n:"ungrouped"===t?n.filter(a=>!a.group_id):n.filter(a=>a.group_id===t);return(0,b.jsxs)("main",{className:"hr-page",children:[(0,b.jsx)("div",{className:"hr-page__header",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"hr-page__title",children:"Competence Admin"}),(0,b.jsx)("p",{className:"hr-page__subtitle",children:"Manage competence groups and competences used in matrices and gaps."})]})}),(0,b.jsxs)("nav",{className:"hr-breadcrumb",style:{marginBottom:16},children:[(0,b.jsx)(e.default,{href:"/app/hr/tasks",className:"hr-breadcrumb__link",children:"Dashboard"}),(0,b.jsx)("span",{className:"hr-breadcrumb__separator",children:"/"}),(0,b.jsx)("span",{children:"Competence Admin"})]}),(0,b.jsxs)("div",{className:"admin-grid",children:[(0,b.jsxs)("div",{className:"hr-card","data-testid":"panel-groups",children:[(0,b.jsx)("div",{className:"hr-section__title",style:{padding:"12px 16px",borderBottom:"1px solid var(--hr-border)"},children:"Groups"}),(0,b.jsxs)("div",{style:{padding:16},children:[l.map(a=>(0,b.jsx)("div",{"data-testid":`group-row-${a.id}`,children:v===a.id?(0,b.jsxs)("div",{style:{marginBottom:12,padding:12,background:"var(--hr-bg-secondary)",borderRadius:8},children:[(0,b.jsx)("div",{className:"hr-form-field",children:(0,b.jsx)("input",{type:"text",className:"hr-input",value:x.name,onChange:a=>y({...x,name:a.target.value}),placeholder:"Group name","data-testid":"input-edit-group-name"})}),(0,b.jsx)("div",{className:"hr-form-field",children:(0,b.jsx)("input",{type:"text",className:"hr-input",value:x.description,onChange:a=>y({...x,description:a.target.value}),placeholder:"Description (optional)","data-testid":"input-edit-group-description"})}),(0,b.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,b.jsxs)("button",{className:"hr-button hr-button--primary hr-button--sm",onClick:J,"data-testid":"button-save-edit-group",children:[(0,b.jsx)(j.Check,{size:14})," Save"]}),(0,b.jsxs)("button",{className:"hr-button hr-button--ghost hr-button--sm",onClick:I,children:[(0,b.jsx)(k.X,{size:14})," Cancel"]})]})]}):(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px 0",borderBottom:"1px solid var(--hr-border-light)"},children:[(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsx)("div",{style:{fontWeight:500},children:a.name}),a.description&&(0,b.jsx)("div",{className:"hr-muted",style:{fontSize:13},children:a.description})]}),(0,b.jsx)("button",{className:"hr-button hr-button--ghost hr-button--sm",onClick:()=>{w(a.id),y({name:a.name,description:a.description||""})},"data-testid":`button-edit-group-${a.id}`,children:(0,b.jsx)(h.Pencil,{size:14})})]})},a.id)),0===l.length&&!z&&(0,b.jsx)("p",{className:"hr-muted",style:{padding:"12px 0"},children:"No groups yet."}),z?(0,b.jsxs)("div",{style:{marginTop:12,padding:12,background:"var(--hr-bg-secondary)",borderRadius:8},children:[(0,b.jsx)("div",{className:"hr-form-field",children:(0,b.jsx)("input",{type:"text",className:"hr-input",value:x.name,onChange:a=>y({...x,name:a.target.value}),placeholder:"Group name","data-testid":"input-new-group-name"})}),(0,b.jsx)("div",{className:"hr-form-field",children:(0,b.jsx)("input",{type:"text",className:"hr-input",value:x.description,onChange:a=>y({...x,description:a.target.value}),placeholder:"Description (optional)","data-testid":"input-new-group-description"})}),(0,b.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,b.jsxs)("button",{className:"hr-button hr-button--primary hr-button--sm",onClick:J,"data-testid":"button-save-new-group",children:[(0,b.jsx)(j.Check,{size:14})," Add"]}),(0,b.jsxs)("button",{className:"hr-button hr-button--ghost hr-button--sm",onClick:()=>{A(!1),y({name:"",description:""})},children:[(0,b.jsx)(k.X,{size:14})," Cancel"]})]})]}):(0,b.jsxs)("button",{className:"hr-button hr-button--secondary hr-button--sm",onClick:()=>A(!0),style:{marginTop:12},"data-testid":"button-new-group",children:[(0,b.jsx)(g.Plus,{size:14})," Add Group"]})]})]}),(0,b.jsxs)("div",{className:"hr-card","data-testid":"panel-competences",children:[(0,b.jsxs)("div",{className:"hr-section__title",style:{padding:"12px 16px",borderBottom:"1px solid var(--hr-border)",display:"flex",alignItems:"center",justifyContent:"space-between",gap:16},children:[(0,b.jsx)("span",{children:"Competences"}),(0,b.jsxs)("select",{className:"hr-select",value:t,onChange:a=>u(a.target.value),style:{width:"auto",minWidth:150},"data-testid":"select-group-filter",children:[(0,b.jsx)("option",{value:"all",children:"All Groups"}),(0,b.jsx)("option",{value:"ungrouped",children:"Ungrouped"}),l.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{style:{padding:16},children:[(0,b.jsxs)("table",{className:"hr-table",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Name"}),(0,b.jsx)("th",{children:"Code"}),(0,b.jsx)("th",{children:"Group"}),(0,b.jsx)("th",{children:"Safety"}),(0,b.jsx)("th",{children:"Active"}),(0,b.jsx)("th",{style:{width:60},children:"Edit"})]})}),(0,b.jsxs)("tbody",{children:[N.map(a=>(0,b.jsx)("tr",{"data-testid":`competence-row-${a.id}`,children:B===a.id?(0,b.jsx)("td",{colSpan:6,children:(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,padding:"8px 0"},children:[(0,b.jsxs)("div",{className:"hr-form-field",children:[(0,b.jsx)("label",{className:"hr-form-label",children:"Name"}),(0,b.jsx)("input",{type:"text",className:"hr-input",value:D.name,onChange:a=>E({...D,name:a.target.value}),"data-testid":"input-edit-competence-name"})]}),(0,b.jsxs)("div",{className:"hr-form-field",children:[(0,b.jsx)("label",{className:"hr-form-label",children:"Code"}),(0,b.jsx)("input",{type:"text",className:"hr-input",value:D.code,onChange:a=>E({...D,code:a.target.value}),"data-testid":"input-edit-competence-code"})]}),(0,b.jsxs)("div",{className:"hr-form-field",children:[(0,b.jsx)("label",{className:"hr-form-label",children:"Group"}),(0,b.jsxs)("select",{className:"hr-select",value:D.group_id,onChange:a=>E({...D,group_id:a.target.value}),"data-testid":"select-edit-competence-group",children:[(0,b.jsx)("option",{value:"",children:"No Group"}),l.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"hr-form-field",children:[(0,b.jsx)("label",{className:"hr-form-label",children:"Description"}),(0,b.jsx)("input",{type:"text",className:"hr-input",value:D.description,onChange:a=>E({...D,description:a.target.value}),"data-testid":"input-edit-competence-description"})]}),(0,b.jsxs)("div",{className:"hr-form-field hr-form-field--inline",children:[(0,b.jsx)("input",{type:"checkbox",id:"edit-safety-critical",checked:D.is_safety_critical,onChange:a=>E({...D,is_safety_critical:a.target.checked}),"data-testid":"checkbox-edit-safety-critical"}),(0,b.jsx)("label",{htmlFor:"edit-safety-critical",className:"hr-form-label",children:"Safety Critical"})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"flex-end"},children:[(0,b.jsxs)("button",{className:"hr-button hr-button--primary hr-button--sm",onClick:L,"data-testid":"button-save-edit-competence",children:[(0,b.jsx)(j.Check,{size:14})," Save"]}),(0,b.jsxs)("button",{className:"hr-button hr-button--ghost hr-button--sm",onClick:K,children:[(0,b.jsx)(k.X,{size:14})," Cancel"]})]})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("td",{children:(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[a.is_safety_critical&&(0,b.jsx)(i.Shield,{size:14,className:"hr-icon--warning"}),a.name]})}),(0,b.jsx)("td",{children:a.code||"-"}),(0,b.jsx)("td",{children:(a=>{if(!a)return"-";let b=l.find(b=>b.id===a);return b?.name||"-"})(a.group_id)}),(0,b.jsx)("td",{children:a.is_safety_critical?"Yes":"No"}),(0,b.jsx)("td",{children:(0,b.jsx)("button",{className:`hr-toggle ${a.active?"hr-toggle--on":"hr-toggle--off"}`,onClick:()=>M(a),"data-testid":`toggle-active-${a.id}`,title:a.active?"Active":"Inactive",children:a.active?(0,b.jsx)(j.Check,{size:12}):(0,b.jsx)(k.X,{size:12})})}),(0,b.jsx)("td",{children:(0,b.jsx)("button",{className:"hr-button hr-button--ghost hr-button--sm",onClick:()=>{C(a.id),E({name:a.name,code:a.code||"",group_id:a.group_id||"",description:a.description||"",is_safety_critical:a.is_safety_critical})},"data-testid":`button-edit-competence-${a.id}`,children:(0,b.jsx)(h.Pencil,{size:14})})})]})},a.id)),0===N.length&&!F&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:6,className:"hr-muted",style:{textAlign:"center",padding:24},children:"No competences found."})})]})]}),F?(0,b.jsxs)("div",{style:{marginTop:16,padding:16,background:"var(--hr-bg-secondary)",borderRadius:8},children:[(0,b.jsx)("h4",{className:"hr-section__title",style:{marginBottom:12},children:"Add Competence"}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,b.jsxs)("div",{className:"hr-form-field",children:[(0,b.jsx)("label",{className:"hr-form-label",children:"Name *"}),(0,b.jsx)("input",{type:"text",className:"hr-input",value:D.name,onChange:a=>E({...D,name:a.target.value}),"data-testid":"input-new-competence-name"})]}),(0,b.jsxs)("div",{className:"hr-form-field",children:[(0,b.jsx)("label",{className:"hr-form-label",children:"Code"}),(0,b.jsx)("input",{type:"text",className:"hr-input",value:D.code,onChange:a=>E({...D,code:a.target.value}),placeholder:"e.g., CNC, WLD","data-testid":"input-new-competence-code"})]}),(0,b.jsxs)("div",{className:"hr-form-field",children:[(0,b.jsx)("label",{className:"hr-form-label",children:"Group"}),(0,b.jsxs)("select",{className:"hr-select",value:D.group_id,onChange:a=>E({...D,group_id:a.target.value}),"data-testid":"select-new-competence-group",children:[(0,b.jsx)("option",{value:"",children:"No Group"}),l.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"hr-form-field",children:[(0,b.jsx)("label",{className:"hr-form-label",children:"Description"}),(0,b.jsx)("input",{type:"text",className:"hr-input",value:D.description,onChange:a=>E({...D,description:a.target.value}),"data-testid":"input-new-competence-description"})]}),(0,b.jsxs)("div",{className:"hr-form-field hr-form-field--inline",children:[(0,b.jsx)("input",{type:"checkbox",id:"new-safety-critical",checked:D.is_safety_critical,onChange:a=>E({...D,is_safety_critical:a.target.checked}),"data-testid":"checkbox-new-safety-critical"}),(0,b.jsx)("label",{htmlFor:"new-safety-critical",className:"hr-form-label",children:"Safety Critical"})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"flex-end"},children:[(0,b.jsxs)("button",{className:"hr-button hr-button--primary hr-button--sm",onClick:L,"data-testid":"button-save-new-competence",children:[(0,b.jsx)(j.Check,{size:14})," Add"]}),(0,b.jsxs)("button",{className:"hr-button hr-button--ghost hr-button--sm",onClick:()=>{G(!1),E({name:"",code:"",group_id:"",description:"",is_safety_critical:!1})},children:[(0,b.jsx)(k.X,{size:14})," Cancel"]})]})]})]}):(0,b.jsxs)("button",{className:"hr-button hr-button--primary hr-button--sm",onClick:()=>G(!0),style:{marginTop:16},"data-testid":"button-new-competence",children:[(0,b.jsx)(g.Plus,{size:14})," Add Competence"]})]})]})]})]})}a.s(["default",()=>l])}];

//# sourceMappingURL=app_admin_competence_page_tsx_5d465774._.js.map