{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/arrow-left.ts","../../../../app/app/employees/%5Bid%5D/salary/new/page.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('ArrowLeft', [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n]);\n\nexport default ArrowLeft;\n","\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useParams, useRouter } from \"next/navigation\";\nimport { ArrowLeft } from \"lucide-react\";\nimport { supabase } from \"@/lib/supabaseClient\";\n\nexport default function NewSalaryRevisionPage() {\n  const params = useParams();\n  const router = useRouter();\n  const employeeId = params.id as string;\n\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [employeeName, setEmployeeName] = useState(\"\");\n\n  const [formData, setFormData] = useState({\n    revisionDate: new Date().toISOString().split(\"T\")[0],\n    previousSalary: 0,\n    newSalary: 0,\n    salaryType: \"monthly\" as \"monthly\" | \"hourly\",\n    reason: \"\",\n  });\n\n  useEffect(() => {\n    async function load() {\n      const [employeeRes, salaryRes] = await Promise.all([\n        supabase.from(\"employees\").select(\"name\").eq(\"id\", employeeId).single(),\n        supabase\n          .from(\"salary_records\")\n          .select(\"salary_amount_sek, salary_type\")\n          .eq(\"employee_id\", employeeId)\n          .order(\"effective_from\", { ascending: false })\n          .limit(1),\n      ]);\n\n      setEmployeeName(employeeRes.data?.name || \"\");\n\n      if (salaryRes.data && salaryRes.data.length > 0) {\n        setFormData((prev) => ({\n          ...prev,\n          previousSalary: parseFloat(salaryRes.data[0].salary_amount_sek),\n          newSalary: parseFloat(salaryRes.data[0].salary_amount_sek),\n          salaryType: salaryRes.data[0].salary_type || \"monthly\",\n        }));\n      }\n\n      setLoading(false);\n    }\n    load();\n  }, [employeeId]);\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setSaving(true);\n\n    try {\n      await supabase.from(\"salary_revisions\").insert({\n        employee_id: employeeId,\n        revision_date: formData.revisionDate,\n        previous_salary_sek: formData.previousSalary,\n        new_salary_sek: formData.newSalary,\n        salary_type: formData.salaryType,\n        reason: formData.reason || null,\n      });\n\n      await supabase.from(\"salary_records\").insert({\n        employee_id: employeeId,\n        effective_from: formData.revisionDate,\n        salary_amount_sek: formData.newSalary,\n        salary_type: formData.salaryType,\n      });\n\n      router.push(`/app/employees/${employeeId}`);\n    } catch (error) {\n      console.error(\"Error creating salary revision:\", error);\n      setSaving(false);\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"animate-pulse h-64 bg-gray-200 dark:bg-gray-700 rounded\" />\n      </div>\n    );\n  }\n\n  const changePercent =\n    formData.previousSalary > 0\n      ? (((formData.newSalary - formData.previousSalary) / formData.previousSalary) * 100).toFixed(1)\n      : 0;\n\n  return (\n    <div className=\"p-6 max-w-xl\">\n      <div className=\"flex items-center gap-4 mb-6\">\n        <button\n          onClick={() => router.back()}\n          className=\"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-5 w-5\" />\n        </button>\n        <div>\n          <h1 className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n            New Salary Revision\n          </h1>\n          <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n            For {employeeName}\n          </p>\n        </div>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              Revision Date *\n            </label>\n            <input\n              type=\"date\"\n              value={formData.revisionDate}\n              onChange={(e) => setFormData({ ...formData, revisionDate: e.target.value })}\n              required\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              data-testid=\"input-revision-date\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              Salary Type\n            </label>\n            <select\n              value={formData.salaryType}\n              onChange={(e) =>\n                setFormData({ ...formData, salaryType: e.target.value as \"monthly\" | \"hourly\" })\n              }\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              data-testid=\"select-salary-type\"\n            >\n              <option value=\"monthly\">Monthly</option>\n              <option value=\"hourly\">Hourly</option>\n            </select>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                Previous Salary (SEK)\n              </label>\n              <input\n                type=\"number\"\n                value={formData.previousSalary}\n                onChange={(e) =>\n                  setFormData({ ...formData, previousSalary: parseFloat(e.target.value) || 0 })\n                }\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white\"\n                data-testid=\"input-previous-salary\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                New Salary (SEK) *\n              </label>\n              <input\n                type=\"number\"\n                value={formData.newSalary}\n                onChange={(e) =>\n                  setFormData({ ...formData, newSalary: parseFloat(e.target.value) || 0 })\n                }\n                required\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                data-testid=\"input-new-salary\"\n              />\n            </div>\n          </div>\n\n          {formData.previousSalary > 0 && formData.newSalary !== formData.previousSalary && (\n            <div\n              className={`p-3 rounded-md ${\n                formData.newSalary > formData.previousSalary\n                  ? \"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400\"\n                  : \"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400\"\n              }`}\n            >\n              Change: {formData.newSalary > formData.previousSalary ? \"+\" : \"\"}\n              {(formData.newSalary - formData.previousSalary).toLocaleString(\"sv-SE\")} SEK (\n              {formData.newSalary > formData.previousSalary ? \"+\" : \"\"}\n              {changePercent}%)\n            </div>\n          )}\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              Reason\n            </label>\n            <textarea\n              value={formData.reason}\n              onChange={(e) => setFormData({ ...formData, reason: e.target.value })}\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-none\"\n              placeholder=\"Annual salary review, promotion, etc.\"\n              data-testid=\"textarea-reason\"\n            />\n          </div>\n        </div>\n\n        <div className=\"flex justify-end gap-3\">\n          <button\n            type=\"button\"\n            onClick={() => router.back()}\n            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700\"\n            data-testid=\"button-cancel\"\n          >\n            Cancel\n          </button>\n          <button\n            type=\"submit\"\n            disabled={saving}\n            className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 rounded-md\"\n            data-testid=\"button-save-revision\"\n          >\n            {saving ? \"Saving...\" : \"Save Revision\"}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}