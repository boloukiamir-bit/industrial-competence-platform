{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/pgClient.ts"],"sourcesContent":["import { Pool } from \"pg\";\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n  ssl: process.env.DATABASE_URL?.includes(\"localhost\") ? false : { rejectUnauthorized: false },\n});\n\nexport default pool;\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK,QAAQ,GAAG,CAAC,YAAY,EAAE,SAAS,eAAe,QAAQ;QAAE,oBAAoB;IAAM;AAC7F;uCAEe"}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/workflows/templates/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport pool from \"@/lib/pgClient\";\nimport { cookies } from \"next/headers\";\n\nasync function getOrgId(request: NextRequest): Promise<string | null> {\n  const orgId = request.headers.get(\"x-org-id\");\n  if (orgId) return orgId;\n  \n  const cookieStore = await cookies();\n  const orgCookie = cookieStore.get(\"current_org_id\");\n  return orgCookie?.value || null;\n}\n\nexport async function GET(request: NextRequest) {\n  try {\n    const orgId = await getOrgId(request);\n    if (!orgId) {\n      return NextResponse.json({ error: \"Organization ID required\" }, { status: 400 });\n    }\n\n    const templatesResult = await pool.query(\n      `SELECT id, name, description, category, is_active, created_at \n       FROM wf_templates \n       WHERE org_id = $1 AND is_active = true \n       ORDER BY name`,\n      [orgId]\n    );\n\n    const templates = await Promise.all(\n      templatesResult.rows.map(async (template) => {\n        const stepsResult = await pool.query(\n          `SELECT id, step_no, title, owner_role, default_due_days, required \n           FROM wf_template_steps \n           WHERE template_id = $1 \n           ORDER BY step_no`,\n          [template.id]\n        );\n        return {\n          ...template,\n          stepCount: stepsResult.rows.length,\n          steps: stepsResult.rows,\n        };\n      })\n    );\n\n    return NextResponse.json({ templates });\n  } catch (err) {\n    console.error(\"Templates error:\", err);\n    return NextResponse.json(\n      { error: err instanceof Error ? err.message : \"Failed to fetch templates\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEA,eAAe,SAAS,OAAoB;IAC1C,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC;IAClC,IAAI,OAAO,OAAO;IAElB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,YAAY,YAAY,GAAG,CAAC;IAClC,OAAO,WAAW,SAAS;AAC7B;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,QAAQ,MAAM,SAAS;QAC7B,IAAI,CAAC,OAAO;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA2B,GAAG;gBAAE,QAAQ;YAAI;QAChF;QAEA,MAAM,kBAAkB,MAAM,4HAAI,CAAC,KAAK,CACtC,CAAC;;;oBAGa,CAAC,EACf;YAAC;SAAM;QAGT,MAAM,YAAY,MAAM,QAAQ,GAAG,CACjC,gBAAgB,IAAI,CAAC,GAAG,CAAC,OAAO;YAC9B,MAAM,cAAc,MAAM,4HAAI,CAAC,KAAK,CAClC,CAAC;;;2BAGgB,CAAC,EAClB;gBAAC,SAAS,EAAE;aAAC;YAEf,OAAO;gBACL,GAAG,QAAQ;gBACX,WAAW,YAAY,IAAI,CAAC,MAAM;gBAClC,OAAO,YAAY,IAAI;YACzB;QACF;QAGF,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAU;IACvC,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,eAAe,QAAQ,IAAI,OAAO,GAAG;QAA4B,GAC1E;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}