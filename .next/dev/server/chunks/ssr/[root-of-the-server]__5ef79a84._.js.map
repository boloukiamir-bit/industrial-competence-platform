{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/supabaseClient.ts"],"sourcesContent":["import { createClient, SupabaseClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || \"\";\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || \"\";\n\nfunction createSupabaseClient(): SupabaseClient {\n  const hasCredentials = supabaseUrl && supabaseAnonKey;\n  \n  if (!hasCredentials) {\n    console.warn(\n      \"Supabase environment variables not set. \" +\n      \"Please ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are configured.\",\n      { urlSet: !!supabaseUrl, keySet: !!supabaseAnonKey }\n    );\n  }\n  \n  return createClient(\n    supabaseUrl || \"https://placeholder.supabase.co\", \n    supabaseAnonKey || \"placeholder\"\n  );\n}\n\nexport const supabase: SupabaseClient = createSupabaseClient();\n\nexport function getSupabaseClient(): SupabaseClient {\n  if (!supabaseUrl || !supabaseAnonKey) {\n    throw new Error(\n      \"Missing Supabase environment variables. \" +\n      \"Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.\"\n    );\n  }\n  return supabase;\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,wPAA6C;AAErE,SAAS;IACP,MAAM,iBAAiB,eAAe;IAEtC;;IAQA,OAAO,IAAA,uLAAY,EACjB,eAAe,mCACf,mBAAmB;AAEvB;AAEO,MAAM,WAA2B;AAEjC,SAAS;IACd;;IAMA,OAAO;AACT"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/services/auth.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\";\n\nexport async function signInWithEmail(email: string, password: string) {\n  const { data, error } = await supabase.auth.signInWithPassword({\n    email,\n    password,\n  });\n\n  if (error) throw error;\n  return data;\n}\n\nexport async function signOut() {\n  const { error } = await supabase.auth.signOut();\n  if (error) throw error;\n}\n\nexport async function getAuthUser() {\n  const { data, error } = await supabase.auth.getUser();\n  if (error) return null;\n  return data.user;\n}\n\nexport async function getSession() {\n  const { data, error } = await supabase.auth.getSession();\n  if (error) return null;\n  return data.session;\n}\n\nexport function onAuthStateChange(callback: (event: string, session: unknown) => void) {\n  return supabase.auth.onAuthStateChange(callback);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAEO,eAAe,gBAAgB,KAAa,EAAE,QAAgB;IACnE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC;QAC7D;QACA;IACF;IAEA,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,OAAO;IAC7C,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,OAAO;IACnD,IAAI,OAAO,OAAO;IAClB,OAAO,KAAK,IAAI;AAClB;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,UAAU;IACtD,IAAI,OAAO,OAAO;IAClB,OAAO,KAAK,OAAO;AACrB;AAEO,SAAS,kBAAkB,QAAmD;IACnF,OAAO,iIAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC;AACzC"}},
    {"offset": {"line": 97, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/hooks/useAuthGuard.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { getAuthUser } from '@/services/auth';\n\nexport function useAuthGuard() {\n  const [loading, setLoading] = useState(true);\n  const router = useRouter();\n\n  useEffect(() => {\n    let isMounted = true;\n\n    async function check() {\n      try {\n        const user = await getAuthUser();\n        if (!user && isMounted) {\n          router.replace('/login');\n        } else if (isMounted) {\n          setLoading(false);\n        }\n      } catch (err) {\n        console.error('Error checking auth', err);\n        if (isMounted) {\n          router.replace('/login');\n        }\n      }\n    }\n\n    check();\n\n    return () => {\n      isMounted = false;\n    };\n  }, [router]);\n\n  return { loading };\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;AAMO,SAAS;IACd,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,SAAS,IAAA,+IAAS;IAExB,IAAA,kNAAS,EAAC;QACR,IAAI,YAAY;QAEhB,eAAe;YACb,IAAI;gBACF,MAAM,OAAO,MAAM,IAAA,+HAAW;gBAC9B,IAAI,CAAC,QAAQ,WAAW;oBACtB,OAAO,OAAO,CAAC;gBACjB,OAAO,IAAI,WAAW;oBACpB,WAAW;gBACb;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,uBAAuB;gBACrC,IAAI,WAAW;oBACb,OAAO,OAAO,CAAC;gBACjB;YACF;QACF;QAEA;QAEA,OAAO;YACL,YAAY;QACd;IACF,GAAG;QAAC;KAAO;IAEX,OAAO;QAAE;IAAQ;AACnB"}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/services/adminCompetence.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\";\n\nexport type CompetenceGroup = {\n  id: string;\n  name: string;\n  description: string | null;\n  sort_order?: number;\n};\n\nexport type Competence = {\n  id: string;\n  group_id: string | null;\n  code: string | null;\n  name: string;\n  description: string | null;\n  is_safety_critical: boolean;\n  active: boolean;\n};\n\nexport type PositionAdmin = {\n  id: string;\n  name: string;\n  description: string | null;\n  site: string | null;\n  department: string | null;\n  // Note: min_headcount exists in DB but Supabase schema cache doesn't recognize it\n  // min_headcount: number | null;\n};\n\nexport type PositionRequirementAdmin = {\n  id: string;\n  competence_id: string;\n  required_level: number;\n  mandatory: boolean;\n  notes?: string | null;\n};\n\nexport type PositionRequirementWithCompetence = PositionRequirementAdmin & {\n  competence_name: string;\n  competence_code: string | null;\n  group_name: string | null;\n};\n\nexport async function listCompetenceGroups(): Promise<CompetenceGroup[]> {\n  const { data, error } = await supabase\n    .from('competence_groups')\n    .select('id, name, description, sort_order')\n    .order('sort_order', { ascending: true })\n    .order('name', { ascending: true });\n\n  if (error) throw error;\n  return (data ?? []) as CompetenceGroup[];\n}\n\nexport async function createCompetenceGroup(payload: {\n  name: string;\n  description?: string;\n}): Promise<void> {\n  const { error } = await supabase.from('competence_groups').insert({\n    name: payload.name,\n    description: payload.description ?? null,\n  });\n\n  if (error) throw error;\n}\n\nexport async function updateCompetenceGroup(id: string, payload: {\n  name?: string;\n  description?: string | null;\n  sort_order?: number;\n}): Promise<void> {\n  const { error } = await supabase\n    .from('competence_groups')\n    .update(payload)\n    .eq('id', id);\n\n  if (error) throw error;\n}\n\nexport async function deleteCompetenceGroup(id: string): Promise<void> {\n  const { error } = await supabase\n    .from(\"competence_groups\")\n    .delete()\n    .eq(\"id\", id);\n\n  if (error) throw error;\n}\n\nexport async function listCompetences(): Promise<Competence[]> {\n  const { data, error } = await supabase\n    .from('competences')\n    .select(\n      'id, group_id, code, name, description, is_safety_critical, active'\n    )\n    .order('name', { ascending: true });\n\n  if (error) throw error;\n  return (data ?? []) as Competence[];\n}\n\nexport async function getCompetencesByGroup(groupId: string): Promise<Competence[]> {\n  const { data, error } = await supabase\n    .from(\"competences\")\n    .select(\"id, group_id, code, name, description, is_safety_critical, active\")\n    .eq(\"group_id\", groupId)\n    .order(\"name\", { ascending: true });\n\n  if (error) throw error;\n  return data || [];\n}\n\nexport async function createCompetence(payload: {\n  name: string;\n  code?: string;\n  group_id?: string | null;\n  description?: string;\n  is_safety_critical?: boolean;\n}): Promise<void> {\n  const { error } = await supabase.from('competences').insert({\n    name: payload.name,\n    code: payload.code ?? null,\n    group_id: payload.group_id ?? null,\n    description: payload.description ?? null,\n    is_safety_critical: payload.is_safety_critical ?? false,\n    active: true,\n  });\n\n  if (error) throw error;\n}\n\nexport async function updateCompetence(id: string, payload: {\n  name?: string;\n  code?: string | null;\n  group_id?: string | null;\n  description?: string | null;\n  is_safety_critical?: boolean;\n  active?: boolean;\n}): Promise<void> {\n  const { error } = await supabase\n    .from('competences')\n    .update(payload)\n    .eq('id', id);\n\n  if (error) throw error;\n}\n\nexport async function deleteCompetence(id: string): Promise<void> {\n  const { error } = await supabase\n    .from(\"competences\")\n    .delete()\n    .eq(\"id\", id);\n\n  if (error) throw error;\n}\n\nexport async function listPositions(): Promise<PositionAdmin[]> {\n  const { data, error } = await supabase\n    .from('positions')\n    .select('id, name, description, site, department')\n    .order('name', { ascending: true });\n\n  if (error) throw error;\n  return (data ?? []) as PositionAdmin[];\n}\n\nexport async function getPositionById(\n  id: string\n): Promise<PositionAdmin | null> {\n  const { data, error } = await supabase\n    .from('positions')\n    .select('id, name, description, site, department')\n    .eq('id', id)\n    .single();\n\n  if (error) {\n    if ((error as any).code === 'PGRST116') {\n      return null;\n    }\n    throw error;\n  }\n  return data as PositionAdmin;\n}\n\nexport async function createPosition(payload: {\n  name: string;\n  description?: string;\n  site?: string;\n  department?: string;\n}): Promise<void> {\n  const { error } = await supabase.from('positions').insert({\n    name: payload.name,\n    description: payload.description ?? null,\n    site: payload.site ?? null,\n    department: payload.department ?? null,\n  });\n\n  if (error) throw error;\n}\n\nexport async function updatePosition(id: string, payload: {\n  name?: string;\n  description?: string | null;\n  site?: string | null;\n  department?: string | null;\n}): Promise<void> {\n  const { error } = await supabase\n    .from('positions')\n    .update(payload)\n    .eq('id', id);\n\n  if (error) throw error;\n}\n\nexport async function deletePosition(id: string): Promise<void> {\n  const { error } = await supabase\n    .from(\"positions\")\n    .delete()\n    .eq(\"id\", id);\n\n  if (error) throw error;\n}\n\nexport async function listPositionRequirements(\n  positionId: string\n): Promise<PositionRequirementAdmin[]> {\n  const { data, error } = await supabase\n    .from('position_competence_requirements')\n    .select(\n      'id, competence_id, required_level, mandatory, notes'\n    )\n    .eq('position_id', positionId)\n    .order('required_level', { ascending: false });\n\n  if (error) throw error;\n  return (data ?? []) as PositionRequirementAdmin[];\n}\n\nexport async function getPositionRequirements(\n  positionId: string\n): Promise<PositionRequirementWithCompetence[]> {\n  const { data, error } = await supabase\n    .from(\"position_competence_requirements\")\n    .select(`\n      id,\n      competence_id,\n      required_level,\n      mandatory,\n      notes,\n      competences (\n        name,\n        code,\n        competence_groups (\n          name\n        )\n      )\n    `)\n    .eq(\"position_id\", positionId);\n\n  if (error) throw error;\n\n  return (data || []).map((row: any) => ({\n    id: row.id,\n    competence_id: row.competence_id,\n    required_level: row.required_level,\n    mandatory: row.mandatory,\n    notes: row.notes,\n    competence_name: row.competences?.name || \"Unknown\",\n    competence_code: row.competences?.code || null,\n    group_name: row.competences?.competence_groups?.name || null,\n  }));\n}\n\nexport async function createPositionRequirement(payload: {\n  position_id: string;\n  competence_id: string;\n  required_level: number;\n  mandatory: boolean;\n  notes?: string;\n}): Promise<void> {\n  const { error } = await supabase\n    .from('position_competence_requirements')\n    .insert({\n      position_id: payload.position_id,\n      competence_id: payload.competence_id,\n      required_level: payload.required_level,\n      mandatory: payload.mandatory,\n      notes: payload.notes ?? null,\n    });\n\n  if (error) throw error;\n}\n\nexport async function updatePositionRequirement(\n  id: string,\n  payload: {\n    required_level?: number;\n    mandatory?: boolean;\n    notes?: string | null;\n  }\n): Promise<void> {\n  const { error } = await supabase\n    .from('position_competence_requirements')\n    .update(payload)\n    .eq('id', id);\n\n  if (error) throw error;\n}\n\nexport async function deletePositionRequirement(id: string): Promise<void> {\n  const { error } = await supabase\n    .from('position_competence_requirements')\n    .delete()\n    .eq('id', id);\n\n  if (error) throw error;\n}\n\n// Legacy aliases for backward compatibility\nexport const getCompetenceGroups = listCompetenceGroups;\nexport const getCompetences = listCompetences;\nexport const getPositions = listPositions;\nexport const getPosition = getPositionById;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 344, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/admin/positions/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useAuthGuard } from \"@/hooks/useAuthGuard\";\nimport Link from \"next/link\";\nimport {\n  getPositions,\n  createPosition,\n  updatePosition,\n  deletePosition,\n  PositionAdmin,\n} from \"@/services/adminCompetence\";\nimport { Plus, Pencil, Trash2, Settings, X } from \"lucide-react\";\n\ntype EditingPosition = PositionAdmin | null;\n\nexport default function PositionsAdminPage() {\n  const { loading: authLoading } = useAuthGuard();\n  const [positions, setPositions] = useState<PositionAdmin[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  const [showModal, setShowModal] = useState(false);\n  const [editingPosition, setEditingPosition] = useState<EditingPosition>(null);\n  const [form, setForm] = useState({\n    name: \"\",\n    description: \"\",\n    site: \"\",\n    department: \"\",\n  });\n\n  useEffect(() => {\n    if (!authLoading) {\n      loadData();\n    }\n  }, [authLoading]);\n\n  async function loadData() {\n    try {\n      setLoading(true);\n      const data = await getPositions();\n      setPositions(data);\n    } catch (err) {\n      setError(\"Failed to load positions\");\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  function openNewModal() {\n    setEditingPosition(null);\n    setForm({ name: \"\", description: \"\", site: \"\", department: \"\" });\n    setShowModal(true);\n  }\n\n  function openEditModal(pos: PositionAdmin) {\n    setEditingPosition(pos);\n    setForm({\n      name: pos.name,\n      description: pos.description || \"\",\n      site: pos.site || \"\",\n      department: pos.department || \"\",\n    });\n    setShowModal(true);\n  }\n\n  async function handleSave() {\n    try {\n      const payload = {\n        name: form.name,\n        description: form.description || undefined,\n        site: form.site || undefined,\n        department: form.department || undefined,\n      };\n      if (editingPosition) {\n        await updatePosition(editingPosition.id, payload);\n      } else {\n        await createPosition(payload);\n      }\n      setShowModal(false);\n      loadData();\n    } catch (err) {\n      console.error(err);\n      alert(\"Failed to save position\");\n    }\n  }\n\n  async function handleDelete(id: string) {\n    if (!confirm(\"Delete this position? This will also delete all competence requirements for this position.\")) return;\n    try {\n      await deletePosition(id);\n      loadData();\n    } catch (err) {\n      console.error(err);\n      alert(\"Failed to delete position\");\n    }\n  }\n\n  if (authLoading || loading) {\n    return (\n      <main className=\"hr-page\">\n        <p className=\"hr-page__subtitle\">Loading...</p>\n      </main>\n    );\n  }\n\n  if (error) {\n    return (\n      <main className=\"hr-page\">\n        <p className=\"hr-error\">{error}</p>\n      </main>\n    );\n  }\n\n  const groupedBySite = positions.reduce((acc, pos) => {\n    const site = pos.site || \"No Site\";\n    if (!acc[site]) acc[site] = [];\n    acc[site].push(pos);\n    return acc;\n  }, {} as Record<string, PositionAdmin[]>);\n\n  return (\n    <main className=\"hr-page\">\n      <div className=\"hr-page__header\">\n        <div>\n          <h1 className=\"hr-page__title\">Positions Admin</h1>\n          <p className=\"hr-page__subtitle\">Manage positions and their competence requirements</p>\n        </div>\n        <button\n          className=\"hr-button hr-button--primary\"\n          onClick={openNewModal}\n          data-testid=\"button-new-position\"\n        >\n          <Plus size={16} /> New Position\n        </button>\n      </div>\n\n      <nav className=\"hr-breadcrumb\" style={{ marginBottom: 16 }}>\n        <Link href=\"/app/hr/tasks\" className=\"hr-breadcrumb__link\">Dashboard</Link>\n        <span className=\"hr-breadcrumb__separator\">/</span>\n        <span>Positions Admin</span>\n      </nav>\n\n      {positions.length === 0 ? (\n        <div className=\"hr-card\" style={{ padding: 24, textAlign: \"center\" }}>\n          <p className=\"hr-muted\">No positions yet. Create your first position to get started.</p>\n        </div>\n      ) : (\n        Object.entries(groupedBySite).map(([site, sitePositions]) => (\n          <div key={site} className=\"hr-card\" style={{ marginBottom: 16 }}>\n            <h2 className=\"hr-section__title\" style={{ padding: \"12px 16px\", borderBottom: \"1px solid var(--hr-border)\" }}>\n              {site}\n            </h2>\n            <table className=\"hr-table\">\n              <thead>\n                <tr>\n                  <th>Position</th>\n                  <th>Department</th>\n                  <th style={{ width: 150 }}>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                {sitePositions.map((pos) => (\n                  <tr key={pos.id} data-testid={`position-row-${pos.id}`}>\n                    <td>\n                      <div style={{ fontWeight: 500 }}>{pos.name}</div>\n                      {pos.description && (\n                        <div className=\"hr-muted\" style={{ fontSize: 13 }}>{pos.description}</div>\n                      )}\n                    </td>\n                    <td>{pos.department || \"-\"}</td>\n                    <td>\n                      <div style={{ display: \"flex\", gap: 4 }}>\n                        <Link href={`/admin/positions/${pos.id}/requirements`}>\n                          <button\n                            className=\"hr-button hr-button--ghost hr-button--sm\"\n                            data-testid={`button-requirements-${pos.id}`}\n                            title=\"Manage Requirements\"\n                          >\n                            <Settings size={14} />\n                          </button>\n                        </Link>\n                        <button\n                          className=\"hr-button hr-button--ghost hr-button--sm\"\n                          onClick={() => openEditModal(pos)}\n                          data-testid={`button-edit-${pos.id}`}\n                          title=\"Edit Position\"\n                        >\n                          <Pencil size={14} />\n                        </button>\n                        <button\n                          className=\"hr-button hr-button--ghost hr-button--sm\"\n                          onClick={() => handleDelete(pos.id)}\n                          data-testid={`button-delete-${pos.id}`}\n                          title=\"Delete Position\"\n                        >\n                          <Trash2 size={14} />\n                        </button>\n                      </div>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        ))\n      )}\n\n      {showModal && (\n        <div className=\"hr-modal-overlay\" onClick={() => setShowModal(false)}>\n          <div className=\"hr-modal\" onClick={(e) => e.stopPropagation()} data-testid=\"modal-position\">\n            <div className=\"hr-modal__header\">\n              <h2 className=\"hr-modal__title\">{editingPosition ? \"Edit Position\" : \"New Position\"}</h2>\n              <button className=\"hr-button hr-button--ghost hr-button--sm\" onClick={() => setShowModal(false)}>\n                <X size={18} />\n              </button>\n            </div>\n            <div className=\"hr-modal__body\">\n              <div className=\"hr-form-field\">\n                <label className=\"hr-form-label\">Name</label>\n                <input\n                  type=\"text\"\n                  className=\"hr-input\"\n                  value={form.name}\n                  onChange={(e) => setForm({ ...form, name: e.target.value })}\n                  data-testid=\"input-position-name\"\n                />\n              </div>\n              <div className=\"hr-form-field\">\n                <label className=\"hr-form-label\">Description</label>\n                <textarea\n                  className=\"hr-textarea\"\n                  value={form.description}\n                  onChange={(e) => setForm({ ...form, description: e.target.value })}\n                  data-testid=\"input-position-description\"\n                />\n              </div>\n              <div className=\"hr-form-row\">\n                <div className=\"hr-form-field\">\n                  <label className=\"hr-form-label\">Site</label>\n                  <input\n                    type=\"text\"\n                    className=\"hr-input\"\n                    value={form.site}\n                    onChange={(e) => setForm({ ...form, site: e.target.value })}\n                    placeholder=\"e.g., Gothenburg\"\n                    data-testid=\"input-position-site\"\n                  />\n                </div>\n                <div className=\"hr-form-field\">\n                  <label className=\"hr-form-label\">Department</label>\n                  <input\n                    type=\"text\"\n                    className=\"hr-input\"\n                    value={form.department}\n                    onChange={(e) => setForm({ ...form, department: e.target.value })}\n                    placeholder=\"e.g., Production\"\n                    data-testid=\"input-position-department\"\n                  />\n                </div>\n              </div>\n            </div>\n            <div className=\"hr-modal__footer\">\n              <button className=\"hr-button hr-button--secondary\" onClick={() => setShowModal(false)}>\n                Cancel\n              </button>\n              <button className=\"hr-button hr-button--primary\" onClick={handleSave} data-testid=\"button-save-position\">\n                Save\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}