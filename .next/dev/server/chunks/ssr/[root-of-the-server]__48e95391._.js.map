{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/env.ts"],"sourcesContent":["/**\n * Environment variable helper with fail-fast behavior\n * Ensures Supabase credentials are always available\n */\n\nexport interface PublicEnv {\n  supabaseUrl: string;\n  supabaseAnonKey: string;\n}\n\n// Hardcoded fallback values for production builds\nconst FALLBACK_SUPABASE_URL = \"https://bmvawfrnlpdvcmffqrzc.supabase.co\";\nconst FALLBACK_SUPABASE_ANON_KEY = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJtdmF3ZnJubHBkdmNtZmZxcnpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU1MTEwOTAsImV4cCI6MjA4MTA4NzA5MH0.DHLJ4aMn1dORfbNPt1XrJtcdIjYN81YQbJ19Q89A_pM\";\n\n/**\n * Get public environment variables with fail-fast behavior\n * Throws if credentials are not available\n */\nexport function getPublicEnv(): PublicEnv {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || FALLBACK_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || FALLBACK_SUPABASE_ANON_KEY;\n\n  const missing: string[] = [];\n  \n  if (!supabaseUrl || supabaseUrl.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_URL');\n  }\n  if (!supabaseAnonKey || supabaseAnonKey.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_ANON_KEY');\n  }\n\n  if (missing.length > 0) {\n    throw new Error(`Supabase env missing: ${missing.join(', ')}`);\n  }\n\n  return {\n    supabaseUrl,\n    supabaseAnonKey,\n  };\n}\n\n/**\n * Check if public environment is properly configured\n * Returns validation result without throwing\n */\nexport function validatePublicEnv(): { valid: boolean; missing: string[] } {\n  const missing: string[] = [];\n  \n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || FALLBACK_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || FALLBACK_SUPABASE_ANON_KEY;\n\n  if (!supabaseUrl || supabaseUrl.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_URL');\n  }\n  if (!supabaseAnonKey || supabaseAnonKey.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_ANON_KEY');\n  }\n\n  return {\n    valid: missing.length === 0,\n    missing,\n  };\n}\n\n/**\n * Get the service role key (server-side only)\n * Never expose this to client code\n */\nexport function getServiceRoleKey(): string {\n  if (typeof window !== 'undefined') {\n    throw new Error('Service role key must never be accessed on the client');\n  }\n  \n  const key = process.env.SUPABASE_SERVICE_ROLE_KEY;\n  if (!key) {\n    throw new Error('SUPABASE_SERVICE_ROLE_KEY is not configured');\n  }\n  \n  return key;\n}\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AAOD,kDAAkD;AAClD,MAAM,wBAAwB;AAC9B,MAAM,6BAA6B;AAM5B,SAAS;IACd,MAAM,cAAc,gFAAwC;IAC5D,MAAM,kBAAkB,wPAA6C;IAErE,MAAM,UAAoB,EAAE;IAE5B,IAAI,CAAC,eAAe,YAAY,QAAQ,CAAC,gBAAgB;QACvD,QAAQ,IAAI,CAAC;IACf;IACA,IAAI,CAAC,mBAAmB,gBAAgB,QAAQ,CAAC,gBAAgB;QAC/D,QAAQ,IAAI,CAAC;IACf;IAEA,IAAI,QAAQ,MAAM,GAAG,GAAG;QACtB,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAE,QAAQ,IAAI,CAAC,OAAO;IAC/D;IAEA,OAAO;QACL;QACA;IACF;AACF;AAMO,SAAS;IACd,MAAM,UAAoB,EAAE;IAE5B,MAAM,cAAc,gFAAwC;IAC5D,MAAM,kBAAkB,wPAA6C;IAErE,IAAI,CAAC,eAAe,YAAY,QAAQ,CAAC,gBAAgB;QACvD,QAAQ,IAAI,CAAC;IACf;IACA,IAAI,CAAC,mBAAmB,gBAAgB,QAAQ,CAAC,gBAAgB;QAC/D,QAAQ,IAAI,CAAC;IACf;IAEA,OAAO;QACL,OAAO,QAAQ,MAAM,KAAK;QAC1B;IACF;AACF;AAMO,SAAS;IACd;;IAIA,MAAM,MAAM,QAAQ,GAAG,CAAC,yBAAyB;IACjD,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/supabaseClient.ts"],"sourcesContent":["import { createClient, SupabaseClient } from \"@supabase/supabase-js\";\nimport { getPublicEnv, validatePublicEnv } from \"./env\";\n\nlet supabaseInstance: SupabaseClient | null = null;\n\nfunction createSupabaseClient(): SupabaseClient {\n  const env = getPublicEnv();\n  return createClient(env.supabaseUrl, env.supabaseAnonKey, {\n    auth: {\n      persistSession: true,\n      autoRefreshToken: true,\n      detectSessionInUrl: true,\n    },\n  });\n}\n\nexport function getSupabaseClient(): SupabaseClient {\n  if (!supabaseInstance) {\n    supabaseInstance = createSupabaseClient();\n  }\n  return supabaseInstance;\n}\n\nexport const supabase: SupabaseClient = createSupabaseClient();\n\nexport function isSupabaseReady(): boolean {\n  const validation = validatePublicEnv();\n  return validation.valid;\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEA,IAAI,mBAA0C;AAE9C,SAAS;IACP,MAAM,MAAM,IAAA,0HAAY;IACxB,OAAO,IAAA,uLAAY,EAAC,IAAI,WAAW,EAAE,IAAI,eAAe,EAAE;QACxD,MAAM;YACJ,gBAAgB;YAChB,kBAAkB;YAClB,oBAAoB;QACtB;IACF;AACF;AAEO,SAAS;IACd,IAAI,CAAC,kBAAkB;QACrB,mBAAmB;IACrB;IACA,OAAO;AACT;AAEO,MAAM,WAA2B;AAEjC,SAAS;IACd,MAAM,aAAa,IAAA,+HAAiB;IACpC,OAAO,WAAW,KAAK;AACzB"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/app/import-employees/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { supabase } from \"@/lib/supabaseClient\";\nimport Papa from \"papaparse\";\n\ninterface CsvRow {\n  name?: string;\n  employee_number?: string;\n  role?: string;\n  line?: string;\n  team?: string;\n  is_active?: string;\n}\n\ninterface ImportResult {\n  success: boolean;\n  message: string;\n  count?: number;\n}\n\nexport async function importEmployeesFromCsv(formData: FormData): Promise<ImportResult> {\n  const file = formData.get(\"file\") as File | null;\n\n  if (!file) {\n    return { success: false, message: \"No file provided\" };\n  }\n\n  const text = await file.text();\n\n  const parseResult = Papa.parse<CsvRow>(text, {\n    header: true,\n    skipEmptyLines: true,\n    transformHeader: (header) => header.trim().toLowerCase(),\n  });\n\n  if (parseResult.errors.length > 0) {\n    return {\n      success: false,\n      message: `CSV parsing error: ${parseResult.errors[0].message}`,\n    };\n  }\n\n  const rows = parseResult.data;\n\n  if (rows.length === 0) {\n    return { success: false, message: \"CSV file is empty\" };\n  }\n\n  const requiredColumns = [\"name\", \"employee_number\", \"role\", \"line\", \"team\"];\n  const headers = Object.keys(rows[0] || {});\n  const missingColumns = requiredColumns.filter((col) => !headers.includes(col));\n\n  if (missingColumns.length > 0) {\n    return {\n      success: false,\n      message: `Missing required columns: ${missingColumns.join(\", \")}`,\n    };\n  }\n\n  const employeesToUpsert: {\n    name: string;\n    employee_number: string;\n    role: string;\n    line: string;\n    team: string;\n    is_active: boolean;\n  }[] = [];\n\n  for (const row of rows) {\n    if (!row.name || !row.employee_number || !row.role || !row.line || !row.team) {\n      continue;\n    }\n\n    const isActive =\n      row.is_active === undefined ||\n      row.is_active === \"\" ||\n      row.is_active.toLowerCase() === \"true\" ||\n      row.is_active === \"1\";\n\n    employeesToUpsert.push({\n      name: row.name.trim(),\n      employee_number: row.employee_number.trim(),\n      role: row.role.trim(),\n      line: row.line.trim(),\n      team: row.team.trim(),\n      is_active: isActive,\n    });\n  }\n\n  if (employeesToUpsert.length === 0) {\n    return { success: false, message: \"No valid employee rows found in CSV\" };\n  }\n\n  const { error } = await supabase\n    .from(\"employees\")\n    .upsert(employeesToUpsert, { onConflict: \"employee_number\" });\n\n  if (error) {\n    return { success: false, message: `Database error: ${error.message}` };\n  }\n\n  return {\n    success: true,\n    message: `Imported ${employeesToUpsert.length} employees`,\n    count: employeesToUpsert.length,\n  };\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;AAiBO,eAAe,uBAAuB,QAAkB;IAC7D,MAAM,OAAO,SAAS,GAAG,CAAC;IAE1B,IAAI,CAAC,MAAM;QACT,OAAO;YAAE,SAAS;YAAO,SAAS;QAAmB;IACvD;IAEA,MAAM,OAAO,MAAM,KAAK,IAAI;IAE5B,MAAM,cAAc,iJAAI,CAAC,KAAK,CAAS,MAAM;QAC3C,QAAQ;QACR,gBAAgB;QAChB,iBAAiB,CAAC,SAAW,OAAO,IAAI,GAAG,WAAW;IACxD;IAEA,IAAI,YAAY,MAAM,CAAC,MAAM,GAAG,GAAG;QACjC,OAAO;YACL,SAAS;YACT,SAAS,CAAC,mBAAmB,EAAE,YAAY,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE;QAChE;IACF;IAEA,MAAM,OAAO,YAAY,IAAI;IAE7B,IAAI,KAAK,MAAM,KAAK,GAAG;QACrB,OAAO;YAAE,SAAS;YAAO,SAAS;QAAoB;IACxD;IAEA,MAAM,kBAAkB;QAAC;QAAQ;QAAmB;QAAQ;QAAQ;KAAO;IAC3E,MAAM,UAAU,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC;IACxC,MAAM,iBAAiB,gBAAgB,MAAM,CAAC,CAAC,MAAQ,CAAC,QAAQ,QAAQ,CAAC;IAEzE,IAAI,eAAe,MAAM,GAAG,GAAG;QAC7B,OAAO;YACL,SAAS;YACT,SAAS,CAAC,0BAA0B,EAAE,eAAe,IAAI,CAAC,OAAO;QACnE;IACF;IAEA,MAAM,oBAOA,EAAE;IAER,KAAK,MAAM,OAAO,KAAM;QACtB,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,eAAe,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE;YAC5E;QACF;QAEA,MAAM,WACJ,IAAI,SAAS,KAAK,aAClB,IAAI,SAAS,KAAK,MAClB,IAAI,SAAS,CAAC,WAAW,OAAO,UAChC,IAAI,SAAS,KAAK;QAEpB,kBAAkB,IAAI,CAAC;YACrB,MAAM,IAAI,IAAI,CAAC,IAAI;YACnB,iBAAiB,IAAI,eAAe,CAAC,IAAI;YACzC,MAAM,IAAI,IAAI,CAAC,IAAI;YACnB,MAAM,IAAI,IAAI,CAAC,IAAI;YACnB,MAAM,IAAI,IAAI,CAAC,IAAI;YACnB,WAAW;QACb;IACF;IAEA,IAAI,kBAAkB,MAAM,KAAK,GAAG;QAClC,OAAO;YAAE,SAAS;YAAO,SAAS;QAAsC;IAC1E;IAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAC7B,IAAI,CAAC,aACL,MAAM,CAAC,mBAAmB;QAAE,YAAY;IAAkB;IAE7D,IAAI,OAAO;QACT,OAAO;YAAE,SAAS;YAAO,SAAS,CAAC,gBAAgB,EAAE,MAAM,OAAO,EAAE;QAAC;IACvE;IAEA,OAAO;QACL,SAAS;QACT,SAAS,CAAC,SAAS,EAAE,kBAAkB,MAAM,CAAC,UAAU,CAAC;QACzD,OAAO,kBAAkB,MAAM;IACjC;AACF;;;IAtFsB;;AAAA,+OAAA"}},
    {"offset": {"line": 206, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/.next-internal/server/app/app/import-employees/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {importEmployeesFromCsv as '40283ceac9500e8f49cee10418d6ad6684fbd18e4b'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}