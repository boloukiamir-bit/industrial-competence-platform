{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/components/OrgGuard.tsx"],"sourcesContent":["'use client';\n\nimport { ReactNode, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useOrg } from '@/hooks/useOrg';\n\ninterface OrgGuardProps {\n  children: ReactNode;\n  requireAdmin?: boolean;\n}\n\nexport function OrgGuard({ children, requireAdmin = false }: OrgGuardProps) {\n  const { currentOrg, isLoading, memberships, isAdmin } = useOrg();\n  const router = useRouter();\n\n  useEffect(() => {\n    if (isLoading) return;\n\n    // If no org selected and user has memberships, redirect to org select\n    if (!currentOrg && memberships.length > 0) {\n      router.replace('/app/org/select');\n      return;\n    }\n\n    // If no memberships at all, user needs to create or join an org\n    if (!currentOrg && memberships.length === 0) {\n      router.replace('/app/org/select');\n      return;\n    }\n\n    // If admin required but user is not admin\n    if (requireAdmin && !isAdmin) {\n      router.replace('/app');\n      return;\n    }\n  }, [currentOrg, isLoading, memberships, isAdmin, requireAdmin, router]);\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\n      </div>\n    );\n  }\n\n  if (!currentOrg) {\n    return null;\n  }\n\n  if (requireAdmin && !isAdmin) {\n    return null;\n  }\n\n  return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAWO,SAAS,SAAS,EAAE,QAAQ,EAAE,eAAe,KAAK,EAAiB;IACxE,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,WAAW,EAAE,OAAO,EAAE,GAAG,IAAA,yHAAM;IAC9D,MAAM,SAAS,IAAA,+IAAS;IAExB,IAAA,kNAAS,EAAC;QACR,IAAI,WAAW;QAEf,sEAAsE;QACtE,IAAI,CAAC,cAAc,YAAY,MAAM,GAAG,GAAG;YACzC,OAAO,OAAO,CAAC;YACf;QACF;QAEA,gEAAgE;QAChE,IAAI,CAAC,cAAc,YAAY,MAAM,KAAK,GAAG;YAC3C,OAAO,OAAO,CAAC;YACf;QACF;QAEA,0CAA0C;QAC1C,IAAI,gBAAgB,CAAC,SAAS;YAC5B,OAAO,OAAO,CAAC;YACf;QACF;IACF,GAAG;QAAC;QAAY;QAAW;QAAa;QAAS;QAAc;KAAO;IAEtE,IAAI,WAAW;QACb,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BAAsC;;;;;;;;;;;IAG3D;IAEA,IAAI,CAAC,YAAY;QACf,OAAO;IACT;IAEA,IAAI,gBAAgB,CAAC,SAAS;QAC5B,OAAO;IACT;IAEA,qBAAO;kBAAG;;AACZ"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/components/ui/button.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { cn } from \"@/lib/utils\";\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive: \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline: \"border [border-color:var(--button-outline)] shadow-xs active:shadow-none\",\n        secondary: \"border bg-secondary text-secondary-foreground border-secondary-border\",\n        ghost: \"border border-transparent\",\n      },\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n);\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean;\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\";\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nButton.displayName = \"Button\";\n\nexport { Button, buttonVariants };\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOA,MAAM,iBAAiB,IAAA,uKAAG,EACxB,sTACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aAAa;YACb,SAAS;YACT,WAAW;YACX,OAAO;QACT;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,mNAAgB,CAC7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,wKAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,IAAA,kHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/components/DataState.tsx"],"sourcesContent":["'use client';\n\nimport { ReactNode } from 'react';\nimport { Loader2, AlertCircle, RefreshCw, Bug, FileQuestion } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport Link from 'next/link';\n\nexport type DataStateStatus = 'loading' | 'error' | 'empty' | 'ready';\n\ninterface DataStateProps {\n  status: DataStateStatus;\n  children?: ReactNode;\n  \n  error?: {\n    message: string;\n    code?: string;\n    hint?: string;\n  } | null;\n  onRetry?: () => void;\n  \n  emptyTitle?: string;\n  emptyMessage?: string;\n  emptyCta?: {\n    label: string;\n    href?: string;\n    onClick?: () => void;\n  };\n  emptyIcon?: ReactNode;\n  \n  loadingMessage?: string;\n  \n  minHeight?: string;\n}\n\nexport function DataState({\n  status,\n  children,\n  error,\n  onRetry,\n  emptyTitle = 'No data yet',\n  emptyMessage = 'Get started by adding your first item.',\n  emptyCta,\n  emptyIcon,\n  loadingMessage = 'Loading...',\n  minHeight = '400px',\n}: DataStateProps) {\n  if (status === 'ready' && children) {\n    return <>{children}</>;\n  }\n\n  if (status === 'loading') {\n    return (\n      <div className=\"flex flex-col items-center justify-center gap-3\" style={{ minHeight }} data-testid=\"state-loading\">\n        <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n        <p className=\"text-sm text-muted-foreground\">{loadingMessage}</p>\n      </div>\n    );\n  }\n\n  if (status === 'error') {\n    return (\n      <div className=\"flex flex-col items-center justify-center gap-4 p-6\" style={{ minHeight }} data-testid=\"state-error\">\n        <div className=\"p-3 rounded-full bg-destructive/10\">\n          <AlertCircle className=\"w-8 h-8 text-destructive\" />\n        </div>\n        <div className=\"text-center max-w-md\">\n          <h3 className=\"font-medium text-foreground mb-1\">Something went wrong</h3>\n          <p className=\"text-sm text-muted-foreground mb-2\">\n            {error?.message || 'Failed to load data'}\n          </p>\n          {error?.code && (\n            <p className=\"text-xs text-muted-foreground font-mono bg-muted px-2 py-1 rounded inline-block\">\n              Code: {error.code}\n            </p>\n          )}\n          {error?.hint && (\n            <p className=\"text-xs text-muted-foreground mt-2\">\n              Hint: {error.hint}\n            </p>\n          )}\n        </div>\n        <div className=\"flex items-center gap-2\">\n          {onRetry && (\n            <Button variant=\"outline\" onClick={onRetry} data-testid=\"button-retry\">\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Retry\n            </Button>\n          )}\n          <Button variant=\"ghost\" asChild data-testid=\"button-open-debug\">\n            <Link href=\"/app/debug\">\n              <Bug className=\"w-4 h-4 mr-2\" />\n              Open Debug\n            </Link>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  if (status === 'empty') {\n    return (\n      <div className=\"flex flex-col items-center justify-center gap-4 p-6\" style={{ minHeight }} data-testid=\"state-empty\">\n        <div className=\"p-3 rounded-full bg-muted\">\n          {emptyIcon || <FileQuestion className=\"w-8 h-8 text-muted-foreground\" />}\n        </div>\n        <div className=\"text-center max-w-md\">\n          <h3 className=\"font-medium text-foreground mb-1\">{emptyTitle}</h3>\n          <p className=\"text-sm text-muted-foreground\">{emptyMessage}</p>\n        </div>\n        {emptyCta && (\n          emptyCta.href ? (\n            <Button asChild data-testid=\"button-empty-cta\">\n              <Link href={emptyCta.href}>{emptyCta.label}</Link>\n            </Button>\n          ) : (\n            <Button onClick={emptyCta.onClick} data-testid=\"button-empty-cta\">\n              {emptyCta.label}\n            </Button>\n          )\n        )}\n      </div>\n    );\n  }\n\n  return null;\n}\n\nexport function useDataState<T>(\n  data: T | null | undefined,\n  isLoading: boolean,\n  error: { message: string; code?: string; hint?: string } | null\n): DataStateStatus {\n  if (isLoading) return 'loading';\n  if (error) return 'error';\n  if (!data || (Array.isArray(data) && data.length === 0)) return 'empty';\n  return 'ready';\n}\n"],"names":[],"mappings":";;;;;;;AAGA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AALA;;;;;AAkCO,SAAS,UAAU,EACxB,MAAM,EACN,QAAQ,EACR,KAAK,EACL,OAAO,EACP,aAAa,aAAa,EAC1B,eAAe,wCAAwC,EACvD,QAAQ,EACR,SAAS,EACT,iBAAiB,YAAY,EAC7B,YAAY,OAAO,EACJ;IACf,IAAI,WAAW,WAAW,UAAU;QAClC,qBAAO;sBAAG;;IACZ;IAEA,IAAI,WAAW,WAAW;QACxB,qBACE,8OAAC;YAAI,WAAU;YAAkD,OAAO;gBAAE;YAAU;YAAG,eAAY;;8BACjG,8OAAC,4NAAO;oBAAC,WAAU;;;;;;8BACnB,8OAAC;oBAAE,WAAU;8BAAiC;;;;;;;;;;;;IAGpD;IAEA,IAAI,WAAW,SAAS;QACtB,qBACE,8OAAC;YAAI,WAAU;YAAsD,OAAO;gBAAE;YAAU;YAAG,eAAY;;8BACrG,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC,mOAAW;wBAAC,WAAU;;;;;;;;;;;8BAEzB,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAmC;;;;;;sCACjD,8OAAC;4BAAE,WAAU;sCACV,OAAO,WAAW;;;;;;wBAEpB,OAAO,sBACN,8OAAC;4BAAE,WAAU;;gCAAkF;gCACtF,MAAM,IAAI;;;;;;;wBAGpB,OAAO,sBACN,8OAAC;4BAAE,WAAU;;gCAAqC;gCACzC,MAAM,IAAI;;;;;;;;;;;;;8BAIvB,8OAAC;oBAAI,WAAU;;wBACZ,yBACC,8OAAC,qIAAM;4BAAC,SAAQ;4BAAU,SAAS;4BAAS,eAAY;;8CACtD,8OAAC,6NAAS;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;sCAI1C,8OAAC,qIAAM;4BAAC,SAAQ;4BAAQ,OAAO;4BAAC,eAAY;sCAC1C,cAAA,8OAAC,uKAAI;gCAAC,MAAK;;kDACT,8OAAC,uMAAG;wCAAC,WAAU;;;;;;oCAAiB;;;;;;;;;;;;;;;;;;;;;;;;IAO5C;IAEA,IAAI,WAAW,SAAS;QACtB,qBACE,8OAAC;YAAI,WAAU;YAAsD,OAAO;gBAAE;YAAU;YAAG,eAAY;;8BACrG,8OAAC;oBAAI,WAAU;8BACZ,2BAAa,8OAAC,sOAAY;wBAAC,WAAU;;;;;;;;;;;8BAExC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAoC;;;;;;sCAClD,8OAAC;4BAAE,WAAU;sCAAiC;;;;;;;;;;;;gBAE/C,YAAY,CACX,SAAS,IAAI,iBACX,8OAAC,qIAAM;oBAAC,OAAO;oBAAC,eAAY;8BAC1B,cAAA,8OAAC,uKAAI;wBAAC,MAAM,SAAS,IAAI;kCAAG,SAAS,KAAK;;;;;;;;;;yCAG5C,8OAAC,qIAAM;oBAAC,SAAS,SAAS,OAAO;oBAAE,eAAY;8BAC5C,SAAS,KAAK;;;;;wBAGrB;;;;;;;IAGN;IAEA,OAAO;AACT;AAEO,SAAS,aACd,IAA0B,EAC1B,SAAkB,EAClB,KAA+D;IAE/D,IAAI,WAAW,OAAO;IACtB,IAAI,OAAO,OAAO;IAClB,IAAI,CAAC,QAAS,MAAM,OAAO,CAAC,SAAS,KAAK,MAAM,KAAK,GAAI,OAAO;IAChE,OAAO;AACT"}},
    {"offset": {"line": 426, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/apiClient.ts"],"sourcesContent":["import { logDebugError, logApiCall } from './debugStore';\nimport { supabase } from './supabaseClient';\n\nasync function getAuthHeaders(): Promise<HeadersInit> {\n  const { data: { session } } = await supabase.auth.getSession();\n  const headers: HeadersInit = {\n    'Content-Type': 'application/json',\n  };\n  if (session?.access_token) {\n    headers['Authorization'] = `Bearer ${session.access_token}`;\n  }\n  return headers;\n}\n\nexport async function apiGet<T = unknown>(url: string): Promise<T> {\n  const headers = await getAuthHeaders();\n  \n  const res = await fetch(url, { headers });\n  logApiCall(url, res.status);\n  \n  if (!res.ok) {\n    let errorData: { error?: string; message?: string; code?: string; hint?: string } = {};\n    try {\n      errorData = await res.json();\n    } catch {\n      errorData = { message: res.statusText };\n    }\n    \n    logDebugError({\n      type: 'api',\n      endpoint: url,\n      status: res.status,\n      code: errorData.code,\n      message: errorData.message || errorData.error || `HTTP ${res.status}`,\n      hint: errorData.hint,\n    });\n    \n    throw new Error(errorData.message || errorData.error || `Request failed: ${res.status}`);\n  }\n  \n  return res.json();\n}\n\nexport async function apiPost<T = unknown>(url: string, body: unknown): Promise<T> {\n  const headers = await getAuthHeaders();\n  \n  const res = await fetch(url, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(body),\n  });\n  logApiCall(url, res.status);\n  \n  if (!res.ok) {\n    let errorData: { error?: string; message?: string; code?: string; hint?: string } = {};\n    try {\n      errorData = await res.json();\n    } catch {\n      errorData = { message: res.statusText };\n    }\n    \n    logDebugError({\n      type: 'api',\n      endpoint: url,\n      status: res.status,\n      code: errorData.code,\n      message: errorData.message || errorData.error || `HTTP ${res.status}`,\n      hint: errorData.hint,\n    });\n    \n    throw new Error(errorData.message || errorData.error || `Request failed: ${res.status}`);\n  }\n  \n  return res.json();\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,eAAe;IACb,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,UAAU;IAC5D,MAAM,UAAuB;QAC3B,gBAAgB;IAClB;IACA,IAAI,SAAS,cAAc;QACzB,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,QAAQ,YAAY,EAAE;IAC7D;IACA,OAAO;AACT;AAEO,eAAe,OAAoB,GAAW;IACnD,MAAM,UAAU,MAAM;IAEtB,MAAM,MAAM,MAAM,MAAM,KAAK;QAAE;IAAQ;IACvC,IAAA,+HAAU,EAAC,KAAK,IAAI,MAAM;IAE1B,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,IAAI,YAAgF,CAAC;QACrF,IAAI;YACF,YAAY,MAAM,IAAI,IAAI;QAC5B,EAAE,OAAM;YACN,YAAY;gBAAE,SAAS,IAAI,UAAU;YAAC;QACxC;QAEA,IAAA,kIAAa,EAAC;YACZ,MAAM;YACN,UAAU;YACV,QAAQ,IAAI,MAAM;YAClB,MAAM,UAAU,IAAI;YACpB,SAAS,UAAU,OAAO,IAAI,UAAU,KAAK,IAAI,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;YACrE,MAAM,UAAU,IAAI;QACtB;QAEA,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI,UAAU,KAAK,IAAI,CAAC,gBAAgB,EAAE,IAAI,MAAM,EAAE;IACzF;IAEA,OAAO,IAAI,IAAI;AACjB;AAEO,eAAe,QAAqB,GAAW,EAAE,IAAa;IACnE,MAAM,UAAU,MAAM;IAEtB,MAAM,MAAM,MAAM,MAAM,KAAK;QAC3B,QAAQ;QACR;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAA,+HAAU,EAAC,KAAK,IAAI,MAAM;IAE1B,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,IAAI,YAAgF,CAAC;QACrF,IAAI;YACF,YAAY,MAAM,IAAI,IAAI;QAC5B,EAAE,OAAM;YACN,YAAY;gBAAE,SAAS,IAAI,UAAU;YAAC;QACxC;QAEA,IAAA,kIAAa,EAAC;YACZ,MAAM;YACN,UAAU;YACV,QAAQ,IAAI,MAAM;YAClB,MAAM,UAAU,IAAI;YACpB,SAAS,UAAU,OAAO,IAAI,UAAU,KAAK,IAAI,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;YACrE,MAAM,UAAU,IAAI;QACtB;QAEA,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI,UAAU,KAAK,IAAI,CAAC,gBAAgB,EAAE,IAAI,MAAM,EAAE;IACzF;IAEA,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 506, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/app/admin/users/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useOrg } from '@/hooks/useOrg';\nimport { OrgGuard } from '@/components/OrgGuard';\nimport { supabase } from '@/lib/supabaseClient';\nimport { DataState, useDataState } from '@/components/DataState';\nimport { apiGet, apiPost } from '@/lib/apiClient';\nimport { \n  Users, \n  UserPlus, \n  Shield, \n  UserX,\n  Loader2,\n  Mail,\n  Clock,\n  Check,\n  X\n} from 'lucide-react';\n\ninterface Member {\n  user_id: string;\n  role: 'admin' | 'hr' | 'manager' | 'user';\n  status: 'active' | 'disabled';\n  created_at: string;\n  email?: string | null;\n}\n\ninterface Invite {\n  id: string;\n  email: string;\n  role: string;\n  created_at: string;\n  expires_at: string;\n  accepted_at: string | null;\n}\n\ninterface ApiError {\n  message: string;\n  code?: string;\n  hint?: string;\n}\n\nfunction AdminUsersContent() {\n  const { currentOrg, isAdmin } = useOrg();\n  const [members, setMembers] = useState<Member[]>([]);\n  const [invites, setInvites] = useState<Invite[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<ApiError | null>(null);\n  \n  const [showInvite, setShowInvite] = useState(false);\n  const [inviteEmail, setInviteEmail] = useState('');\n  const [inviteRole, setInviteRole] = useState<'admin' | 'hr' | 'manager' | 'user'>('user');\n  const [inviting, setInviting] = useState(false);\n  const [inviteError, setInviteError] = useState<string | null>(null);\n\n  const [changingRole, setChangingRole] = useState<string | null>(null);\n\n  const fetchData = useCallback(async () => {\n    if (!currentOrg) return;\n    \n    setLoading(true);\n    setError(null);\n\n    try {\n      const data = await apiGet<{ members: Member[]; invites: Invite[] }>(`/api/admin/members?orgId=${currentOrg.id}`);\n      setMembers(data.members || []);\n      setInvites(data.invites || []);\n    } catch (err) {\n      console.error('Fetch error:', err);\n      const apiError = { \n        message: err instanceof Error ? err.message : 'Failed to load members',\n        code: 'NETWORK_ERROR'\n      };\n      setError(apiError);\n    } finally {\n      setLoading(false);\n    }\n  }, [currentOrg]);\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  const handleInvite = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!currentOrg) return;\n\n    setInviting(true);\n    setInviteError(null);\n\n    try {\n      await apiPost('/api/admin/invite', {\n        orgId: currentOrg.id,\n        email: inviteEmail,\n        role: inviteRole,\n      });\n\n      setInviteEmail('');\n      setInviteRole('user');\n      setShowInvite(false);\n      await fetchData();\n    } catch (err) {\n      console.error('Invite error:', err);\n      setInviteError(err instanceof Error ? err.message : 'Failed to send invite');\n    } finally {\n      setInviting(false);\n    }\n  };\n\n  const handleRoleChange = async (userId: string, newRole: 'admin' | 'hr' | 'manager' | 'user') => {\n    if (!currentOrg) return;\n\n    setChangingRole(userId);\n\n    try {\n      await apiPost('/api/admin/membership/role', {\n        orgId: currentOrg.id,\n        userId,\n        role: newRole,\n      });\n      await fetchData();\n    } catch (err) {\n      console.error('Role change error:', err);\n    } finally {\n      setChangingRole(null);\n    }\n  };\n\n  const handleDisable = async (userId: string) => {\n    if (!currentOrg) return;\n    if (!confirm('Are you sure you want to disable this user?')) return;\n\n    try {\n      await apiPost('/api/admin/membership/disable', {\n        orgId: currentOrg.id,\n        userId,\n      });\n      await fetchData();\n    } catch (err) {\n      console.error('Disable error:', err);\n    }\n  };\n\n  const formatDate = (dateStr: string) => {\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n    });\n  };\n\n  const dataStatus = useDataState(members, loading, error);\n\n  return (\n    <div className=\"p-6 max-w-6xl mx-auto space-y-6\">\n      <div className=\"flex items-center justify-between flex-wrap gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-semibold text-foreground\" data-testid=\"text-page-title\">\n            User Management\n          </h1>\n          <p className=\"text-muted-foreground mt-1\">\n            Manage members and invites for {currentOrg?.name}\n          </p>\n        </div>\n        {isAdmin && dataStatus !== 'error' && (\n          <button\n            onClick={() => setShowInvite(!showInvite)}\n            className=\"px-4 py-2 rounded-md bg-primary text-primary-foreground flex items-center gap-2\"\n            data-testid=\"button-invite-user\"\n          >\n            <UserPlus className=\"w-4 h-4\" />\n            Invite User\n          </button>\n        )}\n      </div>\n\n      {showInvite && (\n        <div className=\"p-4 rounded-lg border border-border bg-card\">\n          {inviteError && (\n            <div className=\"mb-4 p-3 rounded-md bg-destructive/10 text-destructive text-sm\">\n              {inviteError}\n            </div>\n          )}\n          <form onSubmit={handleInvite} className=\"flex flex-wrap gap-4 items-end\">\n            <div className=\"flex-1 min-w-[200px]\">\n              <label htmlFor=\"invite-email\" className=\"block text-sm font-medium text-foreground mb-1\">\n                Email Address\n              </label>\n              <input\n                id=\"invite-email\"\n                type=\"email\"\n                value={inviteEmail}\n                onChange={(e) => setInviteEmail(e.target.value)}\n                placeholder=\"user@example.com\"\n                className=\"w-full px-3 py-2 rounded-md border border-input bg-background text-foreground\"\n                required\n                data-testid=\"input-invite-email\"\n              />\n            </div>\n            <div className=\"w-40\">\n              <label htmlFor=\"invite-role\" className=\"block text-sm font-medium text-foreground mb-1\">\n                Role\n              </label>\n              <select\n                id=\"invite-role\"\n                value={inviteRole}\n                onChange={(e) => setInviteRole(e.target.value as typeof inviteRole)}\n                className=\"w-full px-3 py-2 rounded-md border border-input bg-background text-foreground\"\n                data-testid=\"select-invite-role\"\n              >\n                <option value=\"user\">User</option>\n                <option value=\"manager\">Manager</option>\n                <option value=\"hr\">HR</option>\n                <option value=\"admin\">Admin</option>\n              </select>\n            </div>\n            <div className=\"flex gap-2\">\n              <button\n                type=\"button\"\n                onClick={() => setShowInvite(false)}\n                className=\"px-4 py-2 rounded-md border border-border text-foreground\"\n                data-testid=\"button-cancel-invite\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"submit\"\n                disabled={inviting}\n                className=\"px-4 py-2 rounded-md bg-primary text-primary-foreground disabled:opacity-50 flex items-center gap-2\"\n                data-testid=\"button-send-invite\"\n              >\n                {inviting ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Mail className=\"w-4 h-4\" />}\n                Send Invite\n              </button>\n            </div>\n          </form>\n        </div>\n      )}\n\n      <DataState\n        status={dataStatus}\n        error={error}\n        onRetry={fetchData}\n        emptyTitle=\"No members yet\"\n        emptyMessage=\"Invite users to join your organization.\"\n        emptyIcon={<Users className=\"w-8 h-8 text-muted-foreground\" />}\n        emptyCta={{\n          label: 'Invite User',\n          onClick: () => setShowInvite(true),\n        }}\n      >\n        <>\n          {invites.length > 0 && (\n            <div className=\"rounded-lg border border-border bg-card\">\n              <div className=\"p-4 border-b border-border\">\n                <h2 className=\"font-medium text-foreground flex items-center gap-2\">\n                  <Clock className=\"w-4 h-4\" />\n                  Pending Invites ({invites.length})\n                </h2>\n              </div>\n              <div className=\"divide-y divide-border\">\n                {invites.map((invite) => (\n                  <div key={invite.id} className=\"p-4 flex items-center justify-between\" data-testid={`row-invite-${invite.id}`}>\n                    <div>\n                      <div className=\"text-foreground\">{invite.email}</div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        Invited as {invite.role} - Expires {formatDate(invite.expires_at)}\n                      </div>\n                    </div>\n                    <span className=\"px-2 py-1 rounded text-xs bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200\">\n                      Pending\n                    </span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          <div className=\"rounded-lg border border-border bg-card\">\n            <div className=\"p-4 border-b border-border\">\n              <h2 className=\"font-medium text-foreground flex items-center gap-2\">\n                <Users className=\"w-4 h-4\" />\n                Members ({members.filter(m => m.status === 'active').length})\n              </h2>\n            </div>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead>\n                  <tr className=\"border-b border-border bg-muted/50\">\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-muted-foreground\">Email</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-muted-foreground\">Role</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-muted-foreground\">Status</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-muted-foreground\">Joined</th>\n                    <th className=\"px-4 py-3 text-right text-sm font-medium text-muted-foreground\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-border\">\n                  {members.map((member) => (\n                    <tr key={member.user_id} className=\"hover:bg-muted/30\" data-testid={`row-member-${member.user_id}`}>\n                      <td className=\"px-4 py-3 text-foreground\">\n                        {member.email || 'Unknown'}\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        {isAdmin && changingRole !== member.user_id ? (\n                          <select\n                            value={member.role}\n                            onChange={(e) => handleRoleChange(member.user_id, e.target.value as typeof member.role)}\n                            className=\"px-2 py-1 rounded border border-input bg-background text-foreground text-sm\"\n                            data-testid={`select-role-${member.user_id}`}\n                          >\n                            <option value=\"user\">User</option>\n                            <option value=\"manager\">Manager</option>\n                            <option value=\"hr\">HR</option>\n                            <option value=\"admin\">Admin</option>\n                          </select>\n                        ) : changingRole === member.user_id ? (\n                          <Loader2 className=\"w-4 h-4 animate-spin text-muted-foreground\" />\n                        ) : (\n                          <span className=\"capitalize\">{member.role}</span>\n                        )}\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        {member.status === 'active' ? (\n                          <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200\">\n                            <Check className=\"w-3 h-3\" />\n                            Active\n                          </span>\n                        ) : (\n                          <span className=\"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200\">\n                            <X className=\"w-3 h-3\" />\n                            Disabled\n                          </span>\n                        )}\n                      </td>\n                      <td className=\"px-4 py-3 text-muted-foreground text-sm\">\n                        {formatDate(member.created_at)}\n                      </td>\n                      <td className=\"px-4 py-3 text-right\">\n                        {isAdmin && member.status === 'active' && (\n                          <button\n                            onClick={() => handleDisable(member.user_id)}\n                            className=\"p-2 rounded text-muted-foreground hover:text-destructive\"\n                            title=\"Disable user\"\n                            data-testid={`button-disable-${member.user_id}`}\n                          >\n                            <UserX className=\"w-4 h-4\" />\n                          </button>\n                        )}\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </>\n      </DataState>\n    </div>\n  );\n}\n\nexport default function AdminUsersPage() {\n  return (\n    <OrgGuard requireAdmin>\n      <AdminUsersContent />\n    </OrgGuard>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}