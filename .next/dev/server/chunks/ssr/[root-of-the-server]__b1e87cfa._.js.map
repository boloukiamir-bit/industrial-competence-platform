{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/supabaseClient.ts"],"sourcesContent":["import { createClient, SupabaseClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || \"\";\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || \"\";\n\nfunction createSupabaseClient(): SupabaseClient {\n  if (!supabaseUrl || !supabaseAnonKey) {\n    if (typeof window === \"undefined\" && process.env.NODE_ENV === \"production\") {\n      console.warn(\n        \"Supabase environment variables not set. \" +\n        \"Please ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are configured.\"\n      );\n    }\n  }\n  return createClient(supabaseUrl || \"https://placeholder.supabase.co\", supabaseAnonKey || \"placeholder\");\n}\n\nexport const supabase: SupabaseClient = createSupabaseClient();\n\nexport function getSupabaseClient(): SupabaseClient {\n  if (!supabaseUrl || !supabaseAnonKey) {\n    throw new Error(\n      \"Missing Supabase environment variables. \" +\n      \"Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.\"\n    );\n  }\n  return supabase;\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,wPAA6C;AAErE,SAAS;IACP;;IAQA,OAAO,IAAA,uLAAY,EAAC,eAAe,mCAAmC,mBAAmB;AAC3F;AAEO,MAAM,WAA2B;AAEjC,SAAS;IACd;;IAMA,OAAO;AACT"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/app/import-employees/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { supabase } from \"@/lib/supabaseClient\";\nimport Papa from \"papaparse\";\n\ninterface CsvRow {\n  name?: string;\n  employee_number?: string;\n  role?: string;\n  line?: string;\n  team?: string;\n  is_active?: string;\n}\n\ninterface ImportResult {\n  success: boolean;\n  message: string;\n  count?: number;\n}\n\nexport async function importEmployeesFromCsv(formData: FormData): Promise<ImportResult> {\n  const file = formData.get(\"file\") as File | null;\n\n  if (!file) {\n    return { success: false, message: \"No file provided\" };\n  }\n\n  const text = await file.text();\n\n  const parseResult = Papa.parse<CsvRow>(text, {\n    header: true,\n    skipEmptyLines: true,\n    transformHeader: (header) => header.trim().toLowerCase(),\n  });\n\n  if (parseResult.errors.length > 0) {\n    return {\n      success: false,\n      message: `CSV parsing error: ${parseResult.errors[0].message}`,\n    };\n  }\n\n  const rows = parseResult.data;\n\n  if (rows.length === 0) {\n    return { success: false, message: \"CSV file is empty\" };\n  }\n\n  const requiredColumns = [\"name\", \"employee_number\", \"role\", \"line\", \"team\"];\n  const headers = Object.keys(rows[0] || {});\n  const missingColumns = requiredColumns.filter((col) => !headers.includes(col));\n\n  if (missingColumns.length > 0) {\n    return {\n      success: false,\n      message: `Missing required columns: ${missingColumns.join(\", \")}`,\n    };\n  }\n\n  const employeesToUpsert: {\n    name: string;\n    employee_number: string;\n    role: string;\n    line: string;\n    team: string;\n    is_active: boolean;\n  }[] = [];\n\n  for (const row of rows) {\n    if (!row.name || !row.employee_number || !row.role || !row.line || !row.team) {\n      continue;\n    }\n\n    const isActive =\n      row.is_active === undefined ||\n      row.is_active === \"\" ||\n      row.is_active.toLowerCase() === \"true\" ||\n      row.is_active === \"1\";\n\n    employeesToUpsert.push({\n      name: row.name.trim(),\n      employee_number: row.employee_number.trim(),\n      role: row.role.trim(),\n      line: row.line.trim(),\n      team: row.team.trim(),\n      is_active: isActive,\n    });\n  }\n\n  if (employeesToUpsert.length === 0) {\n    return { success: false, message: \"No valid employee rows found in CSV\" };\n  }\n\n  const { error } = await supabase\n    .from(\"employees\")\n    .upsert(employeesToUpsert, { onConflict: \"employee_number\" });\n\n  if (error) {\n    return { success: false, message: `Database error: ${error.message}` };\n  }\n\n  return {\n    success: true,\n    message: `Imported ${employeesToUpsert.length} employees`,\n    count: employeesToUpsert.length,\n  };\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;AAiBO,eAAe,uBAAuB,QAAkB;IAC7D,MAAM,OAAO,SAAS,GAAG,CAAC;IAE1B,IAAI,CAAC,MAAM;QACT,OAAO;YAAE,SAAS;YAAO,SAAS;QAAmB;IACvD;IAEA,MAAM,OAAO,MAAM,KAAK,IAAI;IAE5B,MAAM,cAAc,iJAAI,CAAC,KAAK,CAAS,MAAM;QAC3C,QAAQ;QACR,gBAAgB;QAChB,iBAAiB,CAAC,SAAW,OAAO,IAAI,GAAG,WAAW;IACxD;IAEA,IAAI,YAAY,MAAM,CAAC,MAAM,GAAG,GAAG;QACjC,OAAO;YACL,SAAS;YACT,SAAS,CAAC,mBAAmB,EAAE,YAAY,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE;QAChE;IACF;IAEA,MAAM,OAAO,YAAY,IAAI;IAE7B,IAAI,KAAK,MAAM,KAAK,GAAG;QACrB,OAAO;YAAE,SAAS;YAAO,SAAS;QAAoB;IACxD;IAEA,MAAM,kBAAkB;QAAC;QAAQ;QAAmB;QAAQ;QAAQ;KAAO;IAC3E,MAAM,UAAU,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC;IACxC,MAAM,iBAAiB,gBAAgB,MAAM,CAAC,CAAC,MAAQ,CAAC,QAAQ,QAAQ,CAAC;IAEzE,IAAI,eAAe,MAAM,GAAG,GAAG;QAC7B,OAAO;YACL,SAAS;YACT,SAAS,CAAC,0BAA0B,EAAE,eAAe,IAAI,CAAC,OAAO;QACnE;IACF;IAEA,MAAM,oBAOA,EAAE;IAER,KAAK,MAAM,OAAO,KAAM;QACtB,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,eAAe,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE;YAC5E;QACF;QAEA,MAAM,WACJ,IAAI,SAAS,KAAK,aAClB,IAAI,SAAS,KAAK,MAClB,IAAI,SAAS,CAAC,WAAW,OAAO,UAChC,IAAI,SAAS,KAAK;QAEpB,kBAAkB,IAAI,CAAC;YACrB,MAAM,IAAI,IAAI,CAAC,IAAI;YACnB,iBAAiB,IAAI,eAAe,CAAC,IAAI;YACzC,MAAM,IAAI,IAAI,CAAC,IAAI;YACnB,MAAM,IAAI,IAAI,CAAC,IAAI;YACnB,MAAM,IAAI,IAAI,CAAC,IAAI;YACnB,WAAW;QACb;IACF;IAEA,IAAI,kBAAkB,MAAM,KAAK,GAAG;QAClC,OAAO;YAAE,SAAS;YAAO,SAAS;QAAsC;IAC1E;IAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAC7B,IAAI,CAAC,aACL,MAAM,CAAC,mBAAmB;QAAE,YAAY;IAAkB;IAE7D,IAAI,OAAO;QACT,OAAO;YAAE,SAAS;YAAO,SAAS,CAAC,gBAAgB,EAAE,MAAM,OAAO,EAAE;QAAC;IACvE;IAEA,OAAO;QACL,SAAS;QACT,SAAS,CAAC,SAAS,EAAE,kBAAkB,MAAM,CAAC,UAAU,CAAC;QACzD,OAAO,kBAAkB,MAAM;IACjC;AACF;;;IAtFsB;;AAAA,+OAAA"}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/.next-internal/server/app/app/import-employees/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {importEmployeesFromCsv as '408eb8ff223f8f8a3b3518584cb82f22312c1ca162'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}