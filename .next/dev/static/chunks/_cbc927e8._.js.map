{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/env.ts"],"sourcesContent":["/**\n * Environment variable helper with fail-fast behavior\n * Ensures Supabase credentials are always available\n */\n\nexport interface PublicEnv {\n  supabaseUrl: string;\n  supabaseAnonKey: string;\n}\n\n// Hardcoded fallback values for production builds\nconst FALLBACK_SUPABASE_URL = \"https://bmvawfrnlpdvcmffqrzc.supabase.co\";\nconst FALLBACK_SUPABASE_ANON_KEY = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJtdmF3ZnJubHBkdmNtZmZxcnpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU1MTEwOTAsImV4cCI6MjA4MTA4NzA5MH0.DHLJ4aMn1dORfbNPt1XrJtcdIjYN81YQbJ19Q89A_pM\";\n\n/**\n * Get public environment variables with fail-fast behavior\n * Throws if credentials are not available\n */\nexport function getPublicEnv(): PublicEnv {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || FALLBACK_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || FALLBACK_SUPABASE_ANON_KEY;\n\n  const missing: string[] = [];\n  \n  if (!supabaseUrl || supabaseUrl.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_URL');\n  }\n  if (!supabaseAnonKey || supabaseAnonKey.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_ANON_KEY');\n  }\n\n  if (missing.length > 0) {\n    throw new Error(`Supabase env missing: ${missing.join(', ')}`);\n  }\n\n  return {\n    supabaseUrl,\n    supabaseAnonKey,\n  };\n}\n\n/**\n * Check if public environment is properly configured\n * Returns validation result without throwing\n */\nexport function validatePublicEnv(): { valid: boolean; missing: string[] } {\n  const missing: string[] = [];\n  \n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || FALLBACK_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || FALLBACK_SUPABASE_ANON_KEY;\n\n  if (!supabaseUrl || supabaseUrl.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_URL');\n  }\n  if (!supabaseAnonKey || supabaseAnonKey.includes('placeholder')) {\n    missing.push('NEXT_PUBLIC_SUPABASE_ANON_KEY');\n  }\n\n  return {\n    valid: missing.length === 0,\n    missing,\n  };\n}\n\n/**\n * Get the service role key (server-side only)\n * Never expose this to client code\n */\nexport function getServiceRoleKey(): string {\n  if (typeof window !== 'undefined') {\n    throw new Error('Service role key must never be accessed on the client');\n  }\n  \n  const key = process.env.SUPABASE_SERVICE_ROLE_KEY;\n  if (!key) {\n    throw new Error('SUPABASE_SERVICE_ROLE_KEY is not configured');\n  }\n  \n  return key;\n}\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AAgBqB;AATtB,kDAAkD;AAClD,MAAM,wBAAwB;AAC9B,MAAM,6BAA6B;AAM5B,SAAS;IACd,MAAM,cAAc,gFAAwC;IAC5D,MAAM,kBAAkB,wPAA6C;IAErE,MAAM,UAAoB,EAAE;IAE5B,IAAI,CAAC,eAAe,YAAY,QAAQ,CAAC,gBAAgB;QACvD,QAAQ,IAAI,CAAC;IACf;IACA,IAAI,CAAC,mBAAmB,gBAAgB,QAAQ,CAAC,gBAAgB;QAC/D,QAAQ,IAAI,CAAC;IACf;IAEA,IAAI,QAAQ,MAAM,GAAG,GAAG;QACtB,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAE,QAAQ,IAAI,CAAC,OAAO;IAC/D;IAEA,OAAO;QACL;QACA;IACF;AACF;AAMO,SAAS;IACd,MAAM,UAAoB,EAAE;IAE5B,MAAM,cAAc,gFAAwC;IAC5D,MAAM,kBAAkB,wPAA6C;IAErE,IAAI,CAAC,eAAe,YAAY,QAAQ,CAAC,gBAAgB;QACvD,QAAQ,IAAI,CAAC;IACf;IACA,IAAI,CAAC,mBAAmB,gBAAgB,QAAQ,CAAC,gBAAgB;QAC/D,QAAQ,IAAI,CAAC;IACf;IAEA,OAAO;QACL,OAAO,QAAQ,MAAM,KAAK;QAC1B;IACF;AACF;AAMO,SAAS;IACd,wCAAmC;QACjC,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,MAAM,2KAAO,CAAC,GAAG,CAAC,yBAAyB;IACjD,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT"}},
    {"offset": {"line": 69, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/supabaseClient.ts"],"sourcesContent":["import { createClient, SupabaseClient } from \"@supabase/supabase-js\";\nimport { getPublicEnv, validatePublicEnv } from \"./env\";\n\nlet supabaseInstance: SupabaseClient | null = null;\n\nfunction createSupabaseClient(): SupabaseClient {\n  const env = getPublicEnv();\n  return createClient(env.supabaseUrl, env.supabaseAnonKey, {\n    auth: {\n      persistSession: true,\n      autoRefreshToken: true,\n      detectSessionInUrl: true,\n    },\n  });\n}\n\nexport function getSupabaseClient(): SupabaseClient {\n  if (!supabaseInstance) {\n    supabaseInstance = createSupabaseClient();\n  }\n  return supabaseInstance;\n}\n\nexport const supabase: SupabaseClient = createSupabaseClient();\n\nexport function isSupabaseReady(): boolean {\n  const validation = validatePublicEnv();\n  return validation.valid;\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEA,IAAI,mBAA0C;AAE9C,SAAS;IACP,MAAM,MAAM,IAAA,6HAAY;IACxB,OAAO,IAAA,0LAAY,EAAC,IAAI,WAAW,EAAE,IAAI,eAAe,EAAE;QACxD,MAAM;YACJ,gBAAgB;YAChB,kBAAkB;YAClB,oBAAoB;QACtB;IACF;AACF;AAEO,SAAS;IACd,IAAI,CAAC,kBAAkB;QACrB,mBAAmB;IACrB;IACA,OAAO;AACT;AAEO,MAAM,WAA2B;AAEjC,SAAS;IACd,MAAM,aAAa,IAAA,kIAAiB;IACpC,OAAO,WAAW,KAAK;AACzB"}},
    {"offset": {"line": 110, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/signup/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { supabase, isSupabaseReady } from '@/lib/supabaseClient';\nimport { Loader2 } from 'lucide-react';\nimport Link from 'next/link';\n\nexport default function SignupPage() {\n  const router = useRouter();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n\n  const supabaseConfigured = isSupabaseReady();\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setErrorMsg(null);\n\n    if (!supabaseConfigured) {\n      setErrorMsg('Authentication service is not configured.');\n      return;\n    }\n\n    if (password !== confirmPassword) {\n      setErrorMsg('Passwords do not match.');\n      return;\n    }\n\n    if (password.length < 6) {\n      setErrorMsg('Password must be at least 6 characters.');\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const { data, error } = await supabase.auth.signUp({\n        email,\n        password,\n      });\n\n      if (error) {\n        if (error.message.includes('already registered')) {\n          setErrorMsg('This email is already registered. Please sign in instead.');\n        } else if (error.message.includes('valid email')) {\n          setErrorMsg('Please enter a valid email address.');\n        } else {\n          setErrorMsg(error.message);\n        }\n        setLoading(false);\n        return;\n      }\n\n      if (data.user) {\n        setSuccess(true);\n        setTimeout(() => {\n          router.replace('/app/org/select');\n        }, 1500);\n      }\n    } catch (error: unknown) {\n      console.error('Sign up error:', error);\n      setErrorMsg(error instanceof Error ? error.message : 'Failed to sign up.');\n      setLoading(false);\n    }\n  }\n\n  if (success) {\n    return (\n      <main className=\"hr-page\" style={{ maxWidth: 420, margin: '0 auto', paddingTop: 80 }}>\n        <div className=\"hr-card\" style={{ textAlign: 'center', padding: 32 }}>\n          <div className=\"flex items-center justify-center gap-2 mb-4\">\n            <Loader2 className=\"w-5 h-5 animate-spin text-green-600\" />\n          </div>\n          <h2 style={{ fontSize: 18, fontWeight: 600, marginBottom: 8 }}>Account Created!</h2>\n          <p style={{ fontSize: 14, color: 'var(--color-text-secondary)' }}>\n            Redirecting to organization selection...\n          </p>\n        </div>\n      </main>\n    );\n  }\n\n  return (\n    <main className=\"hr-page\" style={{ maxWidth: 420, margin: '0 auto', paddingTop: 80 }}>\n      <h1 className=\"hr-page__title\">Create Account</h1>\n      <p className=\"hr-page__subtitle\">\n        Sign up for Nadiplan to manage your industrial competencies.\n      </p>\n\n      <form onSubmit={handleSubmit} className=\"hr-card\" style={{ marginTop: 16 }}>\n        <div className=\"hr-form-field\">\n          <label className=\"hr-form-label\">Email</label>\n          <input\n            type=\"email\"\n            className=\"hr-input\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n            autoComplete=\"email\"\n            required\n            data-testid=\"input-email\"\n          />\n        </div>\n\n        <div className=\"hr-form-field\">\n          <label className=\"hr-form-label\">Password</label>\n          <input\n            type=\"password\"\n            className=\"hr-input\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            autoComplete=\"new-password\"\n            required\n            minLength={6}\n            data-testid=\"input-password\"\n          />\n          <p style={{ fontSize: 11, color: 'var(--color-text-tertiary)', marginTop: 4 }}>\n            Minimum 6 characters\n          </p>\n        </div>\n\n        <div className=\"hr-form-field\">\n          <label className=\"hr-form-label\">Confirm Password</label>\n          <input\n            type=\"password\"\n            className=\"hr-input\"\n            value={confirmPassword}\n            onChange={(e) => setConfirmPassword(e.target.value)}\n            autoComplete=\"new-password\"\n            required\n            data-testid=\"input-confirm-password\"\n          />\n        </div>\n\n        {errorMsg && (\n          <p className=\"hr-error\" style={{ marginTop: 8 }} data-testid=\"error-message\">\n            {errorMsg}\n          </p>\n        )}\n\n        <button\n          type=\"submit\"\n          className=\"hr-button hr-button--primary\"\n          disabled={loading}\n          style={{ marginTop: 12, width: '100%' }}\n          data-testid=\"button-signup\"\n        >\n          {loading ? 'Creating account...' : 'Create Account'}\n        </button>\n      </form>\n\n      <p style={{ marginTop: 16, fontSize: 13, color: 'var(--color-text-secondary)', textAlign: 'center' }}>\n        Already have an account?{' '}\n        <Link href=\"/login\" style={{ color: 'var(--color-primary)', textDecoration: 'underline' }} data-testid=\"link-login\">\n          Sign in\n        </Link>\n      </p>\n\n      <p style={{ marginTop: 8, fontSize: 12, color: 'var(--color-text-tertiary)', textAlign: 'center' }}>\n        <Link href=\"/pricing\" style={{ textDecoration: 'underline' }} data-testid=\"link-pricing\">\n          View Pricing\n        </Link>\n      </p>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}