(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78894,e=>{"use strict";let t=(0,e.i(75254).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},87316,e=>{"use strict";let t=(0,e.i(75254).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},30030,e=>{"use strict";var t=e.i(71645),a=e.i(43476);function s(e,s){let r=t.createContext(s),i=e=>{let{children:s,...i}=e,l=t.useMemo(()=>i,Object.values(i));return(0,a.jsx)(r.Provider,{value:l,children:s})};return i.displayName=e+"Provider",[i,function(a){let i=t.useContext(r);if(i)return i;if(void 0!==s)return s;throw Error(`\`${a}\` must be used within \`${e}\``)}]}function r(e,s=[]){let i=[],l=()=>{let a=i.map(e=>t.createContext(e));return function(s){let r=s?.[e]||a;return t.useMemo(()=>({[`__scope${e}`]:{...s,[e]:r}}),[s,r])}};return l.scopeName=e,[function(s,r){let l=t.createContext(r),n=i.length;i=[...i,r];let d=s=>{let{scope:r,children:i,...d}=s,o=r?.[e]?.[n]||l,c=t.useMemo(()=>d,Object.values(d));return(0,a.jsx)(o.Provider,{value:c,children:i})};return d.displayName=s+"Provider",[d,function(a,i){let d=i?.[e]?.[n]||l,o=t.useContext(d);if(o)return o;if(void 0!==r)return r;throw Error(`\`${a}\` must be used within \`${s}\``)}]},function(...e){let a=e[0];if(1===e.length)return a;let s=()=>{let s=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=s.reduce((t,{useScope:a,scopeName:s})=>{let r=a(e)[`__scope${s}`];return{...t,...r}},{});return t.useMemo(()=>({[`__scope${a.scopeName}`]:r}),[r])}};return s.scopeName=a.scopeName,s}(l,...s)]}e.s(["createContext",()=>s,"createContextScope",()=>r])},48425,e=>{"use strict";var t=e.i(71645),a=e.i(74080),s=e.i(91918),r=e.i(43476),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,a)=>{let i=(0,s.createSlot)(`Primitive.${a}`),l=t.forwardRef((e,t)=>{let{asChild:s,...l}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,r.jsx)(s?i:a,{...l,ref:t})});return l.displayName=`Primitive.${a}`,{...e,[a]:l}},{});function l(e,t){e&&a.flushSync(()=>e.dispatchEvent(t))}e.s(["Primitive",()=>i,"dispatchDiscreteCustomEvent",()=>l])},7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},94179,e=>{"use strict";var t=e.i(43476),a=e.i(25913),s=e.i(47163);let r=(0,a.cva)("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:"border [border-color:var(--badge-outline)] shadow-xs"},size:{default:"",sm:"text-[10px] px-2 py-0"}},defaultVariants:{variant:"default",size:"default"}});function i({className:e,variant:a,size:i,...l}){return(0,t.jsx)("div",{className:(0,s.cn)(r({variant:a,size:i}),e),...l})}e.s(["Badge",()=>i])},70065,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(47163);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",e),...a}));r.displayName="Card";let i=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...a}));i.displayName="CardHeader";let l=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));l.displayName="CardTitle";let n=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",e),...a}));n.displayName="CardDescription";let d=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...a}));d.displayName="CardContent",a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>d,"CardDescription",()=>n,"CardHeader",()=>i,"CardTitle",()=>l])},25913,e=>{"use strict";var t=e.i(7670);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=t.clsx;e.s(["cva",0,(e,t)=>r=>{var i;if((null==t?void 0:t.variants)==null)return s(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:l,defaultVariants:n}=t,d=Object.keys(l).map(e=>{let t=null==r?void 0:r[e],s=null==n?void 0:n[e];if(null===t)return null;let i=a(t)||a(s);return l[e][i]}),o=r&&Object.entries(r).reduce((e,t)=>{let[a,s]=t;return void 0===s||(e[a]=s),e},{});return s(e,d,null==t||null==(i=t.compoundVariants)?void 0:i.reduce((e,t)=>{let{class:a,className:s,...r}=t;return Object.entries(r).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...n,...o}[t]):({...n,...o})[t]===a})?[...e,a,s]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}])},91918,20783,e=>{"use strict";var t=e.i(71645);function a(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function s(...e){return t=>{let s=!1,r=e.map(e=>{let r=a(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){let s=r[t];"function"==typeof s?s():a(e[t],null)}}}}function r(...e){return t.useCallback(s(...e),e)}e.s(["composeRefs",()=>s,"useComposedRefs",()=>r],20783);var i=e.i(43476);function l(e){var a;let r,l=(a=e,(r=t.forwardRef((e,a)=>{let{children:r,...i}=e;if(t.isValidElement(r)){var l;let e,n,d=(l=r,(n=(e=Object.getOwnPropertyDescriptor(l.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.ref:(n=(e=Object.getOwnPropertyDescriptor(l,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.props.ref:l.props.ref||l.ref),o=function(e,t){let a={...t};for(let s in t){let r=e[s],i=t[s];/^on[A-Z]/.test(s)?r&&i?a[s]=(...e)=>{i(...e),r(...e)}:r&&(a[s]=r):"style"===s?a[s]={...r,...i}:"className"===s&&(a[s]=[r,i].filter(Boolean).join(" "))}return{...e,...a}}(i,r.props);return r.type!==t.Fragment&&(o.ref=a?s(a,d):d),t.cloneElement(r,o)}return t.Children.count(r)>1?t.Children.only(null):null})).displayName=`${a}.SlotClone`,r),n=t.forwardRef((e,a)=>{let{children:s,...r}=e,n=t.Children.toArray(s),d=n.find(c);if(d){let e=d.props.children,s=n.map(a=>a!==d?a:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,i.jsx)(l,{...r,ref:a,children:t.isValidElement(e)?t.cloneElement(e,void 0,s):null})}return(0,i.jsx)(l,{...r,ref:a,children:s})});return n.displayName=`${e}.Slot`,n}var n=l("Slot"),d=Symbol("radix.slottable");function o(e){let t=({children:e})=>(0,i.jsx)(i.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=d,t}function c(e){return t.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===d}e.s(["Slot",()=>n,"createSlot",()=>l,"createSlottable",()=>o],91918)},67881,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(91918),r=e.i(25913),i=e.i(47163);let l=(0,r.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:"border [border-color:var(--button-outline)] shadow-xs active:shadow-none",secondary:"border bg-secondary text-secondary-foreground border-secondary-border",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),n=a.forwardRef(({className:e,variant:a,size:r,asChild:n=!1,...d},o)=>{let c=n?s.Slot:"button";return(0,t.jsx)(c,{className:(0,i.cn)(l({variant:a,size:r,className:e})),ref:o,...d})});n.displayName="Button",e.s(["Button",()=>n,"buttonVariants",()=>l])},90098,e=>{"use strict";var t=e.i(47167);function a(){return"true"===new URLSearchParams(window.location.search).get("demo")||"true"===t.default.env.NEXT_PUBLIC_DEMO_MODE}e.s(["DEMO_EMPLOYEES",0,[{id:"E1001",employeeNumber:"E1001",name:"Anna Lindberg",firstName:"Anna",lastName:"Lindberg",email:"anna.lindberg@example.com",role:"Operator",line:"Pressline 1",team:"Day Shift",startDate:"2020-03-15",isActive:!0},{id:"E1002",employeeNumber:"E1002",name:"Erik Johansson",firstName:"Erik",lastName:"Johansson",email:"erik.johansson@example.com",role:"Operator",line:"Pressline 1",team:"Day Shift",startDate:"2019-06-01",isActive:!0},{id:"E1003",employeeNumber:"E1003",name:"Maria Svensson",firstName:"Maria",lastName:"Svensson",email:"maria.svensson@example.com",role:"Team Lead",line:"Pressline 1",team:"Day Shift",startDate:"2018-01-10",isActive:!0},{id:"E1004",employeeNumber:"E1004",name:"Karl Andersson",firstName:"Karl",lastName:"Andersson",email:"karl.andersson@example.com",role:"Operator",line:"Pressline 1",team:"Night Shift",startDate:"2021-09-20",isActive:!0},{id:"E1005",employeeNumber:"E1005",name:"Sofia Nilsson",firstName:"Sofia",lastName:"Nilsson",email:"sofia.nilsson@example.com",role:"Operator",line:"Pressline 2",team:"Day Shift",startDate:"2022-02-14",isActive:!0},{id:"E1006",employeeNumber:"E1006",name:"Lars Pettersson",firstName:"Lars",lastName:"Pettersson",email:"lars.pettersson@example.com",role:"Team Lead",line:"Pressline 2",team:"Day Shift",startDate:"2017-05-22",isActive:!0},{id:"E1007",employeeNumber:"E1007",name:"Emma Gustafsson",firstName:"Emma",lastName:"Gustafsson",email:"emma.gustafsson@example.com",role:"Quality Inspector",line:"Quality Control",team:"Day Shift",startDate:"2020-11-03",isActive:!0},{id:"E1008",employeeNumber:"E1008",name:"Oscar Eriksson",firstName:"Oscar",lastName:"Eriksson",email:"oscar.eriksson@example.com",role:"Operator",line:"Assembly",team:"Day Shift",startDate:"2021-04-18",isActive:!0},{id:"E1009",employeeNumber:"E1009",name:"Maja Larsson",firstName:"Maja",lastName:"Larsson",email:"maja.larsson@example.com",role:"Operator",line:"Assembly",team:"Night Shift",startDate:"2019-08-25",isActive:!0},{id:"E1010",employeeNumber:"E1010",name:"Viktor Olsson",firstName:"Viktor",lastName:"Olsson",email:"viktor.olsson@example.com",role:"Logistics Coordinator",line:"Logistics",team:"Day Shift",startDate:"2018-12-01",isActive:!0}],"DEMO_ORG_UNITS",0,[{id:"OU1",name:"Manufacturing Division",code:"MFG",type:"Division",parentId:null,employeeCount:10},{id:"OU2",name:"Pressline Department",code:"PRESS",type:"Department",parentId:"OU1",employeeCount:6},{id:"OU3",name:"Assembly Department",code:"ASSY",type:"Department",parentId:"OU1",employeeCount:2},{id:"OU4",name:"Quality Department",code:"QC",type:"Department",parentId:"OU1",employeeCount:1},{id:"OU5",name:"Logistics Department",code:"LOG",type:"Department",parentId:"OU1",employeeCount:1}],"DEMO_POSITIONS",0,[{id:"P1",name:"Pressline 1 Operator",line:"Pressline 1",minHeadcount:4},{id:"P2",name:"Pressline 2 Operator",line:"Pressline 2",minHeadcount:3},{id:"P3",name:"Assembly Operator",line:"Assembly",minHeadcount:3},{id:"P4",name:"Quality Inspector",line:"Quality Control",minHeadcount:2},{id:"P5",name:"Logistics Coordinator",line:"Logistics",minHeadcount:2}],"DEMO_SKILLS",0,[{id:"SK001",code:"PRESS_A",name:"Pressline A Operation",groupId:"G1",groupName:"Production"},{id:"SK002",code:"PRESS_B",name:"Pressline B Operation",groupId:"G1",groupName:"Production"},{id:"SK003",code:"SAFETY_BASIC",name:"Safety Basic",groupId:"G2",groupName:"Safety"},{id:"SK004",code:"SAFETY_ADV",name:"Safety Advanced",groupId:"G2",groupName:"Safety"},{id:"SK005",code:"TRUCK_A1",name:"Truck A1 License",groupId:"G3",groupName:"Certifications"},{id:"SK006",code:"TRUCK_B1",name:"Truck B1 License",groupId:"G3",groupName:"Certifications"},{id:"SK007",code:"QUALITY_INSP",name:"Quality Inspection",groupId:"G4",groupName:"Quality"},{id:"SK008",code:"FIRST_AID",name:"First Aid Certified",groupId:"G2",groupName:"Safety"}],"isDemoMode",()=>a])},72520,e=>{"use strict";let t=(0,e.i(75254).default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],72520)},95468,e=>{"use strict";let t=(0,e.i(75254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],95468)},87336,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(30030),r=e.i(48425),i="Progress",[l,n]=(0,s.createContextScope)(i),[d,o]=l(i),c=a.forwardRef((e,a)=>{var s,i;let{__scopeProgress:l,value:n=null,max:o,getValueLabel:c=p,...m}=e;(o||0===o)&&!g(o)&&console.error((s=`${o}`,`Invalid prop \`max\` of value \`${s}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let u=g(o)?o:100;null===n||f(n,u)||console.error((i=`${n}`,`Invalid prop \`value\` of value \`${i}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let y=f(n,u)?n:null,j=h(y)?c(y,u):void 0;return(0,t.jsx)(d,{scope:l,value:y,max:u,children:(0,t.jsx)(r.Primitive.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":h(y)?y:void 0,"aria-valuetext":j,role:"progressbar","data-state":x(y,u),"data-value":y??void 0,"data-max":u,...m,ref:a})})});c.displayName=i;var m="ProgressIndicator",u=a.forwardRef((e,a)=>{let{__scopeProgress:s,...i}=e,l=o(m,s);return(0,t.jsx)(r.Primitive.div,{"data-state":x(l.value,l.max),"data-value":l.value??void 0,"data-max":l.max,...i,ref:a})});function p(e,t){return`${Math.round(e/t*100)}%`}function x(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function h(e){return"number"==typeof e}function g(e){return h(e)&&!isNaN(e)&&e>0}function f(e,t){return h(e)&&!isNaN(e)&&e<=t&&e>=0}u.displayName=m;var y=e.i(47163);let j=a.forwardRef(({className:e,value:a,...s},r)=>(0,t.jsx)(c,{ref:r,className:(0,y.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...s,children:(0,t.jsx)(u,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));j.displayName=c.displayName,e.s(["Progress",()=>j],87336)},91741,e=>{"use strict";let t=(0,e.i(75254).default)("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);e.s(["ClipboardList",()=>t],91741)},7913,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(38036),r=e.i(70065),i=e.i(67881),l=e.i(94179),n=e.i(22016),d=e.i(61911),o=e.i(78894),c=e.i(75254);let m=(0,c.default)("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);var u=e.i(40524),p=e.i(72520),x=e.i(7233),h=e.i(53210),g=e.i(18566),f=e.i(87336),y=e.i(95468),j=e.i(34479),v=e.i(90098);function N({className:e}){let s=(0,g.useRouter)(),[n,d]=(0,a.useState)({}),[o,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{try{let e=localStorage.getItem("nadiplan_setup_progress"),t=e?JSON.parse(e):{};(0,v.isDemoMode)()?d({orgUnit:v.DEMO_ORG_UNITS.length>=1,employees:v.DEMO_EMPLOYEES.length>=1,skills:v.DEMO_SKILLS.length>=3,positions:v.DEMO_POSITIONS.length>=1,gaps:t.gaps??!1}):d(t)}catch{d({})}c(!1)},[]);let m=["orgUnit","employees","skills","positions","gaps"],u=m.filter(e=>n[e]).length,x=u===m.length,h=u/m.length*100;return o?(0,t.jsx)(r.Card,{className:e,children:(0,t.jsx)(r.CardContent,{className:"py-6",children:(0,t.jsx)("div",{className:"animate-pulse h-16 bg-gray-200 dark:bg-gray-700 rounded"})})}):x?(0,t.jsx)(r.Card,{className:`border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20 ${e}`,children:(0,t.jsx)(r.CardContent,{className:"py-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(y.CheckCircle2,{className:"h-6 w-6 text-green-600 dark:text-green-400"}),(0,t.jsx)("span",{className:"font-medium text-green-700 dark:text-green-300","data-testid":"text-setup-complete",children:j.COPY.setup.complete})]})})}):(0,t.jsxs)(r.Card,{className:e,"data-testid":"card-setup-progress",children:[(0,t.jsx)(r.CardHeader,{className:"pb-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:j.COPY.setup.title}),(0,t.jsxs)(l.Badge,{variant:"secondary",children:[u," / ",m.length]})]})}),(0,t.jsxs)(r.CardContent,{children:[(0,t.jsx)(f.Progress,{value:h,className:"mb-4"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:j.COPY.setup.description}),(0,t.jsxs)(i.Button,{onClick:()=>s.push("/app/setup"),"data-testid":"button-go-to-setup",children:["Continue Setup",(0,t.jsx)(p.ArrowRight,{className:"h-4 w-4 ml-1"})]})]})]})}function b(){let[e,s]=(0,a.useState)(null),[c,g]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{!async function(){let e=new Date().toISOString().split("T")[0],t=new Date(Date.now()+2592e6).toISOString().split("T")[0],a=new Date(Date.now()+7776e6).toISOString().split("T")[0],[r,i,l,n]=await Promise.all([h.supabase.from("employees").select("id, line",{count:"exact"}).eq("is_active",!0),h.supabase.from("person_events").select("id, due_date, category, employees:employee_id(line)").neq("status","completed"),h.supabase.from("employees").select("id").eq("is_active",!0).eq("employment_type","temporary").not("contract_end_date","is",null).lte("contract_end_date",a),h.supabase.from("hr_workflow_instances").select("id",{count:"exact"}).eq("status","active")]),d=i.data||[],o=0,c=0,m={};for(let a of d){if(!a.due_date)continue;let s=a.due_date<e,r=a.due_date>=e&&a.due_date<=t;s&&o++,r&&c++;let i=a.employees,l=i?.line||"Unassigned";m[l]||(m[l]={total:0,critical:0}),m[l].total++,(s||r)&&m[l].critical++}let u=r.data||[],p={};for(let e of u){let t=e.line||"Unassigned";p[t]=(p[t]||0)+1}let x=Object.entries(m).map(([e,t])=>({unitName:e,riskIndex:p[e]?t.critical/p[e]:0,criticalCount:t.critical})).sort((e,t)=>t.riskIndex-e.riskIndex).slice(0,5);s({totalHeadcount:r.count||0,overdueEvents:o,dueSoonEvents:c,expiringContracts:l.data?.length||0,openWorkflows:n.count||0,riskUnits:x}),g(!1)}()},[]),c)?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-16"})]})})},e))}):e?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(N,{className:"mb-2"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)(r.Card,{"data-testid":"card-headcount",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Active Headcount"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-1",children:e.totalHeadcount})]}),(0,t.jsx)(d.Users,{className:"h-8 w-8 text-blue-500"})]})})}),(0,t.jsx)(r.Card,{"data-testid":"card-compliance",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Compliance Risk"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)("span",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:e.overdueEvents}),(0,t.jsxs)("span",{className:"text-sm text-gray-400",children:["+",e.dueSoonEvents," soon"]})]})]}),(0,t.jsx)(o.AlertTriangle,{className:"h-8 w-8 text-red-500"})]})})}),(0,t.jsx)(r.Card,{"data-testid":"card-contracts",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Contracts Ending"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400 mt-1",children:e.expiringContracts}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Next 90 days"})]}),(0,t.jsx)(m,{className:"h-8 w-8 text-orange-500"})]})})}),(0,t.jsx)(r.Card,{"data-testid":"card-workflows",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Open Workflows"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400 mt-1",children:e.openWorkflows})]}),(0,t.jsx)(u.Workflow,{className:"h-8 w-8 text-purple-500"})]})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{className:"text-base",children:"Quick Actions"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsx)(n.default,{href:"/app/hr/workflows?action=start&template=sick_leave",children:(0,t.jsxs)(i.Button,{variant:"outline",className:"w-full justify-start gap-2",children:[(0,t.jsx)(x.Plus,{className:"h-4 w-4"}),"Sick Leave Follow-up"]})}),(0,t.jsx)(n.default,{href:"/app/hr/workflows?action=start&template=rehab",children:(0,t.jsxs)(i.Button,{variant:"outline",className:"w-full justify-start gap-2",children:[(0,t.jsx)(x.Plus,{className:"h-4 w-4"}),"Rehab Process"]})}),(0,t.jsx)(n.default,{href:"/app/hr/workflows?action=start&template=parental_leave",children:(0,t.jsxs)(i.Button,{variant:"outline",className:"w-full justify-start gap-2",children:[(0,t.jsx)(x.Plus,{className:"h-4 w-4"}),"Parental Leave"]})}),(0,t.jsx)(n.default,{href:"/app/hr/workflows?action=start&template=reboarding",children:(0,t.jsxs)(i.Button,{variant:"outline",className:"w-full justify-start gap-2",children:[(0,t.jsx)(x.Plus,{className:"h-4 w-4"}),"Reboarding"]})})]})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsx)(r.CardTitle,{className:"text-base",children:"Top Risk Units"}),(0,t.jsx)(n.default,{href:"/app/hr/analytics",children:(0,t.jsxs)(i.Button,{variant:"ghost",size:"sm",children:["View All ",(0,t.jsx)(p.ArrowRight,{className:"ml-1 h-4 w-4"})]})})]})}),(0,t.jsx)(r.CardContent,{children:0===e.riskUnits.length?(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No risk data available"}):(0,t.jsx)("div",{className:"space-y-3",children:e.riskUnits.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.unitName}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:[e.criticalCount," events"]}),(0,t.jsxs)(l.Badge,{variant:e.riskIndex>=.5?"destructive":e.riskIndex>=.2?"default":"secondary",children:[(100*e.riskIndex).toFixed(0),"%"]})]})]},e.unitName))})})]})]})]}):null}var C=e.i(91741),w=e.i(87316);function k({user:e}){let[s,o]=(0,a.useState)(null),[c,m]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{!async function(){if(!e.employeeId)return m(!1);let t=new Date().toISOString().split("T")[0],a=new Date(Date.now()+12096e5).toISOString().split("T")[0],[s,r,i]=await Promise.all([h.supabase.from("employees").select("id, name",{count:"exact"}).eq("manager_id",e.employeeId).eq("is_active",!0),h.supabase.from("person_events").select("id, title, due_date, employees:employee_id(name)").eq("owner_manager_id",e.employeeId).neq("status","completed").order("due_date"),h.supabase.from("one_to_one_meetings").select("id, scheduled_at, status, employees:employee_id(name)").eq("manager_id",e.employeeId).in("status",["planned","in_progress"]).gte("scheduled_at",t).lte("scheduled_at",a).order("scheduled_at")]),l=r.data||[],n=l.filter(e=>e.due_date).map(e=>{let a=e.employees;return{id:e.id,title:e.title,employeeName:a?.name||"Unknown",dueDate:e.due_date,isOverdue:e.due_date<t}}).slice(0,5),d=(i.data||[]).map(e=>{let t=e.employees;return{id:e.id,employeeName:t?.name||"Unknown",scheduledAt:e.scheduled_at,status:e.status}}).slice(0,5);o({teamHeadcount:s.count||0,openTasks:l.length,upcomingMeetings:i.data?.length||0,criticalItems:n,meetings:d}),m(!1)}()},[e.employeeId]),c)?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(e=>(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-16"})]})})},e))}):s?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)(r.Card,{"data-testid":"card-team-headcount",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"My Team"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-1",children:s.teamHeadcount})]}),(0,t.jsx)(d.Users,{className:"h-8 w-8 text-blue-500"})]})})}),(0,t.jsx)(r.Card,{"data-testid":"card-open-tasks",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Open Tasks"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400 mt-1",children:s.openTasks})]}),(0,t.jsx)(C.ClipboardList,{className:"h-8 w-8 text-orange-500"})]})})}),(0,t.jsx)(r.Card,{"data-testid":"card-upcoming-meetings",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Upcoming 1:1s"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400 mt-1",children:s.upcomingMeetings}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Next 14 days"})]}),(0,t.jsx)(w.Calendar,{className:"h-8 w-8 text-purple-500"})]})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsx)(r.CardTitle,{className:"text-base",children:"Critical Items"}),(0,t.jsx)(n.default,{href:"/app/manager/risks",children:(0,t.jsxs)(i.Button,{variant:"ghost",size:"sm",children:["View All ",(0,t.jsx)(p.ArrowRight,{className:"ml-1 h-4 w-4"})]})})]})}),(0,t.jsx)(r.CardContent,{children:0===s.criticalItems.length?(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No critical items"}):(0,t.jsx)("div",{className:"space-y-3",children:s.criticalItems.map(e=>(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.employeeName})]}),(0,t.jsx)(l.Badge,{variant:e.isOverdue?"destructive":"default",children:e.isOverdue?"Overdue":e.dueDate})]},e.id))})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)("div",{className:"flex items-center justify-between gap-4",children:(0,t.jsx)(r.CardTitle,{className:"text-base",children:"My 1:1 Meetings"})})}),(0,t.jsx)(r.CardContent,{children:0===s.meetings.length?(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No upcoming meetings"}):(0,t.jsx)("div",{className:"space-y-3",children:s.meetings.map(e=>(0,t.jsx)(n.default,{href:`/app/one-to-ones/${e.id}`,children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4 p-2 rounded-md hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.employeeName}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(e.scheduledAt).toLocaleDateString("sv-SE")})]}),(0,t.jsx)(l.Badge,{variant:"secondary",children:e.status})]})},e.id))})})]})]})]}):(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No manager data available. Please ensure your account is linked to an employee profile."})})})}let S=(0,c.default)("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);var _=e.i(78583);let E=(0,c.default)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);function O({user:e}){let[s,i]=(0,a.useState)(null),[n,d]=(0,a.useState)(!0);if((0,a.useEffect)(()=>{!async function(){if(!e.employeeId)return d(!1);let t=new Date().toISOString().split("T")[0],[a,s,r,l,n]=await Promise.all([h.supabase.from("person_events").select("id",{count:"exact"}).eq("employee_id",e.employeeId).in("category",["training","certificate"]).neq("status","completed").gte("due_date",t),h.supabase.from("one_to_one_meetings").select("id, scheduled_at, manager:manager_id(name)").eq("employee_id",e.employeeId).in("status",["planned","in_progress"]).gte("scheduled_at",t).order("scheduled_at").limit(1),h.supabase.from("person_events").select("id",{count:"exact"}).eq("employee_id",e.employeeId).neq("status","completed"),h.supabase.from("documents").select("id, title, type").eq("employee_id",e.employeeId).order("created_at",{ascending:!1}).limit(3),h.supabase.from("employee_skills").select("level, skills(name)").eq("employee_id",e.employeeId).order("level",{ascending:!1}).limit(5)]),o=s.data?.[0],c=null;if(o){let e=o.manager;c={id:o.id,scheduledAt:o.scheduled_at,managerName:e?.name||"Unknown"}}let m=(n.data||[]).map(e=>{let t=e.skills;return{skillName:t?.name||"Unknown",level:e.level}});i({upcomingTrainings:a.count||0,nextMeeting:c,openTasks:r.count||0,recentDocuments:l.data||[],topSkills:m}),d(!1)}()},[e.employeeId]),n)return(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(e=>(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-16"})]})})},e))});if(!s)return(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No employee data available. Please ensure your account is linked to an employee profile."})})});let o=["None","Basic","Intermediate","Advanced","Expert"];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)(r.Card,{"data-testid":"card-trainings",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Upcoming Trainings"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400 mt-1",children:s.upcomingTrainings})]}),(0,t.jsx)(S,{className:"h-8 w-8 text-blue-500"})]})})}),(0,t.jsx)(r.Card,{"data-testid":"card-next-meeting",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Next 1:1"}),s.nextMeeting?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-lg font-bold text-gray-900 dark:text-white mt-1",children:new Date(s.nextMeeting.scheduledAt).toLocaleDateString("sv-SE")}),(0,t.jsxs)("p",{className:"text-xs text-gray-400",children:["with ",s.nextMeeting.managerName]})]}):(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"None scheduled"})]}),(0,t.jsx)(w.Calendar,{className:"h-8 w-8 text-purple-500"})]})})}),(0,t.jsx)(r.Card,{"data-testid":"card-tasks",children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Open Tasks"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400 mt-1",children:s.openTasks})]}),(0,t.jsx)(C.ClipboardList,{className:"h-8 w-8 text-orange-500"})]})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(_.FileText,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)(r.CardTitle,{className:"text-base",children:"My Documents"})]})}),(0,t.jsx)(r.CardContent,{children:0===s.recentDocuments.length?(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No documents available"}):(0,t.jsx)("div",{className:"space-y-3",children:s.recentDocuments.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsx)("span",{className:"text-sm text-gray-900 dark:text-white truncate",children:e.title}),(0,t.jsx)(l.Badge,{variant:"secondary",children:e.type})]},e.id))})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(E,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)(r.CardTitle,{className:"text-base",children:"My Competencies"})]})}),(0,t.jsx)(r.CardContent,{children:0===s.topSkills.length?(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No competencies recorded"}):(0,t.jsx)("div",{className:"space-y-3",children:s.topSkills.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:e.skillName}),(0,t.jsx)(l.Badge,{variant:"default",children:o[e.level]||`Level ${e.level}`})]},a))})})]})]})]})}function D(){let e,[r,i]=(0,a.useState)(null),[l,n]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{(0,s.getCurrentUser)().then(e=>{i(e),n(!1)})},[]),l)?(0,t.jsx)("div",{className:"p-8",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-48"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,t.jsx)("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded"},e))})]})}):(0,t.jsxs)("div",{className:"p-8","data-testid":"dashboard-page",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(e=new Date().getHours())<12?"Good morning":e<18?"Good afternoon":"Good evening"}),(0,t.jsxs)("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:[(()=>{switch(r?.role){case"HR_ADMIN":return"HR Administrator";case"MANAGER":return"Manager";case"EMPLOYEE":return"Employee";default:return""}})()," Dashboard"]})]}),r?.role==="HR_ADMIN"&&(0,t.jsx)(b,{}),r?.role==="MANAGER"&&(0,t.jsx)(k,{user:r}),r?.role==="EMPLOYEE"&&(0,t.jsx)(O,{user:r}),!r?.role&&(0,t.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"Unable to determine user role. Please contact support."})]})}e.s(["default",()=>D],7913)}]);