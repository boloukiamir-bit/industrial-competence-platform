(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78894,e=>{"use strict";let t=(0,e.i(75254).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},61911,e=>{"use strict";let t=(0,e.i(75254).default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);e.s(["Users",()=>t],61911)},75254,e=>{"use strict";var t=e.i(71645);let r=(...e)=>e.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,t.forwardRef)(({color:e="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:s="",children:l,iconNode:c,...u},d)=>(0,t.createElement)("svg",{ref:d,...n,width:o,height:o,stroke:e,strokeWidth:a?24*Number(i)/Number(o):i,className:r("lucide",s),...u},[...c.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(l)?l:[l]])),i=(e,n)=>{let i=(0,t.forwardRef)(({className:i,...a},s)=>(0,t.createElement)(o,{ref:s,iconNode:n,className:r(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,i),...a}));return i.displayName=`${e}`,i};e.s(["default",()=>i],75254)},90571,e=>{"use strict";var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,r)};function r(e,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)0>t.indexOf(n[o])&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function i(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function a(e,t){return function(r,n){t(r,n,e)}}function s(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var s,l=n.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),p=!1,m=r.length-1;m>=0;m--){var f={};for(var h in n)f[h]="access"===h?{}:n[h];for(var h in n.access)f.access[h]=n.access[h];f.addInitializer=function(e){if(p)throw TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var y=(0,r[m])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw TypeError("Object expected");(s=a(y.get))&&(d.get=s),(s=a(y.set))&&(d.set=s),(s=a(y.init))&&o.unshift(s)}else(s=a(y))&&("field"===l?o.unshift(s):d[c]=s)}u&&Object.defineProperty(u,n.name,d),p=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function c(e){return"symbol"==typeof e?e:"".concat(e)}function u(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})}function m(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var f=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),o=0,t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function x(e,t,r){if(r||2==arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function j(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function a(e,t){o[e]&&(n[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||s(e,t)})},t&&(n[e]=t(n[e])))}function s(e,t){try{var r;(r=o[e](t)).value instanceof w?Promise.resolve(r.value.v).then(l,c):u(i[0][2],r)}catch(e){u(i[0][3],e)}}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function _(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:w(e[n](t)),done:!1}:o?o(t):t}:o}}function N(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){var i,a,s;i=n,a=o,s=(t=e[r](t)).done,Promise.resolve(t.value).then(function(e){i({value:e,done:s})},a)})}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var k=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},C=function(e){return(C=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(e)};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=C(e),n=0;n<r.length;n++)"default"!==r[n]&&f(t,e,r[n]);return k(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function P(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function L(e,t,r,n,o){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!o)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function R(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function T(e,t,r){if(null!=t){var n,o;if("object"!=typeof t&&"function"!=typeof t)throw TypeError("Object expected.");if(r){if(!Symbol.asyncDispose)throw TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(o=n)}if("function"!=typeof n)throw TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var I="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function M(e){function t(t){e.error=e.hasError?new I(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,n=0;return function o(){for(;r=e.stack.pop();)try{if(!r.async&&1===n)return n=0,e.stack.push(r),Promise.resolve().then(o);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(o,function(e){return t(e),o()})}else n|=1}catch(e){t(e)}if(1===n)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function A(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,r,n,o,i){return r?t?".jsx":".js":!n||o&&i?n+o+"."+i.toLowerCase()+"js":e}):e}let D={__extends:r,__assign:n,__rest:o,__decorate:i,__param:a,__esDecorate:s,__runInitializers:l,__propKey:c,__setFunctionName:u,__metadata:d,__awaiter:p,__generator:m,__createBinding:f,__exportStar:h,__values:y,__read:v,__spread:g,__spreadArrays:b,__spreadArray:x,__await:w,__asyncGenerator:j,__asyncDelegator:_,__asyncValues:N,__makeTemplateObject:E,__importStar:S,__importDefault:O,__classPrivateFieldGet:P,__classPrivateFieldSet:L,__classPrivateFieldIn:R,__addDisposableResource:T,__disposeResources:M,__rewriteRelativeImportExtension:A};e.s(["__addDisposableResource",()=>T,"__assign",()=>n,"__asyncDelegator",()=>_,"__asyncGenerator",()=>j,"__asyncValues",()=>N,"__await",()=>w,"__awaiter",()=>p,"__classPrivateFieldGet",()=>P,"__classPrivateFieldIn",()=>R,"__classPrivateFieldSet",()=>L,"__createBinding",()=>f,"__decorate",()=>i,"__disposeResources",()=>M,"__esDecorate",()=>s,"__exportStar",()=>h,"__extends",()=>r,"__generator",()=>m,"__importDefault",()=>O,"__importStar",()=>S,"__makeTemplateObject",()=>E,"__metadata",()=>d,"__param",()=>a,"__propKey",()=>c,"__read",()=>v,"__rest",()=>o,"__rewriteRelativeImportExtension",()=>A,"__runInitializers",()=>l,"__setFunctionName",()=>u,"__spread",()=>g,"__spreadArray",()=>x,"__spreadArrays",()=>b,"__values",()=>y,"default",0,D])},18566,(e,t,r)=>{t.exports=e.r(76562)},65615,e=>{"use strict";var t=e.i(53210);async function r(e,r){let{data:n,error:o}=await t.supabase.auth.signInWithPassword({email:e,password:r});if(o)throw o;return n}async function n(){let{error:e}=await t.supabase.auth.signOut();if(e)throw e}async function o(){let{data:e,error:r}=await t.supabase.auth.getUser();return r?null:e.user}async function i(){let{data:e,error:r}=await t.supabase.auth.getSession();return r?null:e.session}function a(e){return t.supabase.auth.onAuthStateChange(e)}e.s(["getAuthUser",()=>o,"getSession",()=>i,"onAuthStateChange",()=>a,"signInWithEmail",()=>r,"signOut",()=>n])},66685,e=>{"use strict";var t=e.i(71645),r=e.i(18566),n=e.i(65615);function o(){let[e,o]=(0,t.useState)(!0),i=(0,r.useRouter)();return(0,t.useEffect)(()=>{let e=!0;return async function(){try{!await (0,n.getAuthUser)()&&e?i.replace("/login"):e&&o(!1)}catch(t){console.error("Error checking auth",t),e&&i.replace("/login")}}(),()=>{e=!1}},[i]),{loading:e}}e.s(["useAuthGuard",()=>o])},25652,e=>{"use strict";let t=(0,e.i(75254).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);e.s(["TrendingUp",()=>t],25652)},40160,e=>{"use strict";let t=(0,e.i(75254).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);e.s(["Download",()=>t],40160)},43531,e=>{"use strict";let t=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},91918,20783,e=>{"use strict";var t=e.i(71645);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(...e){return t=>{let n=!1,o=e.map(e=>{let o=r(e,t);return n||"function"!=typeof o||(n=!0),o});if(n)return()=>{for(let t=0;t<o.length;t++){let n=o[t];"function"==typeof n?n():r(e[t],null)}}}}function o(...e){return t.useCallback(n(...e),e)}e.s(["composeRefs",()=>n,"useComposedRefs",()=>o],20783);var i=e.i(43476);function a(e){var r;let o,a=(r=e,(o=t.forwardRef((e,r)=>{let{children:o,...i}=e;if(t.isValidElement(o)){var a;let e,s,l=(a=o,(s=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(s=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),c=function(e,t){let r={...t};for(let n in t){let o=e[n],i=t[n];/^on[A-Z]/.test(n)?o&&i?r[n]=(...e)=>{i(...e),o(...e)}:o&&(r[n]=o):"style"===n?r[n]={...o,...i}:"className"===n&&(r[n]=[o,i].filter(Boolean).join(" "))}return{...e,...r}}(i,o.props);return o.type!==t.Fragment&&(c.ref=r?n(r,l):l),t.cloneElement(o,c)}return t.Children.count(o)>1?t.Children.only(null):null})).displayName=`${r}.SlotClone`,o),s=t.forwardRef((e,r)=>{let{children:n,...o}=e,s=t.Children.toArray(n),l=s.find(u);if(l){let e=l.props.children,n=s.map(r=>r!==l?r:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,i.jsx)(a,{...o,ref:r,children:t.isValidElement(e)?t.cloneElement(e,void 0,n):null})}return(0,i.jsx)(a,{...o,ref:r,children:n})});return s.displayName=`${e}.Slot`,s}var s=a("Slot"),l=Symbol("radix.slottable");function c(e){let t=({children:e})=>(0,i.jsx)(i.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=l,t}function u(e){return t.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===l}e.s(["Slot",()=>s,"createSlot",()=>a,"createSlottable",()=>c],91918)},30030,48425,e=>{"use strict";var t=e.i(71645),r=e.i(43476);function n(e,n){let o=t.createContext(n),i=e=>{let{children:n,...i}=e,a=t.useMemo(()=>i,Object.values(i));return(0,r.jsx)(o.Provider,{value:a,children:n})};return i.displayName=e+"Provider",[i,function(r){let i=t.useContext(o);if(i)return i;if(void 0!==n)return n;throw Error(`\`${r}\` must be used within \`${e}\``)}]}function o(e,n=[]){let i=[],a=()=>{let r=i.map(e=>t.createContext(e));return function(n){let o=n?.[e]||r;return t.useMemo(()=>({[`__scope${e}`]:{...n,[e]:o}}),[n,o])}};return a.scopeName=e,[function(n,o){let a=t.createContext(o),s=i.length;i=[...i,o];let l=n=>{let{scope:o,children:i,...l}=n,c=o?.[e]?.[s]||a,u=t.useMemo(()=>l,Object.values(l));return(0,r.jsx)(c.Provider,{value:u,children:i})};return l.displayName=n+"Provider",[l,function(r,i){let l=i?.[e]?.[s]||a,c=t.useContext(l);if(c)return c;if(void 0!==o)return o;throw Error(`\`${r}\` must be used within \`${n}\``)}]},function(...e){let r=e[0];if(1===e.length)return r;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let o=n.reduce((t,{useScope:r,scopeName:n})=>{let o=r(e)[`__scope${n}`];return{...t,...o}},{});return t.useMemo(()=>({[`__scope${r.scopeName}`]:o}),[o])}};return n.scopeName=r.scopeName,n}(a,...n)]}e.s(["createContext",()=>n,"createContextScope",()=>o],30030);var i=e.i(74080),a=e.i(91918),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,n)=>{let o=(0,a.createSlot)(`Primitive.${n}`),i=t.forwardRef((e,t)=>{let{asChild:i,...a}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,r.jsx)(i?o:n,{...a,ref:t})});return i.displayName=`Primitive.${n}`,{...e,[n]:i}},{});function l(e,t){e&&i.flushSync(()=>e.dispatchEvent(t))}e.s(["Primitive",()=>s,"dispatchDiscreteCustomEvent",()=>l],48425)},81140,e=>{"use strict";function t(e,r,{checkForDefaultPrevented:n=!0}={}){return function(t){if(e?.(t),!1===n||!t.defaultPrevented)return r?.(t)}}e.s(["composeEventHandlers",()=>t])},30207,e=>{"use strict";var t=e.i(71645);function r(e){let r=t.useRef(e);return t.useEffect(()=>{r.current=e}),t.useMemo(()=>(...e)=>r.current?.(...e),[])}e.s(["useCallbackRef",()=>r])},34620,e=>{"use strict";var t=e.i(71645),r=globalThis?.document?t.useLayoutEffect:()=>{};e.s(["useLayoutEffect",()=>r])},35804,e=>{"use strict";var t=e.i(71645),r=e.i(34620);function n(e){let[n,o]=t.useState(void 0);return(0,r.useLayoutEffect)(()=>{if(e){o({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,n;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,n=t.blockSize}else r=e.offsetWidth,n=e.offsetHeight;o({width:r,height:n})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}o(void 0)},[e]),n}e.s(["useSize",()=>n])},69340,99682,e=>{"use strict";var t=e.i(71645),r=e.i(30207);function n({prop:e,defaultProp:n,onChange:o=()=>{}}){let[i,a]=function({defaultProp:e,onChange:n}){let o=t.useState(e),[i]=o,a=t.useRef(i),s=(0,r.useCallbackRef)(n);return t.useEffect(()=>{a.current!==i&&(s(i),a.current=i)},[i,a,s]),o}({defaultProp:n,onChange:o}),s=void 0!==e,l=s?e:i,c=(0,r.useCallbackRef)(o);return[l,t.useCallback(t=>{if(s){let r="function"==typeof t?t(e):t;r!==e&&c(r)}else a(t)},[s,e,a,c])]}function o(e){let r=t.useRef({value:e,previous:e});return t.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}e.s(["useControllableState",()=>n],69340),e.s(["usePrevious",()=>o],99682)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},96626,e=>{"use strict";var t=e.i(71645),r=e.i(20783),n=e.i(34620),o=e=>{var o;let a,s,{present:l,children:c}=e,u=function(e){var r,o;let[a,s]=t.useState(),l=t.useRef({}),c=t.useRef(e),u=t.useRef("none"),[d,p]=(r=e?"mounted":"unmounted",o={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((e,t)=>o[e][t]??e,r));return t.useEffect(()=>{let e=i(l.current);u.current="mounted"===d?e:"none"},[d]),(0,n.useLayoutEffect)(()=>{let t=l.current,r=c.current;if(r!==e){let n=u.current,o=i(t);e?p("MOUNT"):"none"===o||t?.display==="none"?p("UNMOUNT"):r&&n!==o?p("ANIMATION_OUT"):p("UNMOUNT"),c.current=e}},[e,p]),(0,n.useLayoutEffect)(()=>{if(a){let e,t=a.ownerDocument.defaultView??window,r=r=>{let n=i(l.current).includes(r.animationName);if(r.target===a&&n&&(p("ANIMATION_END"),!c.current)){let r=a.style.animationFillMode;a.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===a.style.animationFillMode&&(a.style.animationFillMode=r)})}},n=e=>{e.target===a&&(u.current=i(l.current))};return a.addEventListener("animationstart",n),a.addEventListener("animationcancel",r),a.addEventListener("animationend",r),()=>{t.clearTimeout(e),a.removeEventListener("animationstart",n),a.removeEventListener("animationcancel",r),a.removeEventListener("animationend",r)}}p("ANIMATION_END")},[a,p]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:t.useCallback(e=>{e&&(l.current=getComputedStyle(e)),s(e)},[])}}(l),d="function"==typeof c?c({present:u.isPresent}):t.Children.only(c),p=(0,r.useComposedRefs)(u.ref,(o=d,(s=(a=Object.getOwnPropertyDescriptor(o.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?o.ref:(s=(a=Object.getOwnPropertyDescriptor(o,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?o.props.ref:o.props.ref||o.ref));return"function"==typeof c||u.isPresent?t.cloneElement(d,{ref:p}):null};function i(e){return e?.animationName||"none"}o.displayName="Presence",e.s(["Presence",()=>o])},85773,e=>{"use strict";var t=e.i(53210);async function r(){let{data:e,error:r}=await t.supabase.from("positions").select("id, name, site, department").order("name",{ascending:!0});if(r)throw r;return e??[]}async function n(e){let{data:r,error:n}=await t.supabase.from("employees").select("id, name").eq("position_id",e);if(n)throw n;return(r??[]).map(e=>({id:e.id,name:e.name??"Employee"}))}async function o(e,r){var n,o,i;let a=r??new Date().toISOString().slice(0,10),{data:s,error:l}=await t.supabase.from("employees").select("id, name, position_id").eq("id",e).single();if(l||!s)throw console.error(l),l??Error("Employee not found");let c=s.name??"Employee",u=null,d=s.position_id??null;if(d){let{data:e}=await t.supabase.from("positions").select("id, name").eq("id",d).limit(1),r=e?.[0];r&&(u=r.name)}let p=[];if(d){let{data:e,error:r}=await t.supabase.from("position_competence_requirements").select("id, position_id, competence_id, required_level, mandatory").eq("position_id",d);if(r)throw console.error(r),r;p=e??[]}let{data:m,error:f}=await t.supabase.from("employee_competences").select("id, employee_id, competence_id, level, valid_from, valid_to").eq("employee_id",e);if(f)throw console.error(f),f;let h=m??[],y=new Map;for(let e of h)y.set(e.competence_id,e);let v=new Set;p.forEach(e=>v.add(e.competence_id)),h.forEach(e=>v.add(e.competence_id));let g=new Map;if(v.size>0){let{data:e,error:r}=await t.supabase.from("competences").select("id, name, description, code, group_id, is_safety_critical").in("id",Array.from(v));if(r)throw console.error(r),r;let n=e??[],o=new Set;n.forEach(e=>{e.group_id&&o.add(e.group_id)});let i=new Map;if(o.size>0){let{data:e,error:r}=await t.supabase.from("competence_groups").select("id, name").in("id",Array.from(o));r?console.error(r):(e??[]).forEach(e=>{i.set(e.id,e.name)})}n.forEach(e=>{g.set(e.id,{...e,groupName:e.group_id?i.get(e.group_id)??null:null})})}let b=[],x=0,w=0,j=0,_=new Set;for(let e of p){let t=g.get(e.competence_id);if(!t)continue;let r=y.get(e.competence_id)??null,o="N/A",i=null,s=r?r.level:null,l=r?.valid_to??null;e.mandatory?(x+=1,r?(n=l)&&n<a?(o="RISK",i="Utgången giltighet",w+=1,j+=1):s<e.required_level?(s>=e.required_level-1?(o="GAP",i="En nivå under krav"):(o="RISK",i="För låg nivå"),w+=1):o="OK":(o="RISK",i="Saknar kompetens",w+=1)):o=r?"OK":"N/A",b.push({competenceId:t.id,competenceName:t.name,competenceCode:t.code??null,groupName:t.groupName,requiredLevel:e.required_level,mandatory:e.mandatory,employeeLevel:s,validTo:l,status:o,riskReason:i,isSafetyCritical:t.is_safety_critical}),_.add(t.id)}for(let e of h){if(_.has(e.competence_id))continue;let t=g.get(e.competence_id);t&&b.push({competenceId:t.id,competenceName:t.name,competenceCode:t.code??null,groupName:t.groupName,requiredLevel:null,mandatory:!1,employeeLevel:e.level,validTo:e.valid_to,status:(o=e.valid_to)&&o<a?"RISK":"N/A",riskReason:(i=e.valid_to)&&i<a?"Utgången giltighet":null,isSafetyCritical:t.is_safety_critical})}let N=0===x?100:Math.round((x-w)/x*100),E="LOW";return E=0===w?"LOW":w<=2?"MEDIUM":"HIGH",b.sort((e,t)=>{let r=e.groupName??"",n=t.groupName??"";return r!==n?r.localeCompare(n):e.competenceName.localeCompare(t.competenceName)}),{employee:{id:s.id,name:c,positionName:u},summary:{riskLevel:E,gapCount:w,totalRequired:x,coveragePercent:N,expiredCount:j},items:b}}async function i(e){let r=[],i=await t.supabase.from("positions").select("id, name, site, department, min_headcount").gt("min_headcount",0);if(i.error){if("42703"===i.error.code||i.error.message?.includes("min_headcount"))return console.warn("min_headcount column not found, returning empty positions list"),[];throw i.error}r=(i.data??[]).map(e=>({id:e.id,name:e.name,site:e.site??null,department:e.department??null,minHeadcount:e.min_headcount}));let a=[];for(let t of r){let r=await n(t.id);if(0===r.length){a.push({positionId:t.id,positionName:t.name,site:t.site,department:t.department,minHeadcount:t.minHeadcount,availableCount:0,gap:t.minHeadcount,riskLevel:"HIGH"});continue}let i=0;for(let t of r)0===(await o(t.id,e)).summary.gapCount&&(i+=1);let s=Math.max(0,t.minHeadcount-i),l="LOW";l=s>0&&0===i?"HIGH":s>0?"MEDIUM":"LOW",a.push({positionId:t.id,positionName:t.name,site:t.site,department:t.department,minHeadcount:t.minHeadcount,availableCount:i,gap:s,riskLevel:l})}let s={HIGH:0,MEDIUM:1,LOW:2};return a.sort((e,t)=>{let r=s[e.riskLevel]-s[t.riskLevel];return 0!==r?r:e.positionName.localeCompare(t.positionName)}),a}e.s(["getAllPositions",()=>r,"getEmployeeCompetenceProfile",()=>o,"getEmployeesForPosition",()=>n,"getPositionCoverageForDate",()=>i])},53330,e=>{"use strict";var t=e.i(47167),r=e.i(43476),n=e.i(71645),o=e.i(85773),i=e.i(62870),a=e.i(66685),s=e.i(40160),l=e.i(61911),c=e.i(78894),u=e.i(25652);let d=(0,e.i(75254).default)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var p=e.i(81140),m=e.i(20783),f=e.i(30030),h=e.i(26330),y=e.i(10772),v=e.i(53660),g=e.i(74606),b=e.i(96626),x=e.i(48425),w=e.i(91918),j=e.i(69340),_=e.i(59411),[N,E]=(0,f.createContextScope)("Tooltip",[v.createPopperScope]),k=(0,v.createPopperScope)(),C="TooltipProvider",S="tooltip.open",[O,P]=N(C),L=e=>{let{__scopeTooltip:t,delayDuration:o=700,skipDelayDuration:i=300,disableHoverableContent:a=!1,children:s}=e,l=n.useRef(!0),c=n.useRef(!1),u=n.useRef(0);return n.useEffect(()=>{let e=u.current;return()=>window.clearTimeout(e)},[]),(0,r.jsx)(O,{scope:t,isOpenDelayedRef:l,delayDuration:o,onOpen:n.useCallback(()=>{window.clearTimeout(u.current),l.current=!1},[]),onClose:n.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>l.current=!0,i)},[i]),isPointerInTransitRef:c,onPointerInTransitChange:n.useCallback(e=>{c.current=e},[]),disableHoverableContent:a,children:s})};L.displayName=C;var R="Tooltip",[T,I]=N(R),M=e=>{let{__scopeTooltip:t,children:o,open:i,defaultOpen:a=!1,onOpenChange:s,disableHoverableContent:l,delayDuration:c}=e,u=P(R,e.__scopeTooltip),d=k(t),[p,m]=n.useState(null),f=(0,y.useId)(),h=n.useRef(0),g=l??u.disableHoverableContent,b=c??u.delayDuration,x=n.useRef(!1),[w=!1,_]=(0,j.useControllableState)({prop:i,defaultProp:a,onChange:e=>{e?(u.onOpen(),document.dispatchEvent(new CustomEvent(S))):u.onClose(),s?.(e)}}),N=n.useMemo(()=>w?x.current?"delayed-open":"instant-open":"closed",[w]),E=n.useCallback(()=>{window.clearTimeout(h.current),h.current=0,x.current=!1,_(!0)},[_]),C=n.useCallback(()=>{window.clearTimeout(h.current),h.current=0,_(!1)},[_]),O=n.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>{x.current=!0,_(!0),h.current=0},b)},[b,_]);return n.useEffect(()=>()=>{h.current&&(window.clearTimeout(h.current),h.current=0)},[]),(0,r.jsx)(v.Root,{...d,children:(0,r.jsx)(T,{scope:t,contentId:f,open:w,stateAttribute:N,trigger:p,onTriggerChange:m,onTriggerEnter:n.useCallback(()=>{u.isOpenDelayedRef.current?O():E()},[u.isOpenDelayedRef,O,E]),onTriggerLeave:n.useCallback(()=>{g?C():(window.clearTimeout(h.current),h.current=0)},[C,g]),onOpen:E,onClose:C,disableHoverableContent:g,children:o})})};M.displayName=R;var A="TooltipTrigger",D=n.forwardRef((e,t)=>{let{__scopeTooltip:o,...i}=e,a=I(A,o),s=P(A,o),l=k(o),c=n.useRef(null),u=(0,m.useComposedRefs)(t,c,a.onTriggerChange),d=n.useRef(!1),f=n.useRef(!1),h=n.useCallback(()=>d.current=!1,[]);return n.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),(0,r.jsx)(v.Anchor,{asChild:!0,...l,children:(0,r.jsx)(x.Primitive.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...i,ref:u,onPointerMove:(0,p.composeEventHandlers)(e.onPointerMove,e=>{"touch"!==e.pointerType&&(f.current||s.isPointerInTransitRef.current||(a.onTriggerEnter(),f.current=!0))}),onPointerLeave:(0,p.composeEventHandlers)(e.onPointerLeave,()=>{a.onTriggerLeave(),f.current=!1}),onPointerDown:(0,p.composeEventHandlers)(e.onPointerDown,()=>{a.open&&a.onClose(),d.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:(0,p.composeEventHandlers)(e.onFocus,()=>{d.current||a.onOpen()}),onBlur:(0,p.composeEventHandlers)(e.onBlur,a.onClose),onClick:(0,p.composeEventHandlers)(e.onClick,a.onClose)})})});D.displayName=A;var q="TooltipPortal",[U,H]=N(q,{forceMount:void 0}),$=e=>{let{__scopeTooltip:t,forceMount:n,children:o,container:i}=e,a=I(q,t);return(0,r.jsx)(U,{scope:t,forceMount:n,children:(0,r.jsx)(b.Presence,{present:n||a.open,children:(0,r.jsx)(g.Portal,{asChild:!0,container:i,children:o})})})};$.displayName=q;var W="TooltipContent",F=n.forwardRef((e,t)=>{let n=H(W,e.__scopeTooltip),{forceMount:o=n.forceMount,side:i="top",...a}=e,s=I(W,e.__scopeTooltip);return(0,r.jsx)(b.Presence,{present:o||s.open,children:s.disableHoverableContent?(0,r.jsx)(V,{side:i,...a,ref:t}):(0,r.jsx)(G,{side:i,...a,ref:t})})}),G=n.forwardRef((e,t)=>{let o=I(W,e.__scopeTooltip),i=P(W,e.__scopeTooltip),a=n.useRef(null),s=(0,m.useComposedRefs)(t,a),[l,c]=n.useState(null),{trigger:u,onClose:d}=o,p=a.current,{onPointerInTransitChange:f}=i,h=n.useCallback(()=>{c(null),f(!1)},[f]),y=n.useCallback((e,t)=>{let r,n=e.currentTarget,o={x:e.clientX,y:e.clientY},i=function(e,t){let r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,n,o,i)){case i:return"left";case o:return"right";case r:return"top";case n:return"bottom";default:throw Error("unreachable")}}(o,n.getBoundingClientRect());c(((r=[...function(e,t,r=5){let n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r})}return n}(o,i),...function(e){let{top:t,right:r,bottom:n,left:o}=e;return[{x:o,y:t},{x:r,y:t},{x:r,y:n},{x:o,y:n}]}(t.getBoundingClientRect())].slice()).sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:1*!!(e.y>t.y)),function(e){if(e.length<=1)return e.slice();let t=[];for(let r=0;r<e.length;r++){let n=e[r];for(;t.length>=2;){let e=t[t.length-1],r=t[t.length-2];if((e.x-r.x)*(n.y-r.y)>=(e.y-r.y)*(n.x-r.x))t.pop();else break}t.push(n)}t.pop();let r=[];for(let t=e.length-1;t>=0;t--){let n=e[t];for(;r.length>=2;){let e=r[r.length-1],t=r[r.length-2];if((e.x-t.x)*(n.y-t.y)>=(e.y-t.y)*(n.x-t.x))r.pop();else break}r.push(n)}return(r.pop(),1===t.length&&1===r.length&&t[0].x===r[0].x&&t[0].y===r[0].y)?t:t.concat(r)}(r))),f(!0)},[f]);return n.useEffect(()=>()=>h(),[h]),n.useEffect(()=>{if(u&&p){let e=e=>y(e,p),t=e=>y(e,u);return u.addEventListener("pointerleave",e),p.addEventListener("pointerleave",t),()=>{u.removeEventListener("pointerleave",e),p.removeEventListener("pointerleave",t)}}},[u,p,y,h]),n.useEffect(()=>{if(l){let e=e=>{let t=e.target,r={x:e.clientX,y:e.clientY},n=u?.contains(t)||p?.contains(t),o=!function(e,t){let{x:r,y:n}=e,o=!1;for(let e=0,i=t.length-1;e<t.length;i=e++){let a=t[e].x,s=t[e].y,l=t[i].x,c=t[i].y;s>n!=c>n&&r<(l-a)*(n-s)/(c-s)+a&&(o=!o)}return o}(r,l);n?h():o&&(h(),d())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[u,p,l,d,h]),(0,r.jsx)(V,{...e,ref:s})}),[K,z]=N(R,{isInside:!1}),B=(0,w.createSlottable)("TooltipContent"),V=n.forwardRef((e,t)=>{let{__scopeTooltip:o,children:i,"aria-label":a,onEscapeKeyDown:s,onPointerDownOutside:l,...c}=e,u=I(W,o),d=k(o),{onClose:p}=u;return n.useEffect(()=>(document.addEventListener(S,p),()=>document.removeEventListener(S,p)),[p]),n.useEffect(()=>{if(u.trigger){let e=e=>{let t=e.target;t?.contains(u.trigger)&&p()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[u.trigger,p]),(0,r.jsx)(h.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:l,onFocusOutside:e=>e.preventDefault(),onDismiss:p,children:(0,r.jsxs)(v.Content,{"data-state":u.stateAttribute,...d,...c,ref:t,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[(0,r.jsx)(B,{children:i}),(0,r.jsx)(K,{scope:o,isInside:!0,children:(0,r.jsx)(_.Root,{id:u.contentId,role:"tooltip",children:a||i})})]})})});F.displayName=W;var X="TooltipArrow";n.forwardRef((e,t)=>{let{__scopeTooltip:n,...o}=e,i=k(n);return z(X,n).isInside?null:(0,r.jsx)(v.Arrow,{...i,...o,ref:t})}).displayName=X;var J=e.i(47163);let Q=n.forwardRef(({className:e,sideOffset:t=4,...n},o)=>(0,r.jsx)($,{children:(0,r.jsx)(F,{ref:o,sideOffset:t,className:(0,J.cn)("z-50 overflow-hidden rounded-md bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 border border-border",e),...n})}));Q.displayName=F.displayName;let Y="true"===t.default.env.NEXT_PUBLIC_DEMO_MODE,Z=[{id:"c1",label:"Safety Training",requiredLevel:3,groupName:"Safety"},{id:"c2",label:"Machine Operation",requiredLevel:4,groupName:"Operations"},{id:"c3",label:"Quality Control",requiredLevel:3,groupName:"Quality"},{id:"c4",label:"First Aid",requiredLevel:2,groupName:"Safety"},{id:"c5",label:"Forklift Cert",requiredLevel:3,groupName:"Logistics"},{id:"c6",label:"Welding",requiredLevel:4,groupName:"Fabrication"},{id:"c7",label:"CNC Programming",requiredLevel:3,groupName:"Operations"},{id:"c8",label:"Lean Manufacturing",requiredLevel:2,groupName:"Process"}],ee=[{id:"e1",name:"Anna Lindqvist",levels:[3,4,3,2,3,4,3,2]},{id:"e2",name:"Erik Johansson",levels:[3,3,2,2,2,4,3,2]},{id:"e3",name:"Maria Svensson",levels:[2,4,3,1,3,3,2,2]},{id:"e4",name:"Lars Andersson",levels:[3,2,3,2,3,4,1,1]},{id:"e5",name:"Sofia Karlsson",levels:[3,4,2,2,2,4,3,2]},{id:"e6",name:"Johan Eriksson",levels:[1,3,3,2,3,2,3,2]},{id:"e7",name:"Karin Olsson",levels:[3,4,3,2,1,4,3,2]},{id:"e8",name:"Peter Nilsson",levels:[3,4,3,0,3,4,3,1]},{id:"e9",name:"Emma Larsson",levels:[2,3,2,2,2,3,2,2]},{id:"e10",name:"Oscar Pettersson",levels:[3,4,3,2,3,4,3,2]}];function et(){let{loading:e}=(0,a.useAuthGuard)();return e?(0,r.jsx)("main",{className:"hr-page",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"Checking access..."})}):(0,r.jsx)(er,{})}function er(){let[e,t]=(0,n.useState)([]),[a,p]=(0,n.useState)([]),[m,f]=(0,n.useState)([]),[h,y]=(0,n.useState)(!1),[v,g]=(0,n.useState)(null),b=(0,n.useMemo)(()=>{let e=new URLSearchParams(window.location.search);return Y||"true"===e.get("demo")},[]),[x,w]=(0,n.useState)(null),[j,_]=(0,n.useState)(!0);(0,n.useEffect)(()=>{if(b){let{columns:e,rows:r}={columns:Z.map(e=>({competenceId:e.id,label:e.label,groupName:e.groupName,requiredLevel:e.requiredLevel})),rows:ee.map(e=>{var t;let r,n,o=e.levels.map((e,t)=>{let r=Z[t].requiredLevel;return{competenceId:Z[t].id,status:null===e||0===e?"RISK":e>=r?"OK":e>=r-1?"GAP":"RISK",level:e,requiredLevel:r}}),i=(r=(t=o.map(e=>e.status)).filter(e=>"RISK"===e).length,n=t.filter(e=>"GAP"===e).length,r>=2?"HIGH":r>=1||n>=3?"MEDIUM":"LOW");return{employeeId:e.id,employeeName:e.name,riskLevel:i,items:o}})};p(e),f(r),t([{id:"demo",name:"Demo Position",site:null,department:"Demo"}]),w("demo"),_(!1);return}!async function(){try{let e=await (0,o.getAllPositions)();t(e)}catch(e){console.error(e),g("Failed to load positions")}finally{_(!1)}}()},[]),(0,n.useEffect)(()=>{if(!b){if(!x){p([]),f([]);return}e()}async function e(){y(!0),g(null);try{let e=await (0,o.getEmployeesForPosition)(x);if(0===e.length){p([]),f([]),y(!1);return}let t=await Promise.all(e.map(e=>(0,o.getEmployeeCompetenceProfile)(e.id))),r=t[0].items.filter(e=>e.mandatory).map(e=>({competenceId:e.competenceId,label:e.competenceName,groupName:e.groupName,requiredLevel:e.requiredLevel})),n=t.map(e=>{let t=new Map(e.items.map(e=>[e.competenceId,e]));return{employeeId:e.employee.id,employeeName:e.employee.name,riskLevel:e.summary.riskLevel,items:r.map(e=>{let r=t.get(e.competenceId);return{competenceId:e.competenceId,status:r?.status??"N/A",level:r?.employeeLevel??null,requiredLevel:e.requiredLevel}})}});p(r),f(n)}catch(e){console.error(e),g("Failed to load competence matrix")}finally{y(!1)}}},[x]);let N=(0,n.useMemo)(()=>{if(0===m.length)return null;let e=m.filter(e=>"HIGH"===e.riskLevel).length,t=new Map,r=0,n=0;m.forEach(e=>{e.items.forEach((e,o)=>{if(n++,"OK"===e.status&&r++,"GAP"===e.status||"RISK"===e.status){let e=a[o]?.label||"Unknown";t.set(e,(t.get(e)||0)+1)}})});let o=Array.from(t.entries()).sort((e,t)=>t[1]-e[1])[0],i=n>0?Math.round(r/n*100):0;return{atRisk:e,topGapSkill:o?o[0]:"None",topGapCount:o?o[1]:0,avgReadiness:i}},[m,a]),E=e.find(e=>e.id===x);return(0,r.jsx)(L,{children:(0,r.jsxs)("main",{className:"hr-page","data-testid":"competence-matrix-page",children:[v&&(0,r.jsx)("div",{className:"p-3 mb-4 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 text-sm","data-testid":"error-message",children:v}),(0,r.jsx)("header",{className:"hr-page__header",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"hr-page__title","data-testid":"text-page-title",children:"Competence Matrix"}),(0,r.jsx)("p",{className:"hr-page__subtitle",children:"Compare all employees in a position against the required competences."})]})}),(0,r.jsx)("div",{className:"p-4 mb-6 rounded-lg border border-border bg-card",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,r.jsx)("div",{className:"min-w-[280px]",children:j?(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading positions..."}):(0,r.jsxs)(i.Select,{value:x??"",onValueChange:e=>w(e||null),children:[(0,r.jsx)(i.SelectTrigger,{"data-testid":"select-position",children:(0,r.jsx)(i.SelectValue,{placeholder:"Select a position..."})}),(0,r.jsx)(i.SelectContent,{children:e.map(e=>(0,r.jsxs)(i.SelectItem,{value:e.id,"data-testid":`option-position-${e.id}`,children:[e.name,e.department&&` (${e.department})`]},e.id))})]})}),E&&!h&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground","data-testid":"text-employee-count",children:[(0,r.jsx)(l.Users,{className:"w-4 h-4"}),m.length," employee",1!==m.length?"s":""]}),m.length>0&&(0,r.jsxs)("button",{onClick:()=>{if(0===m.length||0===a.length)return;let e=new Blob([[["Employee","Risk Level",...a.map(e=>e.label)],...m.map(e=>{let t=e.items.map(e=>null!==e.level?`${e.level}/${e.requiredLevel}`:"-");return[e.employeeName,e.riskLevel,...t]})].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="competence-matrix.csv",r.click(),URL.revokeObjectURL(t)},className:"ml-auto flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-md border border-border bg-background hover:bg-accent transition-colors","data-testid":"button-export-csv",children:[(0,r.jsx)(s.Download,{className:"w-4 h-4"}),"Export CSV"]})]})}),N&&x&&!h&&m.length>0&&(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6","data-testid":"kpi-grid",children:[(0,r.jsxs)("div",{className:"p-4 rounded-lg border border-border bg-card","data-testid":"kpi-employees",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[(0,r.jsx)(l.Users,{className:"w-4 h-4"}),"Total Employees"]}),(0,r.jsx)("div",{className:"text-2xl font-semibold",children:m.length})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg border border-border bg-card","data-testid":"kpi-at-risk",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[(0,r.jsx)(c.AlertTriangle,{className:"w-4 h-4"}),"At Risk"]}),(0,r.jsx)("div",{className:`text-2xl font-semibold ${N.atRisk>0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:N.atRisk})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg border border-border bg-card","data-testid":"kpi-top-gap",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[(0,r.jsx)(d,{className:"w-4 h-4"}),"Top Gap Skill"]}),(0,r.jsx)("div",{className:"text-lg font-semibold truncate",title:N.topGapSkill,children:N.topGapSkill}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[N.topGapCount," employees"]})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg border border-border bg-card","data-testid":"kpi-readiness",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[(0,r.jsx)(u.TrendingUp,{className:"w-4 h-4"}),"Avg Readiness"]}),(0,r.jsxs)("div",{className:`text-2xl font-semibold ${N.avgReadiness>=80?"text-green-600 dark:text-green-400":N.avgReadiness>=60?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"}`,children:[N.avgReadiness,"%"]})]})]}),!x&&!j&&(0,r.jsx)("div",{className:"p-6 rounded-lg border border-dashed border-border bg-muted/50 text-center",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"Select a position above to view the competence matrix."})}),x&&h&&(0,r.jsx)("div",{className:"p-6 rounded-lg border border-dashed border-border bg-muted/50 text-center",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"Loading competence matrix..."})}),x&&!h&&0===m.length&&(0,r.jsx)("div",{className:"p-6 rounded-lg border border-dashed border-border bg-muted/50 text-center",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"No employees found for this position."})}),x&&!h&&m.length>0&&a.length>0&&(0,r.jsx)("div",{className:"hr-matrix-wrapper","data-testid":"matrix-container",children:(0,r.jsxs)("table",{className:"hr-competence-table","data-testid":"matrix-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{style:{minWidth:160},children:"Employee"}),(0,r.jsx)("th",{style:{minWidth:80},children:"Risk"}),a.map(e=>(0,r.jsx)("th",{style:{minWidth:100},children:(0,r.jsxs)(M,{children:[(0,r.jsx)(D,{asChild:!0,children:(0,r.jsxs)("div",{className:"hr-competence-name cursor-help",children:[(0,r.jsx)("span",{className:"max-w-[100px] overflow-hidden text-ellipsis whitespace-nowrap block",children:e.label.length>12?e.label.slice(0,12)+"...":e.label}),null!==e.requiredLevel&&(0,r.jsxs)("span",{className:"hr-level-chip",children:["L",e.requiredLevel]})]})}),(0,r.jsx)(Q,{side:"top",className:"max-w-xs",children:(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("strong",{children:e.label}),e.groupName&&(0,r.jsxs)("span",{className:"text-muted-foreground",children:[" (",e.groupName,")"]}),(0,r.jsx)("br",{}),"Required Level: ",e.requiredLevel]})})]})},e.competenceId))]})}),(0,r.jsx)("tbody",{children:m.map(e=>(0,r.jsxs)("tr",{"data-testid":`row-employee-${e.employeeId}`,children:[(0,r.jsx)("td",{className:"text-left",children:(0,r.jsx)("span",{className:"font-medium text-foreground",children:e.employeeName})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{className:`hr-risk-pill hr-risk-pill--${e.riskLevel.toLowerCase()}`,children:e.riskLevel})}),e.items.map((e,t)=>(0,r.jsx)("td",{children:(0,r.jsxs)("div",{className:"hr-matrix-cell",children:[(0,r.jsxs)("span",{className:"hr-matrix-cell__levels",children:[(0,r.jsx)("strong",{children:null!==e.level?e.level:"-"}),(0,r.jsx)("span",{children:"/"}),(0,r.jsx)("span",{children:e.requiredLevel??a[t]?.requiredLevel??"-"})]}),(0,r.jsx)("span",{className:`hr-status-badge hr-status-badge--${e.status.toLowerCase()}`,children:e.status})]})},a[t].competenceId))]},e.employeeId))})]})}),x&&!h&&m.length>0&&0===a.length&&(0,r.jsx)("div",{className:"p-6 rounded-lg border border-dashed border-border bg-muted/50 text-center",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"No mandatory competences defined for this position."})})]})})}e.s(["default",()=>et],53330)}]);