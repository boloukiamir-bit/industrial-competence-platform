(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],27612)},86116,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),d=e.i(71689),s=e.i(7233),l=e.i(27612),i=e.i(53210);function n(){let e=(0,r.useParams)(),n=(0,r.useRouter)(),o=e.id,[m,c]=(0,a.useState)([]),[g,x]=(0,a.useState)(!0),[u,y]=(0,a.useState)(!1),[b,p]=(0,a.useState)(""),[h,v]=(0,a.useState)({templateId:"",reviewDate:new Date().toISOString().split("T")[0],periodStart:"",periodEnd:"",overallRating:0,summary:"",notes:""}),[k,j]=(0,a.useState)([]);async function w(e){e.preventDefault(),y(!0);try{await i.supabase.from("employee_reviews").insert({employee_id:o,template_id:h.templateId||null,review_date:h.reviewDate,period_start:h.periodStart||null,period_end:h.periodEnd||null,overall_rating:h.overallRating||null,summary:h.summary||null,goals:k.filter(e=>e.text.trim()).length>0?k.filter(e=>e.text.trim()):null,notes:h.notes||null}),n.push(`/app/employees/${o}`)}catch(e){console.error("Error creating review:",e),y(!1)}}return(0,a.useEffect)(()=>{!async function(){let[e,t]=await Promise.all([i.supabase.from("review_templates").select("*").eq("is_active",!0).order("name"),i.supabase.from("employees").select("name").eq("id",o).single()]);c((e.data||[]).map(e=>({id:e.id,name:e.name,description:e.description,audience:e.audience,isActive:e.is_active,createdAt:e.created_at}))),p(t.data?.name||""),x(!1)}()},[o]),g?(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)("div",{className:"animate-pulse h-64 bg-gray-200 dark:bg-gray-700 rounded"})}):(0,t.jsxs)("div",{className:"p-6 max-w-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,t.jsx)("button",{onClick:()=>n.back(),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md","data-testid":"button-back",children:(0,t.jsx)(d.ArrowLeft,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"New Review"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["For ",b]})]})]}),(0,t.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Template"}),(0,t.jsxs)("select",{value:h.templateId,onChange:e=>v({...h,templateId:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white","data-testid":"select-template",children:[(0,t.jsx)("option",{value:"",children:"Select template..."}),m.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Review Date *"}),(0,t.jsx)("input",{type:"date",value:h.reviewDate,onChange:e=>v({...h,reviewDate:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white","data-testid":"input-review-date"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Period Start"}),(0,t.jsx)("input",{type:"date",value:h.periodStart,onChange:e=>v({...h,periodStart:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white","data-testid":"input-period-start"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Period End"}),(0,t.jsx)("input",{type:"date",value:h.periodEnd,onChange:e=>v({...h,periodEnd:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white","data-testid":"input-period-end"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Overall Rating (1-5)"}),(0,t.jsx)("div",{className:"flex gap-2",children:[1,2,3,4,5].map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>v({...h,overallRating:e}),className:`w-10 h-10 rounded-md font-medium transition-colors ${h.overallRating===e?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,"data-testid":`button-rating-${e}`,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Summary"}),(0,t.jsx)("textarea",{value:h.summary,onChange:e=>v({...h,summary:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-none",placeholder:"Overall feedback and observations...","data-testid":"textarea-summary"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Goals"}),(0,t.jsxs)("button",{type:"button",onClick:function(){j([...k,{id:crypto.randomUUID(),text:"",status:"pending"}])},className:"flex items-center gap-1 text-sm text-blue-600 dark:text-blue-400 hover:underline","data-testid":"button-add-goal",children:[(0,t.jsx)(s.Plus,{className:"h-4 w-4"}),"Add Goal"]})]}),0===k.length?(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No goals added"}):(0,t.jsx)("div",{className:"space-y-2",children:k.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"text",value:e.text,onChange:t=>{var a,r;return a=e.id,r=t.target.value,void j(k.map(e=>e.id===a?{...e,text:r}:e))},placeholder:"Goal description...",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white","data-testid":`input-goal-${e.id}`}),(0,t.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.id,void j(k.filter(e=>e.id!==t))},className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md","data-testid":`button-remove-goal-${e.id}`,children:(0,t.jsx)(l.Trash2,{className:"h-4 w-4"})})]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes"}),(0,t.jsx)("textarea",{value:h.notes,onChange:e=>v({...h,notes:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-none",placeholder:"Additional notes...","data-testid":"textarea-notes"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>n.back(),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700","data-testid":"button-cancel",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:u,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 rounded-md","data-testid":"button-save-review",children:u?"Saving...":"Save Review"})]})]})]})}e.s(["default",()=>n])}]);