(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(47163);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",e),...a}));r.displayName="Card";let i=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...a}));i.displayName="CardHeader";let n=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));n.displayName="CardTitle";let o=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",e),...a}));o.displayName="CardDescription";let l=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...a}));l.displayName="CardContent",a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>l,"CardDescription",()=>o,"CardHeader",()=>i,"CardTitle",()=>n])},78894,e=>{"use strict";let t=(0,e.i(75254).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},66685,e=>{"use strict";var t=e.i(71645),a=e.i(18566),s=e.i(65615);function r(){let[e,r]=(0,t.useState)(!0),i=(0,a.useRouter)();return(0,t.useEffect)(()=>{let e=!0;return async function(){try{!await (0,s.getAuthUser)()&&e?i.replace("/login"):e&&r(!1)}catch(t){console.error("Error checking auth",t),e&&i.replace("/login")}}(),()=>{e=!1}},[i]),{loading:e}}e.s(["useAuthGuard",()=>r])},4072,e=>{"use strict";var t=e.i(53210);let a=[{id:"sick_leave",name:"Sick Leave Follow-up",description:"Structured follow-up process for employees on sick leave according to Swedish labor law",category:"health",defaultSteps:[{title:"Day 1 Contact",description:"Manager contacts employee to check in",daysFromStart:1,responsibleRole:"manager"},{title:"Week 1 Review",description:"Assess if return-to-work plan needed",daysFromStart:7,responsibleRole:"hr"},{title:"Day 14 Coordination",description:"Evaluate need for rehab coordination with Försäkringskassan",daysFromStart:14,responsibleRole:"hr"},{title:"Day 30 Meeting",description:"Formal meeting to discuss return or continued leave",daysFromStart:30,responsibleRole:"manager"},{title:"Day 60 Rehab Plan",description:"If applicable, create detailed rehabilitation plan",daysFromStart:60,responsibleRole:"hr"}]},{id:"rehab",name:"Rehabilitation Process",description:"Comprehensive rehabilitation plan for returning employees to full capacity",category:"health",defaultSteps:[{title:"Initial Assessment",description:"Assess current capacity and restrictions",daysFromStart:0,responsibleRole:"hr"},{title:"Doctor Consultation",description:"Review medical recommendations",daysFromStart:3,responsibleRole:"hr"},{title:"Workplace Adjustment",description:"Implement necessary workplace adjustments",daysFromStart:7,responsibleRole:"manager"},{title:"Week 2 Check-in",description:"Review progress and adjust if needed",daysFromStart:14,responsibleRole:"manager"},{title:"Week 4 Evaluation",description:"Formal evaluation of rehab progress",daysFromStart:28,responsibleRole:"hr"},{title:"Completion Review",description:"Final assessment and closure",daysFromStart:56,responsibleRole:"hr"}]},{id:"parental_leave",name:"Parental Leave",description:"Manage parental leave transitions smoothly for both departure and return",category:"leave",defaultSteps:[{title:"Notification Received",description:"Record parental leave request and planned dates",daysFromStart:0,responsibleRole:"hr"},{title:"Handover Planning",description:"Plan work handover and coverage",daysFromStart:7,responsibleRole:"manager"},{title:"Backfill Decision",description:"Determine if temporary replacement needed",daysFromStart:14,responsibleRole:"hr"},{title:"Pre-departure Meeting",description:"Final handover meeting before leave",daysFromStart:-7,responsibleRole:"manager"},{title:"Return Contact",description:"Contact employee 30 days before planned return",daysFromStart:-30,responsibleRole:"hr"},{title:"Return Planning",description:"Plan reboarding activities",daysFromStart:-14,responsibleRole:"manager"}]},{id:"reboarding",name:"Reboarding",description:"Re-integrate employees returning from extended leave",category:"lifecycle",defaultSteps:[{title:"Welcome Back Meeting",description:"Discuss changes and expectations",daysFromStart:0,responsibleRole:"manager"},{title:"System Access Check",description:"Verify all system access is active",daysFromStart:0,responsibleRole:"hr"},{title:"Training Update",description:"Review and schedule any required training updates",daysFromStart:3,responsibleRole:"manager"},{title:"Week 1 Check-in",description:"Discuss how re-integration is going",daysFromStart:7,responsibleRole:"manager"},{title:"30-day Review",description:"Formal review of reboarding success",daysFromStart:30,responsibleRole:"hr"}]},{id:"onboarding",name:"New Employee Onboarding",description:"Standard onboarding process for new employees",category:"lifecycle",defaultSteps:[{title:"Pre-start Preparation",description:"Prepare equipment, accounts, and workspace",daysFromStart:-7,responsibleRole:"hr"},{title:"Day 1 Welcome",description:"Welcome meeting and office tour",daysFromStart:0,responsibleRole:"manager"},{title:"HR Introduction",description:"Policies, benefits, and compliance training",daysFromStart:1,responsibleRole:"hr"},{title:"Week 1 Check-in",description:"Review first week experience",daysFromStart:5,responsibleRole:"manager"},{title:"30-day Review",description:"Formal review of onboarding progress",daysFromStart:30,responsibleRole:"manager"},{title:"90-day Review",description:"End of probation review",daysFromStart:90,responsibleRole:"hr"}]},{id:"offboarding",name:"Employee Offboarding",description:"Standard offboarding process for departing employees",category:"lifecycle",defaultSteps:[{title:"Exit Notice Received",description:"Document resignation or termination details",daysFromStart:0,responsibleRole:"hr"},{title:"Handover Planning",description:"Plan knowledge transfer and handover",daysFromStart:1,responsibleRole:"manager"},{title:"Exit Interview Scheduled",description:"Schedule exit interview if applicable",daysFromStart:7,responsibleRole:"hr"},{title:"Equipment Return",description:"Collect company equipment and access cards",daysFromStart:-2,responsibleRole:"hr"},{title:"Final Day Procedures",description:"System access revocation, final paperwork",daysFromStart:0,responsibleRole:"hr"},{title:"Post-departure Cleanup",description:"Archive data, update org charts",daysFromStart:1,responsibleRole:"hr"}]}];function s(){return a}async function r(e){let a=t.supabase.from("hr_workflow_instances").select("*").order("started_at",{ascending:!1});e?.status&&(a=a.eq("status",e.status)),e?.employeeId&&(a=a.eq("employee_id",e.employeeId)),e?.templateId&&(a=a.eq("template_id",e.templateId));let{data:s,error:r}=await a;return r||!s?[]:s.map(l)}async function i(e){let{data:a,error:s}=await t.supabase.from("hr_workflow_instances").select("*").eq("id",e).single();return s||!a?null:l(a)}async function n(e,a,s,r){let n=await i(e);if(!n)return!1;let o=n.steps.map(e=>e.id===a?{...e,isCompleted:!0,completedAt:new Date().toISOString(),completedBy:s,notes:r}:e),l=o.every(e=>e.isCompleted),{error:d}=await t.supabase.from("hr_workflow_instances").update({steps:o,status:l?"completed":"active",completed_at:l?new Date().toISOString():null}).eq("id",e);return!d}async function o(e){let{error:a}=await t.supabase.from("hr_workflow_instances").update({status:"cancelled"}).eq("id",e);return!a}function l(e){return{id:e.id,templateId:e.template_id,templateName:e.template_name,employeeId:e.employee_id,employeeName:e.employee_name,startedAt:e.started_at,dueDate:e.due_date,status:e.status,steps:e.steps||[],createdBy:e.created_by,completedAt:e.completed_at,notes:e.notes}}e.s(["WORKFLOW_TEMPLATES",0,a,"cancelWorkflow",()=>o,"completeWorkflowStep",()=>n,"getWorkflowById",()=>i,"getWorkflowInstances",()=>r,"getWorkflowTemplates",()=>s])},41159,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(22016),r=e.i(70065),i=e.i(78894),n=e.i(38036),o=e.i(4072);async function l(){let e=await (0,o.getWorkflowInstances)({status:"active"}),t=new Date().toISOString().slice(0,10),a=new Date(`${t}T00:00:00`),s=new Date(a);s.setDate(s.getDate()+7);let r=[],i=[],n=[];for(let t of e){let e=o.WORKFLOW_TEMPLATES.find(e=>e.id===t.templateId);for(let o of t.steps){if(o.isCompleted)continue;let l=t.startedAt?function(e,t){let a=new Date(e);return a.setDate(a.getDate()+t),a.toISOString().slice(0,10)}(t.startedAt,o.daysFromStart):null,d={id:o.id,stepTitle:o.title,status:o.isCompleted?"done":"not_started",dueDate:l,workflowInstanceId:t.id,workflowName:t.templateName||e?.name||"Workflow",workflowCategory:e?.category||null,employeeId:t.employeeId,employeeName:t.employeeName||null};if(!l)continue;let c=new Date(`${l}T00:00:00`);c<a?r.push(d):c.getTime()===a.getTime()?i.push(d):c>a&&c<=s&&n.push(d)}}return r.sort((e,t)=>(e.dueDate||"").localeCompare(t.dueDate||"")),i.sort((e,t)=>e.stepTitle.localeCompare(t.stepTitle)),n.sort((e,t)=>(e.dueDate||"").localeCompare(t.dueDate||"")),{overdue:r,today:i,upcoming:n}}var d=e.i(66685);function c(){let{loading:e}=(0,d.useAuthGuard)();return e?(0,t.jsx)("main",{className:"hr-page",children:(0,t.jsx)("p",{children:"Checking access..."})}):(0,t.jsx)(p,{})}function p(){let[e,s]=(0,a.useState)(null),[o,d]=(0,a.useState)(!0),[c,p]=(0,a.useState)(null),[h,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{!async function(){let e=await (0,n.getCurrentUser)();if(!e||"HR_ADMIN"!==e.role){u(!1),d(!1);return}try{let e=await l();s(e)}catch(e){console.error(e),p("Could not load HR tasks.")}finally{d(!1)}}()},[]);let g=(e?.overdue.length??0)+(e?.today.length??0)+(e?.upcoming.length??0);return o?(0,t.jsx)("main",{className:"hr-page",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),(0,t.jsx)("div",{className:"hr-kpi-grid",children:[1,2,3,4].map(e=>(0,t.jsx)("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl"},e))}),(0,t.jsx)("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded"})]})}):h?(0,t.jsxs)("main",{className:"hr-page","data-testid":"hr-tasks-page",children:[(0,t.jsx)("header",{className:"hr-page__header",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"hr-page__title",children:"HR Tasks"}),(0,t.jsx)("p",{className:"hr-page__subtitle",children:"All open workflow steps, sorted by urgency - overdue, today and the coming week."})]})}),c&&(0,t.jsx)("p",{className:"hr-error",children:c}),!c&&e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("section",{className:"hr-kpi-grid","data-testid":"kpi-grid",children:[(0,t.jsxs)("div",{className:"hr-kpi",children:[(0,t.jsx)("div",{className:"hr-kpi__label",children:"Active tasks"}),(0,t.jsx)("div",{className:"hr-kpi__value","data-testid":"kpi-active",children:g})]}),(0,t.jsxs)("div",{className:"hr-kpi",children:[(0,t.jsx)("div",{className:"hr-kpi__label",children:"Overdue"}),(0,t.jsx)("div",{className:"hr-kpi__value hr-kpi__value--danger","data-testid":"kpi-overdue",children:e.overdue.length})]}),(0,t.jsxs)("div",{className:"hr-kpi",children:[(0,t.jsx)("div",{className:"hr-kpi__label",children:"Due today"}),(0,t.jsx)("div",{className:"hr-kpi__value hr-kpi__value--warn","data-testid":"kpi-today",children:e.today.length})]}),(0,t.jsxs)("div",{className:"hr-kpi",children:[(0,t.jsx)("div",{className:"hr-kpi__label",children:"Next 7 days"}),(0,t.jsx)("div",{className:"hr-kpi__value hr-kpi__value--ok","data-testid":"kpi-upcoming",children:e.upcoming.length})]})]}),(0,t.jsx)(m,{title:"Overdue",description:"Tasks that should already have been completed.",tasks:e.overdue,badgeClass:"hr-pill--danger",testId:"section-overdue"}),(0,t.jsx)(m,{title:"Due today",description:"Tasks that must be handled today.",tasks:e.today,badgeClass:"hr-pill--warn",testId:"section-today"}),(0,t.jsx)(m,{title:"Coming 7 days",description:"Tasks with deadlines within the next week.",tasks:e.upcoming,badgeClass:"hr-pill--ok",testId:"section-upcoming"})]})]}):(0,t.jsx)("main",{className:"hr-page",children:(0,t.jsx)(r.Card,{children:(0,t.jsxs)(r.CardContent,{className:"py-12 text-center",children:[(0,t.jsx)(i.AlertTriangle,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Access Denied"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"This page is only accessible to HR Administrators."})]})})})}function m({title:e,description:a,tasks:s,badgeClass:r,testId:i}){return(0,t.jsxs)("section",{className:"hr-task-section","data-testid":i,children:[(0,t.jsxs)("header",{className:"hr-task-section__header",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"hr-section__title",children:e}),(0,t.jsx)("p",{className:"hr-task-section__description",children:a})]}),(0,t.jsx)("span",{className:`hr-pill ${r}`,children:s.length})]}),0===s.length?(0,t.jsx)("p",{className:"hr-task-empty",children:"No tasks in this bucket."}):(0,t.jsx)("div",{className:"hr-task-list",children:s.map(e=>(0,t.jsx)(h,{task:e},e.id))})]})}function h({task:e}){let a=e.dueDate?new Date(e.dueDate).toLocaleDateString("sv-SE"):"No due date",r="not_started"===e.status?"Not started":"in_progress"===e.status?"In progress":"done"===e.status?"Done":e.status;return(0,t.jsxs)(s.default,{href:"/app/hr/workflows",className:"hr-task-row","data-testid":`task-row-${e.id}`,children:[(0,t.jsxs)("div",{className:"hr-task-row__main",children:[(0,t.jsx)("h3",{className:"hr-task-row__title",children:e.stepTitle}),(0,t.jsxs)("p",{className:"hr-task-row__subtitle",children:[e.employeeName??"Unknown employee"," - ",e.workflowName]})]}),(0,t.jsxs)("div",{className:"hr-task-row__meta",children:[(0,t.jsx)("span",{className:"hr-task-row__date",children:a}),(0,t.jsx)("span",{className:"hr-task-row__status",children:r})]})]})}e.s(["default",()=>c],41159)}]);