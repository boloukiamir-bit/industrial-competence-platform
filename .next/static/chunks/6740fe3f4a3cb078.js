(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25913,e=>{"use strict";var t=e.i(7670);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=t.clsx;e.s(["cva",0,(e,t)=>a=>{var i;if((null==t?void 0:t.variants)==null)return s(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:n,defaultVariants:l}=t,d=Object.keys(n).map(e=>{let t=null==a?void 0:a[e],s=null==l?void 0:l[e];if(null===t)return null;let i=r(t)||r(s);return n[e][i]}),o=a&&Object.entries(a).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{});return s(e,d,null==t||null==(i=t.compoundVariants)?void 0:i.reduce((e,t)=>{let{class:r,className:s,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...o}[t]):({...l,...o})[t]===r})?[...e,r,s]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}])},91918,20783,e=>{"use strict";var t=e.i(71645);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function s(...e){return t=>{let s=!1,a=e.map(e=>{let a=r(e,t);return s||"function"!=typeof a||(s=!0),a});if(s)return()=>{for(let t=0;t<a.length;t++){let s=a[t];"function"==typeof s?s():r(e[t],null)}}}}function a(...e){return t.useCallback(s(...e),e)}e.s(["composeRefs",()=>s,"useComposedRefs",()=>a],20783);var i=e.i(43476);function n(e){var r;let a,n=(r=e,(a=t.forwardRef((e,r)=>{let{children:a,...i}=e;if(t.isValidElement(a)){var n;let e,l,d=(n=a,(l=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(l=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),o=function(e,t){let r={...t};for(let s in t){let a=e[s],i=t[s];/^on[A-Z]/.test(s)?a&&i?r[s]=(...e)=>{i(...e),a(...e)}:a&&(r[s]=a):"style"===s?r[s]={...a,...i}:"className"===s&&(r[s]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}(i,a.props);return a.type!==t.Fragment&&(o.ref=r?s(r,d):d),t.cloneElement(a,o)}return t.Children.count(a)>1?t.Children.only(null):null})).displayName=`${r}.SlotClone`,a),l=t.forwardRef((e,r)=>{let{children:s,...a}=e,l=t.Children.toArray(s),d=l.find(c);if(d){let e=d.props.children,s=l.map(r=>r!==d?r:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,i.jsx)(n,{...a,ref:r,children:t.isValidElement(e)?t.cloneElement(e,void 0,s):null})}return(0,i.jsx)(n,{...a,ref:r,children:s})});return l.displayName=`${e}.Slot`,l}var l=n("Slot"),d=Symbol("radix.slottable");function o(e){let t=({children:e})=>(0,i.jsx)(i.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=d,t}function c(e){return t.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===d}e.s(["Slot",()=>l,"createSlot",()=>n,"createSlottable",()=>o],91918)},67881,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(91918),a=e.i(25913),i=e.i(47163);let n=(0,a.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:"border [border-color:var(--button-outline)] shadow-xs active:shadow-none",secondary:"border bg-secondary text-secondary-foreground border-secondary-border",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=r.forwardRef(({className:e,variant:r,size:a,asChild:l=!1,...d},o)=>{let c=l?s.Slot:"button";return(0,t.jsx)(c,{className:(0,i.cn)(n({variant:r,size:a,className:e})),ref:o,...d})});l.displayName="Button",e.s(["Button",()=>l,"buttonVariants",()=>n])},43531,e=>{"use strict";let t=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},37727,e=>{"use strict";let t=(0,e.i(75254).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],3116)},79002,e=>{"use strict";let t=(0,e.i(75254).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.s(["UserPlus",()=>t],79002)},63488,e=>{"use strict";let t=(0,e.i(75254).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);e.s(["Mail",()=>t],63488)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},89699,e=>{"use strict";var t=e.i(5512),r=e.i(53210);async function s(){let{data:{session:e}}=await r.supabase.auth.getSession(),t={"Content-Type":"application/json"};return e?.access_token&&(t.Authorization=`Bearer ${e.access_token}`),t}async function a(e){let r=await s(),a=await fetch(e,{headers:r});if((0,t.logApiCall)(e,a.status),!a.ok){let r={};try{r=await a.json()}catch{r={message:a.statusText}}throw(0,t.logDebugError)({type:"api",endpoint:e,status:a.status,code:r.code,message:r.message||r.error||`HTTP ${a.status}`,hint:r.hint}),Error(r.message||r.error||`Request failed: ${a.status}`)}return a.json()}async function i(e,r){let a=await s(),i=await fetch(e,{method:"POST",headers:a,body:JSON.stringify(r)});if((0,t.logApiCall)(e,i.status),!i.ok){let r={};try{r=await i.json()}catch{r={message:i.statusText}}throw(0,t.logDebugError)({type:"api",endpoint:e,status:i.status,code:r.code,message:r.message||r.error||`HTTP ${i.status}`,hint:r.hint}),Error(r.message||r.error||`Request failed: ${i.status}`)}return i.json()}e.s(["apiGet",()=>a,"apiPost",()=>i])},71634,62163,98962,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566),a=e.i(68934);function i({children:e,requireAdmin:i=!1}){let{currentOrg:n,isLoading:l,memberships:d,isAdmin:o}=(0,a.useOrg)(),c=(0,s.useRouter)();return((0,r.useEffect)(()=>{if(!l){if(!n&&d.length>0||!n&&0===d.length)return void c.replace("/app/org/select");if(i&&!o)return void c.replace("/app")}},[n,l,d,o,i,c]),l)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"animate-pulse text-muted-foreground",children:"Loading..."})}):n&&(!i||o)?(0,t.jsx)(t.Fragment,{children:e}):null}e.s(["OrgGuard",()=>i],71634);var n=e.i(31278),l=e.i(63209),d=e.i(16715),o=e.i(10289),c=e.i(75254);let u=(0,c.default)("FileQuestion",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]]);var m=e.i(67881),x=e.i(22016);function p({status:e,children:r,error:s,onRetry:a,emptyTitle:i="No data yet",emptyMessage:c="Get started by adding your first item.",emptyCta:p,emptyIcon:h,loadingMessage:f="Loading...",minHeight:g="400px"}){return"ready"===e&&r?(0,t.jsx)(t.Fragment,{children:r}):"loading"===e?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",style:{minHeight:g},"data-testid":"state-loading",children:[(0,t.jsx)(n.Loader2,{className:"w-6 h-6 animate-spin text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:f})]}):"error"===e?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",style:{minHeight:g},"data-testid":"state-error",children:[(0,t.jsx)("div",{className:"p-3 rounded-full bg-destructive/10",children:(0,t.jsx)(l.AlertCircle,{className:"w-8 h-8 text-destructive"})}),(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("h3",{className:"font-medium text-foreground mb-1",children:"Something went wrong"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:s?.message||"Failed to load data"}),s?.code&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground font-mono bg-muted px-2 py-1 rounded inline-block",children:["Code: ",s.code]}),s?.hint&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Hint: ",s.hint]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,t.jsxs)(m.Button,{variant:"outline",onClick:a,"data-testid":"button-retry",children:[(0,t.jsx)(d.RefreshCw,{className:"w-4 h-4 mr-2"}),"Retry"]}),(0,t.jsx)(m.Button,{variant:"ghost",asChild:!0,"data-testid":"button-open-debug",children:(0,t.jsxs)(x.default,{href:"/app/debug",children:[(0,t.jsx)(o.Bug,{className:"w-4 h-4 mr-2"}),"Open Debug"]})})]})]}):"empty"===e?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",style:{minHeight:g},"data-testid":"state-empty",children:[(0,t.jsx)("div",{className:"p-3 rounded-full bg-muted",children:h||(0,t.jsx)(u,{className:"w-8 h-8 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("h3",{className:"font-medium text-foreground mb-1",children:i}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:c})]}),p&&(p.href?(0,t.jsx)(m.Button,{asChild:!0,"data-testid":"button-empty-cta",children:(0,t.jsx)(x.default,{href:p.href,children:p.label})}):(0,t.jsx)(m.Button,{onClick:p.onClick,"data-testid":"button-empty-cta",children:p.label}))]}):null}function h(e,t,r){return t?"loading":r?"error":!e||Array.isArray(e)&&0===e.length?"empty":"ready"}e.s(["DataState",()=>p,"useDataState",()=>h],62163);let f=(0,c.default)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);e.s(["UserX",()=>f],98962)},13969,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(68934),a=e.i(71634),i=e.i(62163),n=e.i(89699),l=e.i(61911),d=e.i(79002),o=e.i(98962),c=e.i(31278),u=e.i(63488),m=e.i(3116),x=e.i(43531),p=e.i(37727);function h(){let{currentOrg:e,isAdmin:a}=(0,s.useOrg)(),[h,f]=(0,r.useState)([]),[g,y]=(0,r.useState)([]),[b,v]=(0,r.useState)(!0),[j,N]=(0,r.useState)(null),[w,k]=(0,r.useState)(!1),[C,S]=(0,r.useState)(""),[R,_]=(0,r.useState)("user"),[M,A]=(0,r.useState)(!1),[E,O]=(0,r.useState)(null),[U,P]=(0,r.useState)(null),D=(0,r.useCallback)(async()=>{if(e){v(!0),N(null);try{let t=await (0,n.apiGet)(`/api/admin/members?orgId=${e.id}`);f(t.members||[]),y(t.invites||[])}catch(e){console.error("Fetch error:",e),N({message:e instanceof Error?e.message:"Failed to load members",code:"NETWORK_ERROR"})}finally{v(!1)}}},[e]);(0,r.useEffect)(()=>{D()},[D]);let I=async t=>{if(t.preventDefault(),e){A(!0),O(null);try{await (0,n.apiPost)("/api/admin/invite",{orgId:e.id,email:C,role:R}),S(""),_("user"),k(!1),await D()}catch(e){console.error("Invite error:",e),O(e instanceof Error?e.message:"Failed to send invite")}finally{A(!1)}}},T=async(t,r)=>{if(e){P(t);try{await (0,n.apiPost)("/api/admin/membership/role",{orgId:e.id,userId:t,role:r}),await D()}catch(e){console.error("Role change error:",e)}finally{P(null)}}},$=async t=>{if(e&&confirm("Are you sure you want to disable this user?"))try{await (0,n.apiPost)("/api/admin/membership/disable",{orgId:e.id,userId:t}),await D()}catch(e){console.error("Disable error:",e)}},F=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),B=(0,i.useDataState)(h,b,j);return(0,t.jsxs)("div",{className:"p-6 max-w-6xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-foreground","data-testid":"text-page-title",children:"User Management"}),(0,t.jsxs)("p",{className:"text-muted-foreground mt-1",children:["Manage members and invites for ",e?.name]})]}),a&&"error"!==B&&(0,t.jsxs)("button",{onClick:()=>k(!w),className:"px-4 py-2 rounded-md bg-primary text-primary-foreground flex items-center gap-2","data-testid":"button-invite-user",children:[(0,t.jsx)(d.UserPlus,{className:"w-4 h-4"}),"Invite User"]})]}),w&&(0,t.jsxs)("div",{className:"p-4 rounded-lg border border-border bg-card",children:[E&&(0,t.jsx)("div",{className:"mb-4 p-3 rounded-md bg-destructive/10 text-destructive text-sm",children:E}),(0,t.jsxs)("form",{onSubmit:I,className:"flex flex-wrap gap-4 items-end",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,t.jsx)("label",{htmlFor:"invite-email",className:"block text-sm font-medium text-foreground mb-1",children:"Email Address"}),(0,t.jsx)("input",{id:"invite-email",type:"email",value:C,onChange:e=>S(e.target.value),placeholder:"user@example.com",className:"w-full px-3 py-2 rounded-md border border-input bg-background text-foreground",required:!0,"data-testid":"input-invite-email"})]}),(0,t.jsxs)("div",{className:"w-40",children:[(0,t.jsx)("label",{htmlFor:"invite-role",className:"block text-sm font-medium text-foreground mb-1",children:"Role"}),(0,t.jsxs)("select",{id:"invite-role",value:R,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 rounded-md border border-input bg-background text-foreground","data-testid":"select-invite-role",children:[(0,t.jsx)("option",{value:"user",children:"User"}),(0,t.jsx)("option",{value:"manager",children:"Manager"}),(0,t.jsx)("option",{value:"hr",children:"HR"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>k(!1),className:"px-4 py-2 rounded-md border border-border text-foreground","data-testid":"button-cancel-invite",children:"Cancel"}),(0,t.jsxs)("button",{type:"submit",disabled:M,className:"px-4 py-2 rounded-md bg-primary text-primary-foreground disabled:opacity-50 flex items-center gap-2","data-testid":"button-send-invite",children:[M?(0,t.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(u.Mail,{className:"w-4 h-4"}),"Send Invite"]})]})]})]}),(0,t.jsx)(i.DataState,{status:B,error:j,onRetry:D,emptyTitle:"No members yet",emptyMessage:"Invite users to join your organization.",emptyIcon:(0,t.jsx)(l.Users,{className:"w-8 h-8 text-muted-foreground"}),emptyCta:{label:"Invite User",onClick:()=>k(!0)},children:(0,t.jsxs)(t.Fragment,{children:[g.length>0&&(0,t.jsxs)("div",{className:"rounded-lg border border-border bg-card",children:[(0,t.jsx)("div",{className:"p-4 border-b border-border",children:(0,t.jsxs)("h2",{className:"font-medium text-foreground flex items-center gap-2",children:[(0,t.jsx)(m.Clock,{className:"w-4 h-4"}),"Pending Invites (",g.length,")"]})}),(0,t.jsx)("div",{className:"divide-y divide-border",children:g.map(e=>(0,t.jsxs)("div",{className:"p-4 flex items-center justify-between","data-testid":`row-invite-${e.id}`,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-foreground",children:e.email}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Invited as ",e.role," - Expires ",F(e.expires_at)]})]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded text-xs bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200",children:"Pending"})]},e.id))})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-border bg-card",children:[(0,t.jsx)("div",{className:"p-4 border-b border-border",children:(0,t.jsxs)("h2",{className:"font-medium text-foreground flex items-center gap-2",children:[(0,t.jsx)(l.Users,{className:"w-4 h-4"}),"Members (",h.filter(e=>"active"===e.status).length,")"]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-border bg-muted/50",children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Email"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Role"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Status"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Joined"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-medium text-muted-foreground",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-border",children:h.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-muted/30","data-testid":`row-member-${e.user_id}`,children:[(0,t.jsx)("td",{className:"px-4 py-3 text-foreground",children:e.email||"Unknown"}),(0,t.jsx)("td",{className:"px-4 py-3",children:a&&U!==e.user_id?(0,t.jsxs)("select",{value:e.role,onChange:t=>T(e.user_id,t.target.value),className:"px-2 py-1 rounded border border-input bg-background text-foreground text-sm","data-testid":`select-role-${e.user_id}`,children:[(0,t.jsx)("option",{value:"user",children:"User"}),(0,t.jsx)("option",{value:"manager",children:"Manager"}),(0,t.jsx)("option",{value:"hr",children:"HR"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]}):U===e.user_id?(0,t.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin text-muted-foreground"}):(0,t.jsx)("span",{className:"capitalize",children:e.role})}),(0,t.jsx)("td",{className:"px-4 py-3",children:"active"===e.status?(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[(0,t.jsx)(x.Check,{className:"w-3 h-3"}),"Active"]}):(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[(0,t.jsx)(p.X,{className:"w-3 h-3"}),"Disabled"]})}),(0,t.jsx)("td",{className:"px-4 py-3 text-muted-foreground text-sm",children:F(e.created_at)}),(0,t.jsx)("td",{className:"px-4 py-3 text-right",children:a&&"active"===e.status&&(0,t.jsx)("button",{onClick:()=>$(e.user_id),className:"p-2 rounded text-muted-foreground hover:text-destructive",title:"Disable user","data-testid":`button-disable-${e.user_id}`,children:(0,t.jsx)(o.UserX,{className:"w-4 h-4"})})})]},e.user_id))})]})})]})]})})]})}function f(){return(0,t.jsx)(a.OrgGuard,{requireAdmin:!0,children:(0,t.jsx)(h,{})})}e.s(["default",()=>f])}]);