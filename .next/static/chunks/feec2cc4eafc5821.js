(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78894,e=>{"use strict";let t=(0,e.i(75254).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},25913,e=>{"use strict";var t=e.i(7670);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,a=t.clsx;e.s(["cva",0,(e,t)=>r=>{var i;if((null==t?void 0:t.variants)==null)return a(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:n,defaultVariants:l}=t,d=Object.keys(n).map(e=>{let t=null==r?void 0:r[e],a=null==l?void 0:l[e];if(null===t)return null;let i=s(t)||s(a);return n[e][i]}),o=r&&Object.entries(r).reduce((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e},{});return a(e,d,null==t||null==(i=t.compoundVariants)?void 0:i.reduce((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...l,...o}[t]):({...l,...o})[t]===s})?[...e,s,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}])},70065,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(47163);let r=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",e),...s}));r.displayName="Card";let i=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let n=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));n.displayName="CardTitle";let l=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...s}));l.displayName="CardDescription";let d=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...s}));d.displayName="CardContent",s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>d,"CardDescription",()=>l,"CardHeader",()=>i,"CardTitle",()=>n])},91918,20783,e=>{"use strict";var t=e.i(71645);function s(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function a(...e){return t=>{let a=!1,r=e.map(e=>{let r=s(e,t);return a||"function"!=typeof r||(a=!0),r});if(a)return()=>{for(let t=0;t<r.length;t++){let a=r[t];"function"==typeof a?a():s(e[t],null)}}}}function r(...e){return t.useCallback(a(...e),e)}e.s(["composeRefs",()=>a,"useComposedRefs",()=>r],20783);var i=e.i(43476);function n(e){var s;let r,n=(s=e,(r=t.forwardRef((e,s)=>{let{children:r,...i}=e;if(t.isValidElement(r)){var n;let e,l,d=(n=r,(l=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(l=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),o=function(e,t){let s={...t};for(let a in t){let r=e[a],i=t[a];/^on[A-Z]/.test(a)?r&&i?s[a]=(...e)=>{i(...e),r(...e)}:r&&(s[a]=r):"style"===a?s[a]={...r,...i}:"className"===a&&(s[a]=[r,i].filter(Boolean).join(" "))}return{...e,...s}}(i,r.props);return r.type!==t.Fragment&&(o.ref=s?a(s,d):d),t.cloneElement(r,o)}return t.Children.count(r)>1?t.Children.only(null):null})).displayName=`${s}.SlotClone`,r),l=t.forwardRef((e,s)=>{let{children:a,...r}=e,l=t.Children.toArray(a),d=l.find(c);if(d){let e=d.props.children,a=l.map(s=>s!==d?s:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,i.jsx)(n,{...r,ref:s,children:t.isValidElement(e)?t.cloneElement(e,void 0,a):null})}return(0,i.jsx)(n,{...r,ref:s,children:a})});return l.displayName=`${e}.Slot`,l}var l=n("Slot"),d=Symbol("radix.slottable");function o(e){let t=({children:e})=>(0,i.jsx)(i.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=d,t}function c(e){return t.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===d}e.s(["Slot",()=>l,"createSlot",()=>n,"createSlottable",()=>o],91918)},67881,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(91918),r=e.i(25913),i=e.i(47163);let n=(0,r.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:"border [border-color:var(--button-outline)] shadow-xs active:shadow-none",secondary:"border bg-secondary text-secondary-foreground border-secondary-border",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef(({className:e,variant:s,size:r,asChild:l=!1,...d},o)=>{let c=l?a.Slot:"button";return(0,t.jsx)(c,{className:(0,i.cn)(n({variant:s,size:r,className:e})),ref:o,...d})});l.displayName="Button",e.s(["Button",()=>l,"buttonVariants",()=>n])},43531,e=>{"use strict";let t=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},37727,e=>{"use strict";let t=(0,e.i(75254).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},84614,e=>{"use strict";let t=(0,e.i(75254).default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],84614)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],3116)},90098,e=>{"use strict";var t=e.i(47167);function s(){return"true"===new URLSearchParams(window.location.search).get("demo")||"true"===t.default.env.NEXT_PUBLIC_DEMO_MODE}e.s(["DEMO_EMPLOYEES",0,[{id:"E1001",employeeNumber:"E1001",name:"Anna Lindberg",firstName:"Anna",lastName:"Lindberg",email:"anna.lindberg@example.com",role:"Operator",line:"Pressline 1",team:"Day Shift",startDate:"2020-03-15",isActive:!0},{id:"E1002",employeeNumber:"E1002",name:"Erik Johansson",firstName:"Erik",lastName:"Johansson",email:"erik.johansson@example.com",role:"Operator",line:"Pressline 1",team:"Day Shift",startDate:"2019-06-01",isActive:!0},{id:"E1003",employeeNumber:"E1003",name:"Maria Svensson",firstName:"Maria",lastName:"Svensson",email:"maria.svensson@example.com",role:"Team Lead",line:"Pressline 1",team:"Day Shift",startDate:"2018-01-10",isActive:!0},{id:"E1004",employeeNumber:"E1004",name:"Karl Andersson",firstName:"Karl",lastName:"Andersson",email:"karl.andersson@example.com",role:"Operator",line:"Pressline 1",team:"Night Shift",startDate:"2021-09-20",isActive:!0},{id:"E1005",employeeNumber:"E1005",name:"Sofia Nilsson",firstName:"Sofia",lastName:"Nilsson",email:"sofia.nilsson@example.com",role:"Operator",line:"Pressline 2",team:"Day Shift",startDate:"2022-02-14",isActive:!0},{id:"E1006",employeeNumber:"E1006",name:"Lars Pettersson",firstName:"Lars",lastName:"Pettersson",email:"lars.pettersson@example.com",role:"Team Lead",line:"Pressline 2",team:"Day Shift",startDate:"2017-05-22",isActive:!0},{id:"E1007",employeeNumber:"E1007",name:"Emma Gustafsson",firstName:"Emma",lastName:"Gustafsson",email:"emma.gustafsson@example.com",role:"Quality Inspector",line:"Quality Control",team:"Day Shift",startDate:"2020-11-03",isActive:!0},{id:"E1008",employeeNumber:"E1008",name:"Oscar Eriksson",firstName:"Oscar",lastName:"Eriksson",email:"oscar.eriksson@example.com",role:"Operator",line:"Assembly",team:"Day Shift",startDate:"2021-04-18",isActive:!0},{id:"E1009",employeeNumber:"E1009",name:"Maja Larsson",firstName:"Maja",lastName:"Larsson",email:"maja.larsson@example.com",role:"Operator",line:"Assembly",team:"Night Shift",startDate:"2019-08-25",isActive:!0},{id:"E1010",employeeNumber:"E1010",name:"Viktor Olsson",firstName:"Viktor",lastName:"Olsson",email:"viktor.olsson@example.com",role:"Logistics Coordinator",line:"Logistics",team:"Day Shift",startDate:"2018-12-01",isActive:!0}],"DEMO_ORG_UNITS",0,[{id:"OU1",name:"Manufacturing Division",code:"MFG",type:"Division",parentId:null,employeeCount:10},{id:"OU2",name:"Pressline Department",code:"PRESS",type:"Department",parentId:"OU1",employeeCount:6},{id:"OU3",name:"Assembly Department",code:"ASSY",type:"Department",parentId:"OU1",employeeCount:2},{id:"OU4",name:"Quality Department",code:"QC",type:"Department",parentId:"OU1",employeeCount:1},{id:"OU5",name:"Logistics Department",code:"LOG",type:"Department",parentId:"OU1",employeeCount:1}],"DEMO_POSITIONS",0,[{id:"P1",name:"Pressline 1 Operator",line:"Pressline 1",minHeadcount:4},{id:"P2",name:"Pressline 2 Operator",line:"Pressline 2",minHeadcount:3},{id:"P3",name:"Assembly Operator",line:"Assembly",minHeadcount:3},{id:"P4",name:"Quality Inspector",line:"Quality Control",minHeadcount:2},{id:"P5",name:"Logistics Coordinator",line:"Logistics",minHeadcount:2}],"DEMO_SKILLS",0,[{id:"SK001",code:"PRESS_A",name:"Pressline A Operation",groupId:"G1",groupName:"Production"},{id:"SK002",code:"PRESS_B",name:"Pressline B Operation",groupId:"G1",groupName:"Production"},{id:"SK003",code:"SAFETY_BASIC",name:"Safety Basic",groupId:"G2",groupName:"Safety"},{id:"SK004",code:"SAFETY_ADV",name:"Safety Advanced",groupId:"G2",groupName:"Safety"},{id:"SK005",code:"TRUCK_A1",name:"Truck A1 License",groupId:"G3",groupName:"Certifications"},{id:"SK006",code:"TRUCK_B1",name:"Truck B1 License",groupId:"G3",groupName:"Certifications"},{id:"SK007",code:"QUALITY_INSP",name:"Quality Inspection",groupId:"G4",groupName:"Quality"},{id:"SK008",code:"FIRST_AID",name:"First Aid Certified",groupId:"G2",groupName:"Safety"}],"isDemoMode",()=>s])},79002,e=>{"use strict";let t=(0,e.i(75254).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.s(["UserPlus",()=>t],79002)},63488,e=>{"use strict";let t=(0,e.i(75254).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);e.s(["Mail",()=>t],63488)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},77841,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(68934),r=e.i(24136),i=e.i(53210),n=e.i(90098),l=e.i(10289),d=e.i(75254);let o=(0,d.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var c=e.i(43531);let m=(0,d.default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var u=e.i(84614),x=e.i(7486),p=e.i(78894),h=e.i(16715),f=e.i(31278),g=e.i(67881),y=e.i(70065);let b=[];function N(e){b.unshift(e),b.length>10&&b.pop()}function j(){let{currentOrg:e,currentRole:d,memberships:N,isLoading:j,error:v}=(0,a.useOrg)(),{user:w,isAuthenticated:C}=(0,r.useAuth)(),[k,S]=(0,s.useState)({employees:null,units:null,skills:null,positions:null}),[D,E]=(0,s.useState)(!1),[O,A]=(0,s.useState)(!1),[_,I]=(0,s.useState)([]);(0,s.useEffect)(()=>{I([...b])},[]);let R=async()=>{if(e){E(!0);try{let[t,s,a,r]=await Promise.allSettled([i.supabase.from("employees").select("id",{count:"exact",head:!0}).eq("org_id",e.id),i.supabase.from("org_units").select("id",{count:"exact",head:!0}).eq("org_id",e.id),i.supabase.from("competences").select("id",{count:"exact",head:!0}),i.supabase.from("positions").select("id",{count:"exact",head:!0})]);S({employees:"fulfilled"===t.status?t.value.count:null,units:"fulfilled"===s.status?s.value.count:null,skills:"fulfilled"===a.status?a.value.count:null,positions:"fulfilled"===r.status?r.value.count:null})}catch(e){console.error("Error fetching counts:",e)}finally{E(!1)}}};(0,s.useEffect)(()=>{e&&R()},[e]);let M=()=>e?localStorage.getItem("nadiplan_current_org")===e.id?"localStorage":1===N.length?"auto-selected (single org)":"selected":"none",P=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({timestamp:new Date().toISOString(),demoMode:(0,n.isDemoMode)(),user:{email:w?.email||"not authenticated",id:w?.id||null,authenticated:C},organization:{id:e?.id||null,name:e?.name||null,slug:e?.slug||null,source:M(),role:d},memberships:N.map(e=>({orgId:e.org_id,orgName:e.organization?.name,role:e.role,status:e.status})),counts:k,errors:_.slice(0,10),orgLoadingState:{isLoading:j,error:v}},null,2)),A(!0),setTimeout(()=>A(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return(0,t.jsxs)("div",{className:"p-6 max-w-4xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-semibold text-foreground flex items-center gap-2","data-testid":"text-page-title",children:[(0,t.jsx)(l.Bug,{className:"w-6 h-6"}),"Debug Cockpit"]}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"System state and diagnostics"})]}),(0,t.jsxs)(g.Button,{onClick:P,"data-testid":"button-copy-report",children:[O?(0,t.jsx)(c.Check,{className:"w-4 h-4 mr-2"}):(0,t.jsx)(o,{className:"w-4 h-4 mr-2"}),O?"Copied!":"Copy Debug Report"]})]}),(0,n.isDemoMode)()&&(0,t.jsx)("div",{className:"p-4 rounded-md bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800",children:(0,t.jsxs)("p",{className:"text-sm text-amber-800 dark:text-amber-200 flex items-center gap-2",children:[(0,t.jsx)(p.AlertTriangle,{className:"w-4 h-4"}),"Demo mode is active. Database queries return mock data."]})}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)(y.Card,{children:[(0,t.jsx)(y.CardHeader,{className:"pb-3",children:(0,t.jsxs)(y.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(u.User,{className:"w-4 h-4"}),"Current User"]})}),(0,t.jsxs)(y.CardContent,{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Email:"}),(0,t.jsx)("span",{className:"font-mono text-foreground","data-testid":"text-user-email",children:w?.email||"Not authenticated"})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"User ID:"}),(0,t.jsx)("span",{className:"font-mono text-foreground text-xs truncate max-w-[200px]",children:w?.id||"-"})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Authenticated:"}),(0,t.jsx)("span",{className:C?"text-green-600":"text-red-600",children:C?"Yes":"No"})]})]})]}),(0,t.jsxs)(y.Card,{children:[(0,t.jsx)(y.CardHeader,{className:"pb-3",children:(0,t.jsxs)(y.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(x.Building2,{className:"w-4 h-4"}),"Current Organization"]})}),(0,t.jsxs)(y.CardContent,{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Name:"}),(0,t.jsx)("span",{className:"font-medium text-foreground","data-testid":"text-org-name",children:e?.name||"None selected"})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Org ID:"}),(0,t.jsx)("span",{className:"font-mono text-foreground text-xs truncate max-w-[200px]","data-testid":"text-org-id",children:e?.id||"-"})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Source:"}),(0,t.jsx)("span",{className:"text-foreground",children:M()})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Role:"}),(0,t.jsx)("span",{className:"capitalize text-foreground",children:d||"-"})]}),j&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(f.Loader2,{className:"w-3 h-3 animate-spin"})," Loading org..."]}),v&&(0,t.jsx)("div",{className:"text-sm text-destructive",children:v})]})]})]}),(0,t.jsxs)(y.Card,{children:[(0,t.jsxs)(y.CardHeader,{className:"pb-3 flex flex-row items-center justify-between gap-2",children:[(0,t.jsxs)(y.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(m,{className:"w-4 h-4"}),"Data Counts"]}),(0,t.jsx)(g.Button,{variant:"ghost",size:"sm",onClick:R,disabled:D,children:(0,t.jsx)(h.RefreshCw,{className:`w-4 h-4 ${D?"animate-spin":""}`})})]}),(0,t.jsx)(y.CardContent,{children:(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Employees",value:k.employees},{label:"Org Units",value:k.units},{label:"Competences",value:k.skills},{label:"Positions",value:k.positions}].map(e=>(0,t.jsxs)("div",{className:"text-center p-3 rounded-md bg-muted/50",children:[(0,t.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:null===e.value?"-":e.value}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.label})]},e.label))})})]}),(0,t.jsxs)(y.Card,{children:[(0,t.jsx)(y.CardHeader,{className:"pb-3",children:(0,t.jsxs)(y.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(p.AlertTriangle,{className:"w-4 h-4"}),"Recent Errors (Last 10)"]})}),(0,t.jsx)(y.CardContent,{children:0===_.length?(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No errors logged in this session"}):(0,t.jsx)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:_.map((e,s)=>(0,t.jsxs)("div",{className:"p-3 rounded-md bg-destructive/5 border border-destructive/20 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs bg-destructive/10 text-destructive uppercase",children:e.type}),e.endpoint&&(0,t.jsx)("span",{className:"font-mono text-xs text-muted-foreground",children:e.endpoint}),e.status&&(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Status: ",e.status]})]}),(0,t.jsx)("p",{className:"text-foreground",children:e.message}),e.code&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Code: ",e.code]}),e.hint&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Hint: ",e.hint]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.timestamp})]},s))})})]}),(0,t.jsxs)(y.Card,{children:[(0,t.jsx)(y.CardHeader,{className:"pb-3",children:(0,t.jsx)(y.CardTitle,{className:"text-base",children:"All Memberships"})}),(0,t.jsx)(y.CardContent,{children:0===N.length?(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No organization memberships found"}):(0,t.jsx)("div",{className:"space-y-2",children:N.map((s,a)=>(0,t.jsxs)("div",{className:`p-3 rounded-md border ${s.org_id===e?.id?"border-primary bg-primary/5":"border-border bg-muted/30"}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium text-foreground",children:s.organization?.name||s.org_id}),(0,t.jsx)("span",{className:"text-xs px-2 py-1 rounded bg-muted text-muted-foreground capitalize",children:s.role})]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground mt-1 font-mono",children:s.org_id})]},a))})})]})]})}window.logDebugError=N,e.s(["default",()=>j,"logDebugError",()=>N],77841)},71634,62163,98962,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),r=e.i(68934);function i({children:e,requireAdmin:i=!1}){let{currentOrg:n,isLoading:l,memberships:d,isAdmin:o}=(0,r.useOrg)(),c=(0,a.useRouter)();return((0,s.useEffect)(()=>{if(!l){if(!n&&d.length>0||!n&&0===d.length)return void c.replace("/app/org/select");if(i&&!o)return void c.replace("/app")}},[n,l,d,o,i,c]),l)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"animate-pulse text-muted-foreground",children:"Loading..."})}):n&&(!i||o)?(0,t.jsx)(t.Fragment,{children:e}):null}e.s(["OrgGuard",()=>i],71634);var n=e.i(31278),l=e.i(63209),d=e.i(16715),o=e.i(10289),c=e.i(75254);let m=(0,c.default)("FileQuestion",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]]);var u=e.i(67881),x=e.i(22016);function p({status:e,children:s,error:a,onRetry:r,emptyTitle:i="No data yet",emptyMessage:c="Get started by adding your first item.",emptyCta:p,emptyIcon:h,loadingMessage:f="Loading...",minHeight:g="400px"}){return"ready"===e&&s?(0,t.jsx)(t.Fragment,{children:s}):"loading"===e?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",style:{minHeight:g},"data-testid":"state-loading",children:[(0,t.jsx)(n.Loader2,{className:"w-6 h-6 animate-spin text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:f})]}):"error"===e?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",style:{minHeight:g},"data-testid":"state-error",children:[(0,t.jsx)("div",{className:"p-3 rounded-full bg-destructive/10",children:(0,t.jsx)(l.AlertCircle,{className:"w-8 h-8 text-destructive"})}),(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("h3",{className:"font-medium text-foreground mb-1",children:"Something went wrong"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a?.message||"Failed to load data"}),a?.code&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground font-mono bg-muted px-2 py-1 rounded inline-block",children:["Code: ",a.code]}),a?.hint&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Hint: ",a.hint]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[r&&(0,t.jsxs)(u.Button,{variant:"outline",onClick:r,"data-testid":"button-retry",children:[(0,t.jsx)(d.RefreshCw,{className:"w-4 h-4 mr-2"}),"Retry"]}),(0,t.jsx)(u.Button,{variant:"ghost",asChild:!0,"data-testid":"button-open-debug",children:(0,t.jsxs)(x.default,{href:"/app/debug",children:[(0,t.jsx)(o.Bug,{className:"w-4 h-4 mr-2"}),"Open Debug"]})})]})]}):"empty"===e?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",style:{minHeight:g},"data-testid":"state-empty",children:[(0,t.jsx)("div",{className:"p-3 rounded-full bg-muted",children:h||(0,t.jsx)(m,{className:"w-8 h-8 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("h3",{className:"font-medium text-foreground mb-1",children:i}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:c})]}),p&&(p.href?(0,t.jsx)(u.Button,{asChild:!0,"data-testid":"button-empty-cta",children:(0,t.jsx)(x.default,{href:p.href,children:p.label})}):(0,t.jsx)(u.Button,{onClick:p.onClick,"data-testid":"button-empty-cta",children:p.label}))]}):null}function h(e,t,s){return t?"loading":s?"error":!e||Array.isArray(e)&&0===e.length?"empty":"ready"}e.s(["DataState",()=>p,"useDataState",()=>h],62163);let f=(0,c.default)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);e.s(["UserX",()=>f],98962)},13969,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(68934),r=e.i(71634),i=e.i(53210),n=e.i(62163),l=e.i(77841),d=e.i(61911),o=e.i(79002),c=e.i(98962),m=e.i(31278),u=e.i(63488),x=e.i(3116),p=e.i(43531),h=e.i(37727);function f(){let{currentOrg:e,isAdmin:r}=(0,a.useOrg)(),[f,g]=(0,s.useState)([]),[y,b]=(0,s.useState)([]),[N,j]=(0,s.useState)(!0),[v,w]=(0,s.useState)(null),[C,k]=(0,s.useState)(!1),[S,D]=(0,s.useState)(""),[E,O]=(0,s.useState)("user"),[A,_]=(0,s.useState)(!1),[I,R]=(0,s.useState)(null),[M,P]=(0,s.useState)(null),U=(0,s.useCallback)(async()=>{if(e){j(!0),w(null);try{let{data:{session:t}}=await i.supabase.auth.getSession();if(!t?.access_token){w({message:"Not authenticated",code:"AUTH_REQUIRED"}),j(!1);return}let s=await fetch(`/api/admin/members?orgId=${e.id}`,{headers:{Authorization:`Bearer ${t.access_token}`}}),a=await s.json();if(s.ok)g(a.members||[]),b(a.invites||[]);else{let e={message:a.message||a.error||"Failed to load members",code:a.code,hint:a.hint};w(e),l.logDebugError?.({timestamp:new Date().toISOString(),type:"api",endpoint:"/api/admin/members",status:s.status,...e})}}catch(t){console.error("Fetch error:",t);let e={message:t instanceof Error?t.message:"Failed to load members",code:"NETWORK_ERROR"};w(e),l.logDebugError?.({timestamp:new Date().toISOString(),type:"api",endpoint:"/api/admin/members",...e})}finally{j(!1)}}},[e]);(0,s.useEffect)(()=>{U()},[U]);let L=async t=>{if(t.preventDefault(),e){_(!0),R(null);try{let{data:{session:t}}=await i.supabase.auth.getSession();if(!t?.access_token){R("Not authenticated"),_(!1);return}let s=await fetch("/api/admin/invite",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify({orgId:e.id,email:S,role:E})}),a=await s.json();if(!s.ok){R(a.error||"Failed to send invite"),_(!1);return}D(""),O("user"),k(!1),await U()}catch(e){console.error("Invite error:",e),R("Failed to send invite")}finally{_(!1)}}},T=async(t,s)=>{if(e){P(t);try{let{data:{session:a}}=await i.supabase.auth.getSession();if(!a?.access_token)return void P(null);(await fetch("/api/admin/membership/role",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.access_token}`},body:JSON.stringify({orgId:e.id,userId:t,role:s})})).ok&&await U()}catch(e){console.error("Role change error:",e)}finally{P(null)}}},B=async t=>{if(e&&confirm("Are you sure you want to disable this user?"))try{let{data:{session:s}}=await i.supabase.auth.getSession();if(!s?.access_token)return;(await fetch("/api/admin/membership/disable",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`},body:JSON.stringify({orgId:e.id,userId:t})})).ok&&await U()}catch(e){console.error("Disable error:",e)}},z=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),H=(0,n.useDataState)(f,N,v);return(0,t.jsxs)("div",{className:"p-6 max-w-6xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-foreground","data-testid":"text-page-title",children:"User Management"}),(0,t.jsxs)("p",{className:"text-muted-foreground mt-1",children:["Manage members and invites for ",e?.name]})]}),r&&"error"!==H&&(0,t.jsxs)("button",{onClick:()=>k(!C),className:"px-4 py-2 rounded-md bg-primary text-primary-foreground flex items-center gap-2","data-testid":"button-invite-user",children:[(0,t.jsx)(o.UserPlus,{className:"w-4 h-4"}),"Invite User"]})]}),C&&(0,t.jsxs)("div",{className:"p-4 rounded-lg border border-border bg-card",children:[I&&(0,t.jsx)("div",{className:"mb-4 p-3 rounded-md bg-destructive/10 text-destructive text-sm",children:I}),(0,t.jsxs)("form",{onSubmit:L,className:"flex flex-wrap gap-4 items-end",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,t.jsx)("label",{htmlFor:"invite-email",className:"block text-sm font-medium text-foreground mb-1",children:"Email Address"}),(0,t.jsx)("input",{id:"invite-email",type:"email",value:S,onChange:e=>D(e.target.value),placeholder:"user@example.com",className:"w-full px-3 py-2 rounded-md border border-input bg-background text-foreground",required:!0,"data-testid":"input-invite-email"})]}),(0,t.jsxs)("div",{className:"w-40",children:[(0,t.jsx)("label",{htmlFor:"invite-role",className:"block text-sm font-medium text-foreground mb-1",children:"Role"}),(0,t.jsxs)("select",{id:"invite-role",value:E,onChange:e=>O(e.target.value),className:"w-full px-3 py-2 rounded-md border border-input bg-background text-foreground","data-testid":"select-invite-role",children:[(0,t.jsx)("option",{value:"user",children:"User"}),(0,t.jsx)("option",{value:"manager",children:"Manager"}),(0,t.jsx)("option",{value:"hr",children:"HR"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>k(!1),className:"px-4 py-2 rounded-md border border-border text-foreground","data-testid":"button-cancel-invite",children:"Cancel"}),(0,t.jsxs)("button",{type:"submit",disabled:A,className:"px-4 py-2 rounded-md bg-primary text-primary-foreground disabled:opacity-50 flex items-center gap-2","data-testid":"button-send-invite",children:[A?(0,t.jsx)(m.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(u.Mail,{className:"w-4 h-4"}),"Send Invite"]})]})]})]}),(0,t.jsx)(n.DataState,{status:H,error:v,onRetry:U,emptyTitle:"No members yet",emptyMessage:"Invite users to join your organization.",emptyIcon:(0,t.jsx)(d.Users,{className:"w-8 h-8 text-muted-foreground"}),emptyCta:{label:"Invite User",onClick:()=>k(!0)},children:(0,t.jsxs)(t.Fragment,{children:[y.length>0&&(0,t.jsxs)("div",{className:"rounded-lg border border-border bg-card",children:[(0,t.jsx)("div",{className:"p-4 border-b border-border",children:(0,t.jsxs)("h2",{className:"font-medium text-foreground flex items-center gap-2",children:[(0,t.jsx)(x.Clock,{className:"w-4 h-4"}),"Pending Invites (",y.length,")"]})}),(0,t.jsx)("div",{className:"divide-y divide-border",children:y.map(e=>(0,t.jsxs)("div",{className:"p-4 flex items-center justify-between","data-testid":`row-invite-${e.id}`,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-foreground",children:e.email}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Invited as ",e.role," - Expires ",z(e.expires_at)]})]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded text-xs bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200",children:"Pending"})]},e.id))})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-border bg-card",children:[(0,t.jsx)("div",{className:"p-4 border-b border-border",children:(0,t.jsxs)("h2",{className:"font-medium text-foreground flex items-center gap-2",children:[(0,t.jsx)(d.Users,{className:"w-4 h-4"}),"Members (",f.filter(e=>"active"===e.status).length,")"]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-border bg-muted/50",children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Email"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Role"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Status"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Joined"}),(0,t.jsx)("th",{className:"px-4 py-3 text-right text-sm font-medium text-muted-foreground",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-border",children:f.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-muted/30","data-testid":`row-member-${e.user_id}`,children:[(0,t.jsx)("td",{className:"px-4 py-3 text-foreground",children:e.email||"Unknown"}),(0,t.jsx)("td",{className:"px-4 py-3",children:r&&M!==e.user_id?(0,t.jsxs)("select",{value:e.role,onChange:t=>T(e.user_id,t.target.value),className:"px-2 py-1 rounded border border-input bg-background text-foreground text-sm","data-testid":`select-role-${e.user_id}`,children:[(0,t.jsx)("option",{value:"user",children:"User"}),(0,t.jsx)("option",{value:"manager",children:"Manager"}),(0,t.jsx)("option",{value:"hr",children:"HR"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]}):M===e.user_id?(0,t.jsx)(m.Loader2,{className:"w-4 h-4 animate-spin text-muted-foreground"}):(0,t.jsx)("span",{className:"capitalize",children:e.role})}),(0,t.jsx)("td",{className:"px-4 py-3",children:"active"===e.status?(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[(0,t.jsx)(p.Check,{className:"w-3 h-3"}),"Active"]}):(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-xs bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[(0,t.jsx)(h.X,{className:"w-3 h-3"}),"Disabled"]})}),(0,t.jsx)("td",{className:"px-4 py-3 text-muted-foreground text-sm",children:z(e.created_at)}),(0,t.jsx)("td",{className:"px-4 py-3 text-right",children:r&&"active"===e.status&&(0,t.jsx)("button",{onClick:()=>B(e.user_id),className:"p-2 rounded text-muted-foreground hover:text-destructive",title:"Disable user","data-testid":`button-disable-${e.user_id}`,children:(0,t.jsx)(c.UserX,{className:"w-4 h-4"})})})]},e.user_id))})]})})]})]})})]})}function g(){return(0,t.jsx)(r.OrgGuard,{requireAdmin:!0,children:(0,t.jsx)(f,{})})}e.s(["default",()=>g])}]);