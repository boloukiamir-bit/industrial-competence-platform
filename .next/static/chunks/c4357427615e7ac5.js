(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";let a=(0,e.i(75254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>a],71689)},65740,e=>{"use strict";var a=e.i(43476),r=e.i(71645),t=e.i(18566),s=e.i(71689),l=e.i(53210);function d(){let e=(0,t.useParams)(),d=(0,t.useRouter)(),i=e.id,[o,n]=(0,r.useState)(!0),[y,u]=(0,r.useState)(!1),[g,c]=(0,r.useState)(""),[m,p]=(0,r.useState)({revisionDate:new Date().toISOString().split("T")[0],previousSalary:0,newSalary:0,salaryType:"monthly",reason:""});async function x(e){e.preventDefault(),u(!0);try{await l.supabase.from("salary_revisions").insert({employee_id:i,revision_date:m.revisionDate,previous_salary_sek:m.previousSalary,new_salary_sek:m.newSalary,salary_type:m.salaryType,reason:m.reason||null}),await l.supabase.from("salary_records").insert({employee_id:i,effective_from:m.revisionDate,salary_amount_sek:m.newSalary,salary_type:m.salaryType}),d.push(`/app/employees/${i}`)}catch(e){console.error("Error creating salary revision:",e),u(!1)}}if((0,r.useEffect)(()=>{!async function(){let[e,a]=await Promise.all([l.supabase.from("employees").select("name").eq("id",i).single(),l.supabase.from("salary_records").select("salary_amount_sek, salary_type").eq("employee_id",i).order("effective_from",{ascending:!1}).limit(1)]);c(e.data?.name||""),a.data&&a.data.length>0&&p(e=>({...e,previousSalary:parseFloat(a.data[0].salary_amount_sek),newSalary:parseFloat(a.data[0].salary_amount_sek),salaryType:a.data[0].salary_type||"monthly"})),n(!1)}()},[i]),o)return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"animate-pulse h-64 bg-gray-200 dark:bg-gray-700 rounded"})});let b=m.previousSalary>0?((m.newSalary-m.previousSalary)/m.previousSalary*100).toFixed(1):0;return(0,a.jsxs)("div",{className:"p-6 max-w-xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsx)("button",{onClick:()=>d.back(),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md","data-testid":"button-back",children:(0,a.jsx)(s.ArrowLeft,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"New Salary Revision"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["For ",g]})]})]}),(0,a.jsxs)("form",{onSubmit:x,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Revision Date *"}),(0,a.jsx)("input",{type:"date",value:m.revisionDate,onChange:e=>p({...m,revisionDate:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white","data-testid":"input-revision-date"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Salary Type"}),(0,a.jsxs)("select",{value:m.salaryType,onChange:e=>p({...m,salaryType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white","data-testid":"select-salary-type",children:[(0,a.jsx)("option",{value:"monthly",children:"Monthly"}),(0,a.jsx)("option",{value:"hourly",children:"Hourly"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Previous Salary (SEK)"}),(0,a.jsx)("input",{type:"number",value:m.previousSalary,onChange:e=>p({...m,previousSalary:parseFloat(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white","data-testid":"input-previous-salary"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"New Salary (SEK) *"}),(0,a.jsx)("input",{type:"number",value:m.newSalary,onChange:e=>p({...m,newSalary:parseFloat(e.target.value)||0}),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white","data-testid":"input-new-salary"})]})]}),m.previousSalary>0&&m.newSalary!==m.previousSalary&&(0,a.jsxs)("div",{className:`p-3 rounded-md ${m.newSalary>m.previousSalary?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400"}`,children:["Change: ",m.newSalary>m.previousSalary?"+":"",(m.newSalary-m.previousSalary).toLocaleString("sv-SE")," SEK (",m.newSalary>m.previousSalary?"+":"",b,"%)"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Reason"}),(0,a.jsx)("textarea",{value:m.reason,onChange:e=>p({...m,reason:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-none",placeholder:"Annual salary review, promotion, etc.","data-testid":"textarea-reason"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>d.back(),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700","data-testid":"button-cancel",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 rounded-md","data-testid":"button-save-revision",children:y?"Saving...":"Save Revision"})]})]})]})}e.s(["default",()=>d])}]);